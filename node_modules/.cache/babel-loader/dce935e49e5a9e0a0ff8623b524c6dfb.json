{"ast":null,"code":"import { useRef, useEffect, useLayoutEffect } from 'react';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty$1(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$1(Object(source), true).forEach(function (key) {\n        _defineProperty$1(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$1(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = o[Symbol.iterator]();\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n} // external events\n\n\nvar FINALIZE_EVENT_NAME = \"finalize\";\nvar CONSIDER_EVENT_NAME = \"consider\";\n/**\n * @typedef {Object} Info\n * @property {string} trigger\n * @property {string} id\n * @property {string} source\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\n\nfunction dispatchFinalizeEvent(el, items, info) {\n  el.dispatchEvent(new CustomEvent(FINALIZE_EVENT_NAME, {\n    detail: {\n      items: items,\n      info: info\n    }\n  }));\n}\n/**\n * Dispatches a consider event\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\n\n\nfunction dispatchConsiderEvent(el, items, info) {\n  el.dispatchEvent(new CustomEvent(CONSIDER_EVENT_NAME, {\n    detail: {\n      items: items,\n      info: info\n    }\n  }));\n} // internal events\n\n\nvar DRAGGED_ENTERED_EVENT_NAME = \"draggedEntered\";\nvar DRAGGED_LEFT_EVENT_NAME = \"draggedLeft\";\nvar DRAGGED_OVER_INDEX_EVENT_NAME = \"draggedOverIndex\";\nvar DRAGGED_LEFT_DOCUMENT_EVENT_NAME = \"draggedLeftDocument\";\nvar DRAGGED_LEFT_TYPES = {\n  LEFT_FOR_ANOTHER: \"leftForAnother\",\n  OUTSIDE_OF_ANY: \"outsideOfAny\"\n};\n\nfunction dispatchDraggedElementEnteredContainer(containerEl, indexObj, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_ENTERED_EVENT_NAME, {\n    detail: {\n      indexObj: indexObj,\n      draggedEl: draggedEl\n    }\n  }));\n}\n\nfunction dispatchDraggedElementLeftContainerForAnother(containerEl, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n    detail: {\n      draggedEl: draggedEl,\n      type: DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER\n    }\n  }));\n}\n\nfunction dispatchDraggedElementLeftContainerForNone(containerEl, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n    detail: {\n      draggedEl: draggedEl,\n      type: DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY\n    }\n  }));\n}\n\nfunction dispatchDraggedElementIsOverIndex(containerEl, indexObj, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_OVER_INDEX_EVENT_NAME, {\n    detail: {\n      indexObj: indexObj,\n      draggedEl: draggedEl\n    }\n  }));\n}\n\nfunction dispatchDraggedLeftDocument(draggedEl) {\n  window.dispatchEvent(new CustomEvent(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, {\n    detail: {\n      draggedEl: draggedEl\n    }\n  }));\n}\n\nvar TRIGGERS = {\n  DRAG_STARTED: \"dragStarted\",\n  DRAGGED_ENTERED: DRAGGED_ENTERED_EVENT_NAME,\n  DRAGGED_ENTERED_ANOTHER: \"dragEnteredAnother\",\n  DRAGGED_OVER_INDEX: DRAGGED_OVER_INDEX_EVENT_NAME,\n  DRAGGED_LEFT: DRAGGED_LEFT_EVENT_NAME,\n  DRAGGED_LEFT_ALL: \"draggedLeftAll\",\n  DROPPED_INTO_ZONE: \"droppedIntoZone\",\n  DROPPED_INTO_ANOTHER: \"droppedIntoAnother\",\n  DROPPED_OUTSIDE_OF_ANY: \"droppedOutsideOfAny\",\n  DRAG_STOPPED: \"dragStopped\"\n};\nvar SOURCES = {\n  POINTER: \"pointer\",\n  KEYBOARD: \"keyboard\"\n};\nvar SHADOW_ITEM_MARKER_PROPERTY_NAME = \"isDndShadowItem\";\nvar SHADOW_ELEMENT_ATTRIBUTE_NAME = \"data-is-dnd-shadow-item\";\nvar ITEM_ID_KEY = \"id\";\nvar activeDndZoneCount = 0;\n\nfunction incrementActiveDropZoneCount() {\n  activeDndZoneCount++;\n}\n\nfunction decrementActiveDropZoneCount() {\n  if (activeDndZoneCount === 0) {\n    throw new Error(\"Bug! trying to decrement when there are no dropzones\");\n  }\n\n  activeDndZoneCount--;\n}\n/**\n * Allows using another key instead of \"id\" in the items data. This is global and applies to all dndzones.\n * Has to be called when there are no rendered dndzones whatsoever.\n * @param {String} newKeyName\n * @throws {Error} if it was called when there are rendered dndzones or if it is given the wrong type (not a string)\n */\n\n\nfunction overrideItemIdKeyNameBeforeInitialisingDndZones(newKeyName) {\n  if (activeDndZoneCount > 0) {\n    throw new Error(\"can only override the id key before initialising any dndzone\");\n  }\n\n  if (typeof newKeyName !== \"string\") {\n    throw new Error(\"item id key has to be a string\");\n  }\n\n  ITEM_ID_KEY = newKeyName;\n}\n\nvar isOnServer = typeof window === \"undefined\"; // This is based off https://stackoverflow.com/questions/27745438/how-to-compute-getboundingclientrect-without-considering-transforms/57876601#57876601\n// It removes the transforms that are potentially applied by the flip animations\n\nfunction adjustedBoundingRect(el) {\n  var ta;\n  var rect = el.getBoundingClientRect();\n  var style = getComputedStyle(el);\n  var tx = style.transform;\n\n  if (tx) {\n    var sx, sy, dx, dy;\n\n    if (tx.startsWith(\"matrix3d(\")) {\n      ta = tx.slice(9, -1).split(/, /);\n      sx = +ta[0];\n      sy = +ta[5];\n      dx = +ta[12];\n      dy = +ta[13];\n    } else if (tx.startsWith(\"matrix(\")) {\n      ta = tx.slice(7, -1).split(/, /);\n      sx = +ta[0];\n      sy = +ta[3];\n      dx = +ta[4];\n      dy = +ta[5];\n    } else {\n      return rect;\n    }\n\n    var to = style.transformOrigin;\n    var x = rect.x - dx - (1 - sx) * parseFloat(to);\n    var y = rect.y - dy - (1 - sy) * parseFloat(to.slice(to.indexOf(\" \") + 1));\n    var w = sx ? rect.width / sx : el.offsetWidth;\n    var h = sy ? rect.height / sy : el.offsetHeight;\n    return {\n      x: x,\n      y: y,\n      width: w,\n      height: h,\n      top: y,\n      right: x + w,\n      bottom: y + h,\n      left: x\n    };\n  } else {\n    return rect;\n  }\n}\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position and removes transforms)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\n\n\nfunction getAbsoluteRectNoTransforms(el) {\n  var rect = adjustedBoundingRect(el);\n  return {\n    top: rect.top + window.scrollY,\n    bottom: rect.bottom + window.scrollY,\n    left: rect.left + window.scrollX,\n    right: rect.right + window.scrollX\n  };\n}\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\n\n\nfunction getAbsoluteRect(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    top: rect.top + window.scrollY,\n    bottom: rect.bottom + window.scrollY,\n    left: rect.left + window.scrollX,\n    right: rect.right + window.scrollX\n  };\n}\n/**\n * finds the center :)\n * @typedef {Object} Rect\n * @property {number} top\n * @property {number} bottom\n * @property {number} left\n * @property {number} right\n * @param {Rect} rect\n * @return {{x: number, y: number}}\n */\n\n\nfunction findCenter(rect) {\n  return {\n    x: (rect.left + rect.right) / 2,\n    y: (rect.top + rect.bottom) / 2\n  };\n}\n/**\n * @typedef {Object} Point\n * @property {number} x\n * @property {number} y\n * @param {Point} pointA\n * @param {Point} pointB\n * @return {number}\n */\n\n\nfunction calcDistance(pointA, pointB) {\n  return Math.sqrt(Math.pow(pointA.x - pointB.x, 2) + Math.pow(pointA.y - pointB.y, 2));\n}\n/**\n * @param {Point} point\n * @param {Rect} rect\n * @return {boolean|boolean}\n */\n\n\nfunction isPointInsideRect(point, rect) {\n  return point.y <= rect.bottom && point.y >= rect.top && point.x >= rect.left && point.x <= rect.right;\n}\n/**\n * find the absolute coordinates of the center of a dom element\n * @param el {HTMLElement}\n * @returns {{x: number, y: number}}\n */\n\n\nfunction findCenterOfElement(el) {\n  return findCenter(getAbsoluteRect(el));\n}\n/**\n * @param {HTMLElement} elA\n * @param {HTMLElement} elB\n * @return {boolean}\n */\n\n\nfunction isCenterOfAInsideB(elA, elB) {\n  var centerOfA = findCenterOfElement(elA);\n  var rectOfB = getAbsoluteRectNoTransforms(elB);\n  return isPointInsideRect(centerOfA, rectOfB);\n}\n/**\n * @param {HTMLElement|ChildNode} elA\n * @param {HTMLElement|ChildNode} elB\n * @return {number}\n */\n\n\nfunction calcDistanceBetweenCenters(elA, elB) {\n  var centerOfA = findCenterOfElement(elA);\n  var centerOfB = findCenterOfElement(elB);\n  return calcDistance(centerOfA, centerOfB);\n}\n/**\n * @param {HTMLElement} el - the element to check\n * @returns {boolean} - true if the element in its entirety is off screen including the scrollable area (the normal dom events look at the mouse rather than the element)\n */\n\n\nfunction isElementOffDocument(el) {\n  var rect = getAbsoluteRect(el);\n  return rect.right < 0 || rect.left > document.documentElement.scrollWidth || rect.bottom < 0 || rect.top > document.documentElement.scrollHeight;\n}\n/**\n * If the point is inside the element returns its distances from the sides, otherwise returns null\n * @param {Point} point\n * @param {HTMLElement} el\n * @return {null|{top: number, left: number, bottom: number, right: number}}\n */\n\n\nfunction calcInnerDistancesBetweenPointAndSidesOfElement(point, el) {\n  var rect = getAbsoluteRect(el);\n\n  if (!isPointInsideRect(point, rect)) {\n    return null;\n  }\n\n  return {\n    top: point.y - rect.top,\n    bottom: rect.bottom - point.y,\n    left: point.x - rect.left,\n    // TODO - figure out what is so special about right (why the rect is too big)\n    right: Math.min(rect.right, document.documentElement.clientWidth) - point.x\n  };\n}\n\nvar dzToShadowIndexToRect;\n/**\n * Resets the cache that allows for smarter \"would be index\" resolution. Should be called after every drag operation\n */\n\nfunction resetIndexesCache() {\n  dzToShadowIndexToRect = new Map();\n}\n\nresetIndexesCache();\n/**\n * Caches the coordinates of the shadow element when it's in a certain index in a certain dropzone.\n * Helpful in order to determine \"would be index\" more effectively\n * @param {HTMLElement} dz\n * @return {number} - the shadow element index\n */\n\nfunction cacheShadowRect(dz) {\n  var shadowElIndex = Array.from(dz.children).findIndex(function (child) {\n    return child.getAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME);\n  });\n\n  if (shadowElIndex >= 0) {\n    if (!dzToShadowIndexToRect.has(dz)) {\n      dzToShadowIndexToRect.set(dz, new Map());\n    }\n\n    dzToShadowIndexToRect.get(dz).set(shadowElIndex, getAbsoluteRectNoTransforms(dz.children[shadowElIndex]));\n    return shadowElIndex;\n  }\n\n  return undefined;\n}\n/**\n * @typedef {Object} Index\n * @property {number} index - the would be index\n * @property {boolean} isProximityBased - false if the element is actually over the index, true if it is not over it but this index is the closest\n */\n\n/**\n * Find the index for the dragged element in the list it is dragged over\n * @param {HTMLElement} floatingAboveEl\n * @param {HTMLElement} collectionBelowEl\n * @returns {Index|null} -  if the element is over the container the Index object otherwise null\n */\n\n\nfunction findWouldBeIndex(floatingAboveEl, collectionBelowEl) {\n  if (!isCenterOfAInsideB(floatingAboveEl, collectionBelowEl)) {\n    return null;\n  }\n\n  var children = collectionBelowEl.children; // the container is empty, floating element should be the first\n\n  if (children.length === 0) {\n    return {\n      index: 0,\n      isProximityBased: true\n    };\n  }\n\n  var shadowElIndex = cacheShadowRect(collectionBelowEl); // the search could be more efficient but keeping it simple for now\n  // a possible improvement: pass in the lastIndex it was found in and check there first, then expand from there\n\n  for (var i = 0; i < children.length; i++) {\n    if (isCenterOfAInsideB(floatingAboveEl, children[i])) {\n      var cachedShadowRect = dzToShadowIndexToRect.has(collectionBelowEl) && dzToShadowIndexToRect.get(collectionBelowEl).get(i);\n\n      if (cachedShadowRect) {\n        if (!isPointInsideRect(findCenterOfElement(floatingAboveEl), cachedShadowRect)) {\n          return {\n            index: shadowElIndex,\n            isProximityBased: false\n          };\n        }\n      }\n\n      return {\n        index: i,\n        isProximityBased: false\n      };\n    }\n  } // this can happen if there is space around the children so the floating element has\n  //entered the container but not any of the children, in this case we will find the nearest child\n\n\n  var minDistanceSoFar = Number.MAX_VALUE;\n  var indexOfMin = undefined; // we are checking all of them because we don't know whether we are dealing with a horizontal or vertical container and where the floating element entered from\n\n  for (var _i = 0; _i < children.length; _i++) {\n    var distance = calcDistanceBetweenCenters(floatingAboveEl, children[_i]);\n\n    if (distance < minDistanceSoFar) {\n      minDistanceSoFar = distance;\n      indexOfMin = _i;\n    }\n  }\n\n  return {\n    index: indexOfMin,\n    isProximityBased: true\n  };\n}\n\nvar SCROLL_ZONE_PX = 25;\n\nfunction makeScroller() {\n  var scrollingInfo;\n\n  function resetScrolling() {\n    scrollingInfo = {\n      directionObj: undefined,\n      stepPx: 0\n    };\n  }\n\n  resetScrolling(); // directionObj {x: 0|1|-1, y:0|1|-1} - 1 means down in y and right in x\n\n  function scrollContainer(containerEl) {\n    var _scrollingInfo = scrollingInfo,\n        directionObj = _scrollingInfo.directionObj,\n        stepPx = _scrollingInfo.stepPx;\n\n    if (directionObj) {\n      containerEl.scrollBy(directionObj.x * stepPx, directionObj.y * stepPx);\n      window.requestAnimationFrame(function () {\n        return scrollContainer(containerEl);\n      });\n    }\n  }\n\n  function calcScrollStepPx(distancePx) {\n    return SCROLL_ZONE_PX - distancePx;\n  }\n  /**\n   * If the pointer is next to the sides of the element to scroll, will trigger scrolling\n   * Can be called repeatedly with updated pointer and elementToScroll values without issues\n   * @return {boolean} - true if scrolling was needed\n   */\n\n\n  function scrollIfNeeded(pointer, elementToScroll) {\n    if (!elementToScroll) {\n      return false;\n    }\n\n    var distances = calcInnerDistancesBetweenPointAndSidesOfElement(pointer, elementToScroll);\n\n    if (distances === null) {\n      resetScrolling();\n      return false;\n    }\n\n    var isAlreadyScrolling = !!scrollingInfo.directionObj;\n    var scrollingVertically = false,\n        scrollingHorizontally = false; // vertical\n\n    if (elementToScroll.scrollHeight > elementToScroll.clientHeight) {\n      if (distances.bottom < SCROLL_ZONE_PX) {\n        scrollingVertically = true;\n        scrollingInfo.directionObj = {\n          x: 0,\n          y: 1\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.bottom);\n      } else if (distances.top < SCROLL_ZONE_PX) {\n        scrollingVertically = true;\n        scrollingInfo.directionObj = {\n          x: 0,\n          y: -1\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.top);\n      }\n\n      if (!isAlreadyScrolling && scrollingVertically) {\n        scrollContainer(elementToScroll);\n        return true;\n      }\n    } // horizontal\n\n\n    if (elementToScroll.scrollWidth > elementToScroll.clientWidth) {\n      if (distances.right < SCROLL_ZONE_PX) {\n        scrollingHorizontally = true;\n        scrollingInfo.directionObj = {\n          x: 1,\n          y: 0\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.right);\n      } else if (distances.left < SCROLL_ZONE_PX) {\n        scrollingHorizontally = true;\n        scrollingInfo.directionObj = {\n          x: -1,\n          y: 0\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.left);\n      }\n\n      if (!isAlreadyScrolling && scrollingHorizontally) {\n        scrollContainer(elementToScroll);\n        return true;\n      }\n    }\n\n    resetScrolling();\n    return false;\n  }\n\n  return {\n    scrollIfNeeded: scrollIfNeeded,\n    resetScrolling: resetScrolling\n  };\n}\n/**\n * @param {Object} object\n * @return {string}\n */\n\n\nfunction toString(object) {\n  return JSON.stringify(object, null, 2);\n}\n/**\n * Finds the depth of the given node in the DOM tree\n * @param {HTMLElement} node\n * @return {number} - the depth of the node\n */\n\n\nfunction getDepth(node) {\n  if (!node) {\n    throw new Error(\"cannot get depth of a falsy node\");\n  }\n\n  return _getDepth(node, 0);\n}\n\nfunction _getDepth(node) {\n  var countSoFar = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  if (!node.parentElement) {\n    return countSoFar - 1;\n  }\n\n  return _getDepth(node.parentElement, countSoFar + 1);\n}\n/**\n * A simple util to shallow compare objects quickly, it doesn't validate the arguments so pass objects in\n * @param {Object} objA\n * @param {Object} objB\n * @return {boolean} - true if objA and objB are shallow equal\n */\n\n\nfunction areObjectsShallowEqual(objA, objB) {\n  if (Object.keys(objA).length !== Object.keys(objB).length) {\n    return false;\n  }\n\n  for (var keyA in objA) {\n    if (!{}.hasOwnProperty.call(objB, keyA) || objB[keyA] !== objA[keyA]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar INTERVAL_MS = 200;\nvar TOLERANCE_PX = 10;\n\nvar _makeScroller = makeScroller(),\n    scrollIfNeeded = _makeScroller.scrollIfNeeded,\n    resetScrolling = _makeScroller.resetScrolling;\n\nvar next;\n/**\n * Tracks the dragged elements and performs the side effects when it is dragged over a drop zone (basically dispatching custom-events scrolling)\n * @param {Set<HTMLElement>} dropZones\n * @param {HTMLElement} draggedEl\n * @param {number} [intervalMs = INTERVAL_MS]\n */\n\nfunction observe(draggedEl, dropZones) {\n  var intervalMs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : INTERVAL_MS; // initialization\n\n  var lastDropZoneFound;\n  var lastIndexFound;\n  var lastIsDraggedInADropZone = false;\n  var lastCentrePositionOfDragged; // We are sorting to make sure that in case of nested zones of the same type the one \"on top\" is considered first\n\n  var dropZonesFromDeepToShallow = Array.from(dropZones).sort(function (dz1, dz2) {\n    return getDepth(dz2) - getDepth(dz1);\n  });\n  /**\n   * The main function in this module. Tracks where everything is/ should be a take the actions\n   */\n\n  function andNow() {\n    var currentCenterOfDragged = findCenterOfElement(draggedEl);\n    var scrolled = scrollIfNeeded(currentCenterOfDragged, lastDropZoneFound); // we only want to make a new decision after the element was moved a bit to prevent flickering\n\n    if (!scrolled && lastCentrePositionOfDragged && Math.abs(lastCentrePositionOfDragged.x - currentCenterOfDragged.x) < TOLERANCE_PX && Math.abs(lastCentrePositionOfDragged.y - currentCenterOfDragged.y) < TOLERANCE_PX) {\n      next = window.setTimeout(andNow, intervalMs);\n      return;\n    }\n\n    if (isElementOffDocument(draggedEl)) {\n      dispatchDraggedLeftDocument(draggedEl);\n      return;\n    }\n\n    lastCentrePositionOfDragged = currentCenterOfDragged; // this is a simple algorithm, potential improvement: first look at lastDropZoneFound\n\n    var isDraggedInADropZone = false;\n\n    var _iterator = _createForOfIteratorHelper(dropZonesFromDeepToShallow),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var dz = _step.value;\n        var indexObj = findWouldBeIndex(draggedEl, dz);\n\n        if (indexObj === null) {\n          // it is not inside\n          continue;\n        }\n\n        var index = indexObj.index;\n        isDraggedInADropZone = true; // the element is over a container\n\n        if (dz !== lastDropZoneFound) {\n          lastDropZoneFound && dispatchDraggedElementLeftContainerForAnother(lastDropZoneFound, draggedEl);\n          dispatchDraggedElementEnteredContainer(dz, indexObj, draggedEl);\n          lastDropZoneFound = dz;\n        } else if (index !== lastIndexFound) {\n          dispatchDraggedElementIsOverIndex(dz, indexObj, draggedEl);\n          lastIndexFound = index;\n        } // we handle looping with the 'continue' statement above\n\n\n        break;\n      } // the first time the dragged element is not in any dropzone we need to notify the last dropzone it was in\n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    if (!isDraggedInADropZone && lastIsDraggedInADropZone && lastDropZoneFound) {\n      dispatchDraggedElementLeftContainerForNone(lastDropZoneFound, draggedEl);\n      lastDropZoneFound = undefined;\n      lastIndexFound = undefined;\n      lastIsDraggedInADropZone = false;\n    } else {\n      lastIsDraggedInADropZone = true;\n    }\n\n    next = window.setTimeout(andNow, intervalMs);\n  }\n\n  andNow();\n} // assumption - we can only observe one dragged element at a time, this could be changed in the future\n\n\nfunction unobserve() {\n  clearTimeout(next);\n  resetScrolling();\n  resetIndexesCache();\n}\n\nvar INTERVAL_MS$1 = 300;\nvar mousePosition;\n/**\n * Do not use this! it is visible for testing only until we get over the issue Cypress not triggering the mousemove listeners\n * // TODO - make private (remove export)\n * @param {{clientX: number, clientY: number}} e\n */\n\nfunction updateMousePosition(e) {\n  var c = e.touches ? e.touches[0] : e;\n  mousePosition = {\n    x: c.clientX,\n    y: c.clientY\n  };\n}\n\nvar _makeScroller$1 = makeScroller(),\n    scrollIfNeeded$1 = _makeScroller$1.scrollIfNeeded,\n    resetScrolling$1 = _makeScroller$1.resetScrolling;\n\nvar next$1;\n\nfunction loop() {\n  if (mousePosition) {\n    scrollIfNeeded$1(mousePosition, document.documentElement);\n  }\n\n  next$1 = window.setTimeout(loop, INTERVAL_MS$1);\n}\n/**\n * will start watching the mouse pointer and scroll the window if it goes next to the edges\n */\n\n\nfunction armWindowScroller() {\n  window.addEventListener(\"mousemove\", updateMousePosition);\n  window.addEventListener(\"touchmove\", updateMousePosition);\n  loop();\n}\n/**\n * will stop watching the mouse pointer and won't scroll the window anymore\n */\n\n\nfunction disarmWindowScroller() {\n  window.removeEventListener(\"mousemove\", updateMousePosition);\n  window.removeEventListener(\"touchmove\", updateMousePosition);\n  mousePosition = undefined;\n  window.clearTimeout(next$1);\n  resetScrolling$1();\n}\n\nvar TRANSITION_DURATION_SECONDS = 0.2;\n/**\n * private helper function - creates a transition string for a property\n * @param {string} property\n * @return {string} - the transition string\n */\n\nfunction trs(property) {\n  return \"\".concat(property, \" \").concat(TRANSITION_DURATION_SECONDS, \"s ease\");\n}\n/**\n * clones the given element and applies proper styles and transitions to the dragged element\n * @param {HTMLElement} originalElement\n * @return {Node} - the cloned, styled element\n */\n\n\nfunction createDraggedElementFrom(originalElement) {\n  var rect = originalElement.getBoundingClientRect();\n  var draggedEl = originalElement.cloneNode(true);\n  copyStylesFromTo(originalElement, draggedEl);\n  draggedEl.id = \"dnd-action-dragged-el\";\n  draggedEl.style.position = \"fixed\";\n  draggedEl.style.top = \"\".concat(rect.top, \"px\");\n  draggedEl.style.left = \"\".concat(rect.left, \"px\");\n  draggedEl.style.margin = \"0\"; // we can't have relative or automatic height and width or it will break the illusion\n\n  draggedEl.style.boxSizing = \"border-box\";\n  draggedEl.style.height = \"\".concat(rect.height, \"px\");\n  draggedEl.style.width = \"\".concat(rect.width, \"px\");\n  draggedEl.style.transition = \"\".concat(trs(\"width\"), \", \").concat(trs(\"height\"), \", \").concat(trs(\"background-color\"), \", \").concat(trs(\"opacity\"), \", \").concat(trs(\"color\"), \" \"); // this is a workaround for a strange browser bug that causes the right border to disappear when all the transitions are added at the same time\n\n  window.setTimeout(function () {\n    return draggedEl.style.transition += \", \".concat(trs(\"top\"), \", \").concat(trs(\"left\"));\n  }, 0);\n  draggedEl.style.zIndex = \"9999\";\n  draggedEl.style.cursor = \"grabbing\";\n  return draggedEl;\n}\n/**\n * styles the dragged element to a 'dropped' state\n * @param {HTMLElement} draggedEl\n */\n\n\nfunction moveDraggedElementToWasDroppedState(draggedEl) {\n  draggedEl.style.cursor = \"grab\";\n}\n/**\n * Morphs the dragged element style, maintains the mouse pointer within the element\n * @param {HTMLElement} draggedEl\n * @param {HTMLElement} copyFromEl - the element the dragged element should look like, typically the shadow element\n * @param {number} currentMouseX\n * @param {number} currentMouseY\n * @param {function} transformDraggedElement - function to transform the dragged element, does nothing by default.\n */\n\n\nfunction morphDraggedElementToBeLike(draggedEl, copyFromEl, currentMouseX, currentMouseY, transformDraggedElement) {\n  var newRect = copyFromEl.getBoundingClientRect();\n  var draggedElRect = draggedEl.getBoundingClientRect();\n  var widthChange = newRect.width - draggedElRect.width;\n  var heightChange = newRect.height - draggedElRect.height;\n\n  if (widthChange || heightChange) {\n    var relativeDistanceOfMousePointerFromDraggedSides = {\n      left: (currentMouseX - draggedElRect.left) / draggedElRect.width,\n      top: (currentMouseY - draggedElRect.top) / draggedElRect.height\n    };\n    draggedEl.style.height = \"\".concat(newRect.height, \"px\");\n    draggedEl.style.width = \"\".concat(newRect.width, \"px\");\n    draggedEl.style.left = \"\".concat(parseFloat(draggedEl.style.left) - relativeDistanceOfMousePointerFromDraggedSides.left * widthChange, \"px\");\n    draggedEl.style.top = \"\".concat(parseFloat(draggedEl.style.top) - relativeDistanceOfMousePointerFromDraggedSides.top * heightChange, \"px\");\n  } /// other properties\n\n\n  copyStylesFromTo(copyFromEl, draggedEl);\n  transformDraggedElement();\n}\n/**\n * @param {HTMLElement} copyFromEl\n * @param {HTMLElement} copyToEl\n */\n\n\nfunction copyStylesFromTo(copyFromEl, copyToEl) {\n  var computedStyle = window.getComputedStyle(copyFromEl);\n  Array.from(computedStyle).filter(function (s) {\n    return s.startsWith(\"background\") || s.startsWith(\"padding\") || s.startsWith(\"font\") || s.startsWith(\"text\") || s.startsWith(\"align\") || s.startsWith(\"justify\") || s.startsWith(\"display\") || s.startsWith(\"flex\") || s.startsWith(\"border\") || s === \"opacity\" || s === \"color\" || s === \"list-style-type\";\n  }).forEach(function (s) {\n    return copyToEl.style.setProperty(s, computedStyle.getPropertyValue(s), computedStyle.getPropertyPriority(s));\n  });\n}\n/**\n * makes the element compatible with being draggable\n * @param {HTMLElement} draggableEl\n * @param {boolean} dragDisabled\n */\n\n\nfunction styleDraggable(draggableEl, dragDisabled) {\n  draggableEl.draggable = false;\n\n  draggableEl.ondragstart = function () {\n    return false;\n  };\n\n  if (!dragDisabled) {\n    draggableEl.style.userSelect = \"none\";\n    draggableEl.style.WebkitUserSelect = \"none\";\n    draggableEl.style.cursor = \"grab\";\n  } else {\n    draggableEl.style.userSelect = \"\";\n    draggableEl.style.WebkitUserSelect = \"\";\n    draggableEl.style.cursor = \"\";\n  }\n}\n/**\n * Hides the provided element so that it can stay in the dom without interrupting\n * @param {HTMLElement} dragTarget\n */\n\n\nfunction hideOriginalDragTarget(dragTarget) {\n  dragTarget.style.display = \"none\";\n  dragTarget.style.position = \"fixed\";\n  dragTarget.style.zIndex = \"-5\";\n}\n/**\n * styles the shadow element\n * @param {HTMLElement} shadowEl\n */\n\n\nfunction decorateShadowEl(shadowEl) {\n  shadowEl.style.visibility = \"hidden\";\n  shadowEl.setAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME, \"true\");\n}\n/**\n * undo the styles the shadow element\n * @param {HTMLElement} shadowEl\n */\n\n\nfunction unDecorateShadowElement(shadowEl) {\n  shadowEl.style.visibility = \"\";\n  shadowEl.removeAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME);\n}\n/**\n * will mark the given dropzones as visually active\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object (so the styles can be removed)\n */\n\n\nfunction styleActiveDropZones(dropZones) {\n  var getStyles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  dropZones.forEach(function (dz) {\n    var styles = getStyles(dz);\n    Object.keys(styles).forEach(function (style) {\n      dz.style[style] = styles[style];\n    });\n  });\n}\n/**\n * will remove the 'active' styling from given dropzones\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object\n */\n\n\nfunction styleInactiveDropZones(dropZones) {\n  var getStyles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  dropZones.forEach(function (dz) {\n    var styles = getStyles(dz);\n    Object.keys(styles).forEach(function (style) {\n      dz.style[style] = \"\";\n    });\n  });\n}\n/**\n * will prevent the provided element from shrinking by setting its minWidth and minHeight to the current width and height values\n * @param {HTMLElement} el\n * @return {function(): void} - run this function to undo the operation and restore the original values\n */\n\n\nfunction preventShrinking(el) {\n  var originalMinHeight = el.style.minHeight;\n  el.style.minHeight = window.getComputedStyle(el).getPropertyValue(\"height\");\n  var originalMinWidth = el.style.minWidth;\n  el.style.minWidth = window.getComputedStyle(el).getPropertyValue(\"width\");\n  return function undo() {\n    el.style.minHeight = originalMinHeight;\n    el.style.minWidth = originalMinWidth;\n  };\n}\n\nvar DEFAULT_DROP_ZONE_TYPE = \"--any--\";\nvar MIN_OBSERVATION_INTERVAL_MS = 100;\nvar MIN_MOVEMENT_BEFORE_DRAG_START_PX = 3;\nvar DEFAULT_DROP_TARGET_STYLE = {\n  outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\nvar originalDragTarget;\nvar draggedEl;\nvar draggedElData;\nvar draggedElType;\nvar originDropZone;\nvar originIndex;\nvar shadowElData;\nvar shadowElDropZone;\nvar dragStartMousePosition;\nvar currentMousePosition;\nvar isWorkingOnPreviousDrag = false;\nvar finalizingPreviousDrag = false;\nvar unlockOriginDzMinDimensions;\nvar isDraggedOutsideOfAnyDz = false; // a map from type to a set of drop-zones\n\nvar typeToDropZones = new Map(); // important - this is needed because otherwise the config that would be used for everyone is the config of the element that created the event listeners\n\nvar dzToConfig = new Map(); // this is needed in order to be able to cleanup old listeners and avoid stale closures issues (as the listener is defined within each zone)\n\nvar elToMouseDownListener = new WeakMap();\n/* drop-zones registration management */\n\nfunction registerDropZone(dropZoneEl, type) {\n  if (!typeToDropZones.has(type)) {\n    typeToDropZones.set(type, new Set());\n  }\n\n  if (!typeToDropZones.get(type).has(dropZoneEl)) {\n    typeToDropZones.get(type).add(dropZoneEl);\n    incrementActiveDropZoneCount();\n  }\n}\n\nfunction unregisterDropZone(dropZoneEl, type) {\n  typeToDropZones.get(type)[\"delete\"](dropZoneEl);\n  decrementActiveDropZoneCount();\n\n  if (typeToDropZones.get(type).size === 0) {\n    typeToDropZones[\"delete\"](type);\n  }\n}\n/* functions to manage observing the dragged element and trigger custom drag-events */\n\n\nfunction watchDraggedElement() {\n  armWindowScroller();\n  var dropZones = typeToDropZones.get(draggedElType);\n\n  var _iterator = _createForOfIteratorHelper(dropZones),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var dz = _step.value;\n      dz.addEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n      dz.addEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n      dz.addEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  window.addEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop); // it is important that we don't have an interval that is faster than the flip duration because it can cause elements to jump bach and forth\n\n  var observationIntervalMs = Math.max.apply(Math, [MIN_OBSERVATION_INTERVAL_MS].concat(_toConsumableArray(Array.from(dropZones.keys()).map(function (dz) {\n    return dzToConfig.get(dz).dropAnimationDurationMs;\n  }))));\n  observe(draggedEl, dropZones, observationIntervalMs * 1.07);\n}\n\nfunction unWatchDraggedElement() {\n  disarmWindowScroller();\n  var dropZones = typeToDropZones.get(draggedElType);\n\n  var _iterator2 = _createForOfIteratorHelper(dropZones),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var dz = _step2.value;\n      dz.removeEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n      dz.removeEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n      dz.removeEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  window.removeEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop);\n  unobserve();\n}\n/* custom drag-events handlers */\n\n\nfunction handleDraggedEntered(e) {\n  isDraggedOutsideOfAnyDz = false;\n\n  var _dzToConfig$get = dzToConfig.get(e.currentTarget),\n      items = _dzToConfig$get.items,\n      dropFromOthersDisabled = _dzToConfig$get.dropFromOthersDisabled;\n\n  if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n    return;\n  } // this deals with another race condition. in rare occasions (super rapid operations) the list hasn't updated yet\n\n\n  items = items.filter(function (i) {\n    return i[ITEM_ID_KEY] !== shadowElData[ITEM_ID_KEY];\n  });\n\n  if (originDropZone !== e.currentTarget) {\n    var originZoneItems = dzToConfig.get(originDropZone).items;\n    var newOriginZoneItems = originZoneItems.filter(function (item) {\n      return !item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n    });\n    dispatchConsiderEvent(originDropZone, newOriginZoneItems, {\n      trigger: TRIGGERS.DRAGGED_ENTERED_ANOTHER,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    });\n  }\n\n  var _e$detail$indexObj = e.detail.indexObj,\n      index = _e$detail$indexObj.index,\n      isProximityBased = _e$detail$indexObj.isProximityBased;\n  var shadowElIdx = isProximityBased && index === e.currentTarget.children.length - 1 ? index + 1 : index;\n  shadowElDropZone = e.currentTarget;\n  items.splice(shadowElIdx, 0, shadowElData);\n  dispatchConsiderEvent(e.currentTarget, items, {\n    trigger: TRIGGERS.DRAGGED_ENTERED,\n    id: draggedElData[ITEM_ID_KEY],\n    source: SOURCES.POINTER\n  });\n}\n\nfunction handleDraggedLeft(e) {\n  var _dzToConfig$get2 = dzToConfig.get(e.currentTarget),\n      items = _dzToConfig$get2.items,\n      dropFromOthersDisabled = _dzToConfig$get2.dropFromOthersDisabled;\n\n  if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n    return;\n  }\n\n  var shadowElIdx = items.findIndex(function (item) {\n    return !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n  });\n  var shadowItem = items.splice(shadowElIdx, 1)[0];\n  shadowElDropZone = undefined;\n\n  if (e.detail.type === DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY) {\n    isDraggedOutsideOfAnyDz = true;\n    shadowElDropZone = originDropZone;\n    var originZoneItems = dzToConfig.get(originDropZone).items;\n    originZoneItems.splice(originIndex, 0, shadowItem);\n    dispatchConsiderEvent(originDropZone, originZoneItems, {\n      trigger: TRIGGERS.DRAGGED_LEFT_ALL,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    });\n  }\n\n  dispatchConsiderEvent(e.currentTarget, items, {\n    trigger: TRIGGERS.DRAGGED_LEFT,\n    id: draggedElData[ITEM_ID_KEY],\n    source: SOURCES.POINTER\n  });\n}\n\nfunction handleDraggedIsOverIndex(e) {\n  isDraggedOutsideOfAnyDz = false;\n\n  var _dzToConfig$get3 = dzToConfig.get(e.currentTarget),\n      items = _dzToConfig$get3.items,\n      dropFromOthersDisabled = _dzToConfig$get3.dropFromOthersDisabled;\n\n  if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n    return;\n  }\n\n  var index = e.detail.indexObj.index;\n  var shadowElIdx = items.findIndex(function (item) {\n    return !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n  });\n  items.splice(shadowElIdx, 1);\n  items.splice(index, 0, shadowElData);\n  dispatchConsiderEvent(e.currentTarget, items, {\n    trigger: TRIGGERS.DRAGGED_OVER_INDEX,\n    id: draggedElData[ITEM_ID_KEY],\n    source: SOURCES.POINTER\n  });\n} // Global mouse/touch-events handlers\n\n\nfunction handleMouseMove(e) {\n  e.preventDefault();\n  var c = e.touches ? e.touches[0] : e;\n  currentMousePosition = {\n    x: c.clientX,\n    y: c.clientY\n  };\n  draggedEl.style.transform = \"translate3d(\".concat(currentMousePosition.x - dragStartMousePosition.x, \"px, \").concat(currentMousePosition.y - dragStartMousePosition.y, \"px, 0)\");\n}\n\nfunction handleDrop() {\n  finalizingPreviousDrag = true; // cleanup\n\n  window.removeEventListener(\"mousemove\", handleMouseMove);\n  window.removeEventListener(\"touchmove\", handleMouseMove);\n  window.removeEventListener(\"mouseup\", handleDrop);\n  window.removeEventListener(\"touchend\", handleDrop);\n  unWatchDraggedElement();\n  moveDraggedElementToWasDroppedState(draggedEl); // it was dropped in a drop-zone\n\n  var _dzToConfig$get4 = dzToConfig.get(shadowElDropZone),\n      items = _dzToConfig$get4.items,\n      type = _dzToConfig$get4.type;\n\n  styleInactiveDropZones(typeToDropZones.get(type), function (dz) {\n    return dzToConfig.get(dz).dropTargetStyle;\n  });\n  var shadowElIdx = items.findIndex(function (item) {\n    return !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n  }); // the handler might remove the shadow element, ex: dragula like copy on drag\n\n  if (shadowElIdx === -1) shadowElIdx = originIndex;\n  items = items.map(function (item) {\n    return item[SHADOW_ITEM_MARKER_PROPERTY_NAME] ? draggedElData : item;\n  });\n\n  function finalizeWithinZone() {\n    unlockOriginDzMinDimensions();\n    dispatchFinalizeEvent(shadowElDropZone, items, {\n      trigger: isDraggedOutsideOfAnyDz ? TRIGGERS.DROPPED_OUTSIDE_OF_ANY : TRIGGERS.DROPPED_INTO_ZONE,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    });\n\n    if (shadowElDropZone !== originDropZone) {\n      // letting the origin drop zone know the element was permanently taken away\n      dispatchFinalizeEvent(originDropZone, dzToConfig.get(originDropZone).items, {\n        trigger: TRIGGERS.DROPPED_INTO_ANOTHER,\n        id: draggedElData[ITEM_ID_KEY],\n        source: SOURCES.POINTER\n      });\n    }\n\n    unDecorateShadowElement(shadowElDropZone.children[shadowElIdx]);\n    cleanupPostDrop();\n  }\n\n  animateDraggedToFinalPosition(shadowElIdx, finalizeWithinZone);\n} // helper function for handleDrop\n\n\nfunction animateDraggedToFinalPosition(shadowElIdx, callback) {\n  var shadowElRect = shadowElDropZone.children[shadowElIdx].getBoundingClientRect();\n  var newTransform = {\n    x: shadowElRect.left - parseFloat(draggedEl.style.left),\n    y: shadowElRect.top - parseFloat(draggedEl.style.top)\n  };\n\n  var _dzToConfig$get5 = dzToConfig.get(shadowElDropZone),\n      dropAnimationDurationMs = _dzToConfig$get5.dropAnimationDurationMs;\n\n  var transition = \"transform \".concat(dropAnimationDurationMs, \"ms ease\");\n  draggedEl.style.transition = draggedEl.style.transition ? draggedEl.style.transition + \",\" + transition : transition;\n  draggedEl.style.transform = \"translate3d(\".concat(newTransform.x, \"px, \").concat(newTransform.y, \"px, 0)\");\n  window.setTimeout(callback, dropAnimationDurationMs);\n}\n/* cleanup */\n\n\nfunction cleanupPostDrop() {\n  draggedEl.remove();\n  originalDragTarget.remove();\n  draggedEl = undefined;\n  originalDragTarget = undefined;\n  draggedElData = undefined;\n  draggedElType = undefined;\n  originDropZone = undefined;\n  originIndex = undefined;\n  shadowElData = undefined;\n  shadowElDropZone = undefined;\n  dragStartMousePosition = undefined;\n  currentMousePosition = undefined;\n  isWorkingOnPreviousDrag = false;\n  finalizingPreviousDrag = false;\n  unlockOriginDzMinDimensions = undefined;\n  isDraggedOutsideOfAnyDz = false;\n}\n\nfunction dndzone(node, options) {\n  var config = {\n    items: undefined,\n    type: undefined,\n    flipDurationMs: 0,\n    dragDisabled: false,\n    dropFromOthersDisabled: false,\n    dropTargetStyle: DEFAULT_DROP_TARGET_STYLE,\n    transformDraggedElement: function transformDraggedElement() {}\n  };\n  var elToIdx = new Map();\n\n  function addMaybeListeners() {\n    window.addEventListener(\"mousemove\", handleMouseMoveMaybeDragStart, {\n      passive: false\n    });\n    window.addEventListener(\"touchmove\", handleMouseMoveMaybeDragStart, {\n      passive: false,\n      capture: false\n    });\n    window.addEventListener(\"mouseup\", handleFalseAlarm, {\n      passive: false\n    });\n    window.addEventListener(\"touchend\", handleFalseAlarm, {\n      passive: false\n    });\n  }\n\n  function removeMaybeListeners() {\n    window.removeEventListener(\"mousemove\", handleMouseMoveMaybeDragStart);\n    window.removeEventListener(\"touchmove\", handleMouseMoveMaybeDragStart);\n    window.removeEventListener(\"mouseup\", handleFalseAlarm);\n    window.removeEventListener(\"touchend\", handleFalseAlarm);\n  }\n\n  function handleFalseAlarm() {\n    removeMaybeListeners();\n    originalDragTarget = undefined;\n    dragStartMousePosition = undefined;\n    currentMousePosition = undefined;\n  }\n\n  function handleMouseMoveMaybeDragStart(e) {\n    e.preventDefault();\n    var c = e.touches ? e.touches[0] : e;\n    currentMousePosition = {\n      x: c.clientX,\n      y: c.clientY\n    };\n\n    if (Math.abs(currentMousePosition.x - dragStartMousePosition.x) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX || Math.abs(currentMousePosition.y - dragStartMousePosition.y) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX) {\n      removeMaybeListeners();\n      handleDragStart();\n    }\n  }\n\n  function handleMouseDown(e) {\n    // on safari clicking on a select element doesn't fire mouseup at the end of the click and in general this makes more sense\n    if (e.target !== e.currentTarget && (e.target.value !== undefined || e.target.isContentEditable)) {\n      return;\n    } // prevents responding to any button but left click which equals 0 (which is falsy)\n\n\n    if (e.button) {\n      return;\n    }\n\n    if (isWorkingOnPreviousDrag) {\n      return;\n    }\n\n    e.stopPropagation();\n    var c = e.touches ? e.touches[0] : e;\n    dragStartMousePosition = {\n      x: c.clientX,\n      y: c.clientY\n    };\n    currentMousePosition = _objectSpread2$1({}, dragStartMousePosition);\n    originalDragTarget = e.currentTarget;\n    addMaybeListeners();\n  }\n\n  function handleDragStart() {\n    isWorkingOnPreviousDrag = true; // initialising globals\n\n    var currentIdx = elToIdx.get(originalDragTarget);\n    originIndex = currentIdx;\n    originDropZone = originalDragTarget.parentElement;\n    var items = config.items,\n        type = config.type;\n    draggedElData = _objectSpread2$1({}, items[currentIdx]);\n    draggedElType = type;\n    shadowElData = _objectSpread2$1(_objectSpread2$1({}, draggedElData), {}, _defineProperty$1({}, SHADOW_ITEM_MARKER_PROPERTY_NAME, true)); // creating the draggable element\n\n    draggedEl = createDraggedElementFrom(originalDragTarget); // We will keep the original dom node in the dom because touch events keep firing on it, we want to re-add it after the framework removes it\n\n    function keepOriginalElementInDom() {\n      var itemsNow = config.items;\n\n      if (!draggedEl.parentElement && (!itemsNow[originIndex] || draggedElData[ITEM_ID_KEY] !== itemsNow[originIndex][ITEM_ID_KEY])) {\n        document.body.appendChild(draggedEl); // to prevent the outline from disappearing\n\n        draggedEl.focus();\n        watchDraggedElement();\n        hideOriginalDragTarget(originalDragTarget);\n        document.body.appendChild(originalDragTarget);\n      } else {\n        window.requestAnimationFrame(keepOriginalElementInDom);\n      }\n    }\n\n    window.requestAnimationFrame(keepOriginalElementInDom);\n    styleActiveDropZones(Array.from(typeToDropZones.get(config.type)).filter(function (dz) {\n      return dz === originDropZone || !dzToConfig.get(dz).dropFromOthersDisabled;\n    }), function (dz) {\n      return dzToConfig.get(dz).dropTargetStyle;\n    }); // removing the original element by removing its data entry\n\n    items.splice(currentIdx, 1);\n    unlockOriginDzMinDimensions = preventShrinking(originDropZone);\n    dispatchConsiderEvent(originDropZone, items, {\n      trigger: TRIGGERS.DRAG_STARTED,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    }); // handing over to global handlers - starting to watch the element\n\n    window.addEventListener(\"mousemove\", handleMouseMove, {\n      passive: false\n    });\n    window.addEventListener(\"touchmove\", handleMouseMove, {\n      passive: false,\n      capture: false\n    });\n    window.addEventListener(\"mouseup\", handleDrop, {\n      passive: false\n    });\n    window.addEventListener(\"touchend\", handleDrop, {\n      passive: false\n    });\n  }\n\n  function configure(_ref) {\n    var _ref$items = _ref.items,\n        items = _ref$items === void 0 ? undefined : _ref$items,\n        _ref$flipDurationMs = _ref.flipDurationMs,\n        dropAnimationDurationMs = _ref$flipDurationMs === void 0 ? 0 : _ref$flipDurationMs,\n        _ref$type = _ref.type,\n        newType = _ref$type === void 0 ? DEFAULT_DROP_ZONE_TYPE : _ref$type,\n        _ref$dragDisabled = _ref.dragDisabled,\n        dragDisabled = _ref$dragDisabled === void 0 ? false : _ref$dragDisabled,\n        _ref$dropFromOthersDi = _ref.dropFromOthersDisabled,\n        dropFromOthersDisabled = _ref$dropFromOthersDi === void 0 ? false : _ref$dropFromOthersDi,\n        _ref$dropTargetStyle = _ref.dropTargetStyle,\n        dropTargetStyle = _ref$dropTargetStyle === void 0 ? DEFAULT_DROP_TARGET_STYLE : _ref$dropTargetStyle,\n        _ref$transformDragged = _ref.transformDraggedElement,\n        transformDraggedElement = _ref$transformDragged === void 0 ? function () {} : _ref$transformDragged;\n    config.dropAnimationDurationMs = dropAnimationDurationMs;\n\n    if (config.type && newType !== config.type) {\n      unregisterDropZone(node, config.type);\n    }\n\n    config.type = newType;\n    registerDropZone(node, newType);\n    config.items = _toConsumableArray(items);\n    config.dragDisabled = dragDisabled;\n    config.transformDraggedElement = transformDraggedElement; // realtime update for dropTargetStyle\n\n    if (isWorkingOnPreviousDrag && !finalizingPreviousDrag && !areObjectsShallowEqual(dropTargetStyle, config.dropTargetStyle)) {\n      styleInactiveDropZones([node], function () {\n        return config.dropTargetStyle;\n      });\n      styleActiveDropZones([node], function () {\n        return dropTargetStyle;\n      });\n    }\n\n    config.dropTargetStyle = dropTargetStyle; // realtime update for dropFromOthersDisabled\n\n    if (isWorkingOnPreviousDrag && config.dropFromOthersDisabled !== dropFromOthersDisabled) {\n      if (dropFromOthersDisabled) {\n        styleInactiveDropZones([node], function (dz) {\n          return dzToConfig.get(dz).dropTargetStyle;\n        });\n      } else {\n        styleActiveDropZones([node], function (dz) {\n          return dzToConfig.get(dz).dropTargetStyle;\n        });\n      }\n    }\n\n    config.dropFromOthersDisabled = dropFromOthersDisabled;\n    dzToConfig.set(node, config);\n\n    var _loop = function _loop(idx) {\n      var draggableEl = node.children[idx];\n      styleDraggable(draggableEl, dragDisabled);\n\n      if (config.items[idx][SHADOW_ITEM_MARKER_PROPERTY_NAME]) {\n        morphDraggedElementToBeLike(draggedEl, draggableEl, currentMousePosition.x, currentMousePosition.y, function () {\n          return config.transformDraggedElement(draggedEl, draggedElData, idx);\n        });\n        decorateShadowEl(draggableEl);\n        return \"continue\";\n      }\n\n      draggableEl.removeEventListener(\"mousedown\", elToMouseDownListener.get(draggableEl));\n      draggableEl.removeEventListener(\"touchstart\", elToMouseDownListener.get(draggableEl));\n\n      if (!dragDisabled) {\n        draggableEl.addEventListener(\"mousedown\", handleMouseDown);\n        draggableEl.addEventListener(\"touchstart\", handleMouseDown);\n        elToMouseDownListener.set(draggableEl, handleMouseDown);\n      } // updating the idx\n\n\n      elToIdx.set(draggableEl, idx);\n    };\n\n    for (var idx = 0; idx < node.children.length; idx++) {\n      var _ret = _loop(idx);\n\n      if (_ret === \"continue\") continue;\n    }\n  }\n\n  configure(options);\n  return {\n    update: function update(newOptions) {\n      configure(newOptions);\n    },\n    destroy: function destroy() {\n      unregisterDropZone(node, config.type);\n      dzToConfig[\"delete\"](node);\n    }\n  };\n}\n\nvar _ID_TO_INSTRUCTION;\n\nvar INSTRUCTION_IDs = {\n  DND_ZONE_ACTIVE: \"dnd-zone-active\",\n  DND_ZONE_DRAG_DISABLED: \"dnd-zone-drag-disabled\"\n};\nvar ID_TO_INSTRUCTION = (_ID_TO_INSTRUCTION = {}, _defineProperty$1(_ID_TO_INSTRUCTION, INSTRUCTION_IDs.DND_ZONE_ACTIVE, \"Tab to one the items and press space-bar or enter to start dragging it\"), _defineProperty$1(_ID_TO_INSTRUCTION, INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED, \"This is a disabled drag and drop list\"), _ID_TO_INSTRUCTION);\nvar ALERT_DIV_ID = \"dnd-action-aria-alert\";\nvar alertsDiv;\n/**\n * Initializes the static aria instructions so they can be attached to zones\n * @return {{DND_ZONE_ACTIVE: string, DND_ZONE_DRAG_DISABLED: string} | null} - the IDs for static aria instruction (to be used via aria-describedby) or null on the server\n */\n\nfunction initAria() {\n  if (isOnServer) return null;\n  window.addEventListener(\"DOMContentLoaded\", function () {\n    // setting the dynamic alerts\n    alertsDiv = document.createElement(\"div\");\n\n    (function initAlertsDiv() {\n      alertsDiv.id = ALERT_DIV_ID; // tab index -1 makes the alert be read twice on chrome for some reason\n      //alertsDiv.tabIndex = -1;\n\n      alertsDiv.style.position = \"fixed\";\n      alertsDiv.style.bottom = \"0\";\n      alertsDiv.style.left = \"0\";\n      alertsDiv.style.zIndex = \"-5\";\n      alertsDiv.style.opacity = \"0\";\n      alertsDiv.style.height = \"0\";\n      alertsDiv.style.width = \"0\";\n      alertsDiv.setAttribute(\"role\", \"alert\");\n    })();\n\n    document.body.prepend(alertsDiv); // setting the instructions\n\n    Object.entries(ID_TO_INSTRUCTION).forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          id = _ref2[0],\n          txt = _ref2[1];\n\n      return document.body.prepend(instructionToHiddenDiv(id, txt));\n    });\n  });\n  return _objectSpread2$1({}, INSTRUCTION_IDs);\n}\n\nfunction instructionToHiddenDiv(id, txt) {\n  var div = document.createElement(\"div\");\n  div.id = id;\n  div.innerHTML = \"<p>\".concat(txt, \"</p>\");\n  div.style.display = \"none\";\n  div.style.position = \"fixed\";\n  div.style.zIndex = \"-5\";\n  return div;\n}\n/**\n * Will make the screen reader alert the provided text to the user\n * @param {string} txt\n */\n\n\nfunction alertToScreenReader(txt) {\n  alertsDiv.innerHTML = \"\";\n  var alertText = document.createTextNode(txt);\n  alertsDiv.appendChild(alertText); // this is needed for Safari\n\n  alertsDiv.style.display = \"none\";\n  alertsDiv.style.display = \"inline\";\n}\n\nvar DEFAULT_DROP_ZONE_TYPE$1 = \"--any--\";\nvar DEFAULT_DROP_TARGET_STYLE$1 = {\n  outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\nvar isDragging = false;\nvar draggedItemType;\nvar focusedDz;\nvar focusedDzLabel = \"\";\nvar focusedItem;\nvar focusedItemId;\nvar focusedItemLabel = \"\";\nvar allDragTargets = new WeakSet();\nvar elToKeyDownListeners = new WeakMap();\nvar elToFocusListeners = new WeakMap();\nvar dzToHandles = new Map();\nvar dzToConfig$1 = new Map();\nvar typeToDropZones$1 = new Map();\n/* TODO (potentially)\n * what's the deal with the black border of voice-reader not following focus?\n * maybe keep focus on the last dragged item upon drop?\n */\n\nvar INSTRUCTION_IDs$1 = initAria();\n/* drop-zones registration management */\n\nfunction registerDropZone$1(dropZoneEl, type) {\n  if (typeToDropZones$1.size === 0) {\n    window.addEventListener(\"keydown\", globalKeyDownHandler);\n    window.addEventListener(\"click\", globalClickHandler);\n  }\n\n  if (!typeToDropZones$1.has(type)) {\n    typeToDropZones$1.set(type, new Set());\n  }\n\n  if (!typeToDropZones$1.get(type).has(dropZoneEl)) {\n    typeToDropZones$1.get(type).add(dropZoneEl);\n    incrementActiveDropZoneCount();\n  }\n}\n\nfunction unregisterDropZone$1(dropZoneEl, type) {\n  if (focusedDz === dropZoneEl) {\n    handleDrop$1();\n  }\n\n  typeToDropZones$1.get(type)[\"delete\"](dropZoneEl);\n  decrementActiveDropZoneCount();\n\n  if (typeToDropZones$1.get(type).size === 0) {\n    typeToDropZones$1[\"delete\"](type);\n  }\n\n  if (typeToDropZones$1.size === 0) {\n    window.removeEventListener(\"keydown\", globalKeyDownHandler);\n    window.removeEventListener(\"click\", globalClickHandler);\n  }\n}\n\nfunction globalKeyDownHandler(e) {\n  if (!isDragging) return;\n\n  switch (e.key) {\n    case \"Escape\":\n      {\n        handleDrop$1();\n        break;\n      }\n  }\n}\n\nfunction globalClickHandler() {\n  if (!isDragging) return;\n\n  if (!allDragTargets.has(document.activeElement)) {\n    handleDrop$1();\n  }\n}\n\nfunction handleZoneFocus(e) {\n  if (!isDragging) return;\n  var newlyFocusedDz = e.currentTarget;\n  if (newlyFocusedDz === focusedDz) return;\n  focusedDzLabel = newlyFocusedDz.getAttribute(\"aria-label\") || \"\";\n\n  var _dzToConfig$get = dzToConfig$1.get(focusedDz),\n      originItems = _dzToConfig$get.items;\n\n  var originItem = originItems.find(function (item) {\n    return item[ITEM_ID_KEY] === focusedItemId;\n  });\n  var originIdx = originItems.indexOf(originItem);\n  var itemToMove = originItems.splice(originIdx, 1)[0];\n\n  var _dzToConfig$get2 = dzToConfig$1.get(newlyFocusedDz),\n      targetItems = _dzToConfig$get2.items,\n      autoAriaDisabled = _dzToConfig$get2.autoAriaDisabled;\n\n  if (newlyFocusedDz.getBoundingClientRect().top < focusedDz.getBoundingClientRect().top || newlyFocusedDz.getBoundingClientRect().left < focusedDz.getBoundingClientRect().left) {\n    targetItems.push(itemToMove);\n\n    if (!autoAriaDisabled) {\n      alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to the end of the list \").concat(focusedDzLabel));\n    }\n  } else {\n    targetItems.unshift(itemToMove);\n\n    if (!autoAriaDisabled) {\n      alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to the beginning of the list \").concat(focusedDzLabel));\n    }\n  }\n\n  var dzFrom = focusedDz;\n  dispatchFinalizeEvent(dzFrom, originItems, {\n    trigger: TRIGGERS.DROPPED_INTO_ANOTHER,\n    id: focusedItemId,\n    source: SOURCES.KEYBOARD\n  });\n  dispatchFinalizeEvent(newlyFocusedDz, targetItems, {\n    trigger: TRIGGERS.DROPPED_INTO_ZONE,\n    id: focusedItemId,\n    source: SOURCES.KEYBOARD\n  });\n  focusedDz = newlyFocusedDz;\n}\n\nfunction triggerAllDzsUpdate() {\n  dzToHandles.forEach(function (_ref, dz) {\n    var update = _ref.update;\n    return update(dzToConfig$1.get(dz));\n  });\n}\n\nfunction handleDrop$1() {\n  var dispatchConsider = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n  if (!dzToConfig$1.get(focusedDz).autoAriaDisabled) {\n    alertToScreenReader(\"Stopped dragging item \".concat(focusedItemLabel));\n  }\n\n  if (allDragTargets.has(document.activeElement)) {\n    document.activeElement.blur();\n  }\n\n  if (dispatchConsider) {\n    dispatchConsiderEvent(focusedDz, dzToConfig$1.get(focusedDz).items, {\n      trigger: TRIGGERS.DRAG_STOPPED,\n      id: focusedItemId,\n      source: SOURCES.KEYBOARD\n    });\n  }\n\n  styleInactiveDropZones(typeToDropZones$1.get(draggedItemType), function (dz) {\n    return dzToConfig$1.get(dz).dropTargetStyle;\n  });\n  focusedItem = null;\n  focusedItemId = null;\n  focusedItemLabel = \"\";\n  draggedItemType = null;\n  focusedDz = null;\n  focusedDzLabel = \"\";\n  isDragging = false;\n  triggerAllDzsUpdate();\n} //////\n\n\nfunction dndzone$1(node, options) {\n  var config = {\n    items: undefined,\n    type: undefined,\n    dragDisabled: false,\n    dropFromOthersDisabled: false,\n    dropTargetStyle: DEFAULT_DROP_TARGET_STYLE$1,\n    autoAriaDisabled: false\n  };\n\n  function swap(arr, i, j) {\n    if (arr.length <= 1) return;\n    arr.splice(j, 1, arr.splice(i, 1, arr[j])[0]);\n  }\n\n  function handleKeyDown(e) {\n    switch (e.key) {\n      case \"Enter\":\n      case \" \":\n        {\n          // we don't want to affect nested input elements\n          if ((e.target.value !== undefined || e.target.isContentEditable) && !allDragTargets.has(e.target)) {\n            return;\n          }\n\n          e.preventDefault(); // preventing scrolling on spacebar\n\n          e.stopPropagation();\n\n          if (isDragging) {\n            // TODO - should this trigger a drop? only here or in general (as in when hitting space or enter outside of any zone)?\n            handleDrop$1();\n          } else {\n            // drag start\n            handleDragStart(e);\n          }\n\n          break;\n        }\n\n      case \"ArrowDown\":\n      case \"ArrowRight\":\n        {\n          if (!isDragging) return;\n          e.preventDefault(); // prevent scrolling\n\n          e.stopPropagation();\n\n          var _dzToConfig$get3 = dzToConfig$1.get(node),\n              items = _dzToConfig$get3.items;\n\n          var children = Array.from(node.children);\n          var idx = children.indexOf(e.currentTarget);\n\n          if (idx < children.length - 1) {\n            if (!config.autoAriaDisabled) {\n              alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to position \").concat(idx + 2, \" in the list \").concat(focusedDzLabel));\n            }\n\n            swap(items, idx, idx + 1);\n            dispatchFinalizeEvent(node, items, {\n              trigger: TRIGGERS.DROPPED_INTO_ZONE,\n              id: focusedItemId,\n              source: SOURCES.KEYBOARD\n            });\n          }\n\n          break;\n        }\n\n      case \"ArrowUp\":\n      case \"ArrowLeft\":\n        {\n          if (!isDragging) return;\n          e.preventDefault(); // prevent scrolling\n\n          e.stopPropagation();\n\n          var _dzToConfig$get4 = dzToConfig$1.get(node),\n              _items = _dzToConfig$get4.items;\n\n          var _children = Array.from(node.children);\n\n          var _idx = _children.indexOf(e.currentTarget);\n\n          if (_idx > 0) {\n            if (!config.autoAriaDisabled) {\n              alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to position \").concat(_idx, \" in the list \").concat(focusedDzLabel));\n            }\n\n            swap(_items, _idx, _idx - 1);\n            dispatchFinalizeEvent(node, _items, {\n              trigger: TRIGGERS.DROPPED_INTO_ZONE,\n              id: focusedItemId,\n              source: SOURCES.KEYBOARD\n            });\n          }\n\n          break;\n        }\n    }\n  }\n\n  function handleDragStart(e) {\n    setCurrentFocusedItem(e.currentTarget);\n    focusedDz = node;\n    draggedItemType = config.type;\n    isDragging = true;\n    var dropTargets = Array.from(typeToDropZones$1.get(config.type)).filter(function (dz) {\n      return dz === focusedDz || !dzToConfig$1.get(dz).dropFromOthersDisabled;\n    });\n    styleActiveDropZones(dropTargets, function (dz) {\n      return dzToConfig$1.get(dz).dropTargetStyle;\n    });\n\n    if (!config.autoAriaDisabled) {\n      var msg = \"Started dragging item \".concat(focusedItemLabel, \". Use the arrow keys to move it within its list \").concat(focusedDzLabel);\n\n      if (dropTargets.length > 1) {\n        msg += \", or tab to another list in order to move the item into it\";\n      }\n\n      alertToScreenReader(msg);\n    }\n\n    dispatchConsiderEvent(node, dzToConfig$1.get(node).items, {\n      trigger: TRIGGERS.DRAG_STARTED,\n      id: focusedItemId,\n      source: SOURCES.KEYBOARD\n    });\n    triggerAllDzsUpdate();\n  }\n\n  function handleClick(e) {\n    if (!isDragging) return;\n    if (e.currentTarget === focusedItem) return;\n    e.stopPropagation();\n    handleDrop$1(false);\n    handleDragStart(e);\n  }\n\n  function setCurrentFocusedItem(draggableEl) {\n    var _dzToConfig$get5 = dzToConfig$1.get(node),\n        items = _dzToConfig$get5.items;\n\n    var children = Array.from(node.children);\n    var focusedItemIdx = children.indexOf(draggableEl);\n    focusedItem = draggableEl;\n    focusedItemId = items[focusedItemIdx][ITEM_ID_KEY];\n    focusedItemLabel = children[focusedItemIdx].getAttribute(\"aria-label\") || \"\";\n  }\n\n  function configure(_ref2) {\n    var _ref2$items = _ref2.items,\n        items = _ref2$items === void 0 ? [] : _ref2$items,\n        _ref2$type = _ref2.type,\n        newType = _ref2$type === void 0 ? DEFAULT_DROP_ZONE_TYPE$1 : _ref2$type,\n        _ref2$dragDisabled = _ref2.dragDisabled,\n        dragDisabled = _ref2$dragDisabled === void 0 ? false : _ref2$dragDisabled,\n        _ref2$dropFromOthersD = _ref2.dropFromOthersDisabled,\n        dropFromOthersDisabled = _ref2$dropFromOthersD === void 0 ? false : _ref2$dropFromOthersD,\n        _ref2$dropTargetStyle = _ref2.dropTargetStyle,\n        dropTargetStyle = _ref2$dropTargetStyle === void 0 ? DEFAULT_DROP_TARGET_STYLE$1 : _ref2$dropTargetStyle,\n        _ref2$autoAriaDisable = _ref2.autoAriaDisabled,\n        autoAriaDisabled = _ref2$autoAriaDisable === void 0 ? false : _ref2$autoAriaDisable;\n    config.items = _toConsumableArray(items);\n    config.dragDisabled = dragDisabled;\n    config.dropFromOthersDisabled = dropFromOthersDisabled;\n    config.dropTargetStyle = dropTargetStyle;\n    config.autoAriaDisabled = autoAriaDisabled;\n\n    if (!autoAriaDisabled) {\n      node.setAttribute(\"aria-disabled\", dragDisabled);\n      node.setAttribute(\"role\", \"list\");\n      node.setAttribute(\"aria-describedby\", dragDisabled ? INSTRUCTION_IDs$1.DND_ZONE_DRAG_DISABLED : INSTRUCTION_IDs$1.DND_ZONE_ACTIVE);\n    }\n\n    if (config.type && newType !== config.type) {\n      unregisterDropZone$1(node, config.type);\n    }\n\n    config.type = newType;\n    registerDropZone$1(node, newType);\n    dzToConfig$1.set(node, config);\n    node.tabIndex = isDragging && (node === focusedDz || focusedItem.contains(node) || config.dropFromOthersDisabled || focusedDz && config.type !== dzToConfig$1.get(focusedDz).type) ? -1 : 0;\n    node.addEventListener(\"focus\", handleZoneFocus);\n\n    var _loop = function _loop(i) {\n      var draggableEl = node.children[i];\n      allDragTargets.add(draggableEl);\n      draggableEl.tabIndex = isDragging ? -1 : 0;\n\n      if (!autoAriaDisabled) {\n        draggableEl.setAttribute(\"role\", \"listitem\");\n      }\n\n      draggableEl.removeEventListener(\"keydown\", elToKeyDownListeners.get(draggableEl));\n      draggableEl.removeEventListener(\"click\", elToFocusListeners.get(draggableEl));\n\n      if (!dragDisabled) {\n        draggableEl.addEventListener(\"keydown\", handleKeyDown);\n        elToKeyDownListeners.set(draggableEl, handleKeyDown);\n        draggableEl.addEventListener(\"click\", handleClick);\n        elToFocusListeners.set(draggableEl, handleClick);\n      }\n\n      if (isDragging && config.items[i][ITEM_ID_KEY] === focusedItemId) {\n        focusedItem = draggableEl; // without this the element loses focus if it moves backwards in the list\n\n        draggableEl.focus();\n      }\n    };\n\n    for (var i = 0; i < node.children.length; i++) {\n      _loop(i);\n    }\n  }\n\n  configure(options);\n  var handles = {\n    update: function update(newOptions) {\n      configure(newOptions);\n    },\n    destroy: function destroy() {\n      unregisterDropZone$1(node, config.type);\n      dzToConfig$1[\"delete\"](node);\n      dzToHandles[\"delete\"](node);\n    }\n  };\n  dzToHandles.set(node, handles);\n  return handles;\n}\n/**\n * A custom action to turn any container to a dnd zone and all of its direct children to draggables\n * Supports mouse, touch and keyboard interactions.\n * Dispatches two events that the container is expected to react to by modifying its list of items,\n * which will then feed back in to this action via the update function\n *\n * @typedef {Object} Options\n * @property {Array} items - the list of items that was used to generate the children of the given node (the list used in the #each block\n * @property {string} [type] - the type of the dnd zone. children dragged from here can only be dropped in other zones of the same type, default to a base type\n * @property {number} [flipDurationMs] - if the list animated using flip (recommended), specifies the flip duration such that everything syncs with it without conflict, defaults to zero\n * @property {boolean} [dragDisabled]\n * @property {boolean} [dropFromOthersDisabled]\n * @property {Object} [dropTargetStyle]\n * @property {Function} [transformDraggedElement]\n * @param {HTMLElement} node - the element to enhance\n * @param {Options} options\n * @return {{update: function, destroy: function}}\n */\n\n\nfunction dndzone$2(node, options) {\n  validateOptions(options);\n  var pointerZone = dndzone(node, options);\n  var keyboardZone = dndzone$1(node, options);\n  return {\n    update: function update(newOptions) {\n      validateOptions(newOptions);\n      pointerZone.update(newOptions);\n      keyboardZone.update(newOptions);\n    },\n    destroy: function destroy() {\n      pointerZone.destroy();\n      keyboardZone.destroy();\n    }\n  };\n}\n\nfunction validateOptions(options) {\n  /*eslint-disable*/\n  var items = options.items,\n      flipDurationMs = options.flipDurationMs,\n      type = options.type,\n      dragDisabled = options.dragDisabled,\n      dropFromOthersDisabled = options.dropFromOthersDisabled,\n      dropTargetStyle = options.dropTargetStyle,\n      transformDraggedElement = options.transformDraggedElement,\n      autoAriaDisabled = options.autoAriaDisabled,\n      rest = _objectWithoutProperties(options, [\"items\", \"flipDurationMs\", \"type\", \"dragDisabled\", \"dropFromOthersDisabled\", \"dropTargetStyle\", \"transformDraggedElement\", \"autoAriaDisabled\"]);\n  /*eslint-enable*/\n\n\n  if (Object.keys(rest).length > 0) {\n    console.warn(\"dndzone will ignore unknown options\", rest);\n  }\n\n  if (!items) {\n    throw new Error(\"no 'items' key provided to dndzone\");\n  }\n\n  var itemWithMissingId = items.find(function (item) {\n    return !{}.hasOwnProperty.call(item, ITEM_ID_KEY);\n  });\n\n  if (itemWithMissingId) {\n    throw new Error(\"missing '\".concat(ITEM_ID_KEY, \"' property for item \").concat(toString(itemWithMissingId)));\n  }\n}\n\nfunction createFlipper(node, durationMS) {\n  var idToRect = new Map();\n  var idToAnim = new Map();\n\n  function read(ids) {\n    //console.debug(`read got ${JSON.stringify(ids)}`);\n    Array.from(idToAnim.values()).forEach(function (anim) {\n      return anim.cancel();\n    });\n    idToRect = new Map();\n    Array.from(node.children).forEach(function (child, index) {\n      idToRect.set(ids[index], child.getBoundingClientRect());\n    });\n  }\n\n  function flip(ids) {\n    //console.debug(`flip got ${JSON.stringify(ids)}`);\n    Array.from(node.children).forEach(function (child, index) {\n      var id = ids[index];\n      var currentRect = child.getBoundingClientRect();\n      var prevRect = idToRect.get(id);\n\n      if (prevRect) {\n        var transformX = prevRect.left - currentRect.left;\n        var transformY = prevRect.top - currentRect.top;\n\n        if (transformX || transformY) {\n          var keyFrames = [{\n            transform: \"translate3d(\".concat(transformX, \"px, \").concat(transformY, \"px, 0)\")\n          }, {\n            transform: 'translate3d(0, 0, 0)'\n          }];\n          var animationObj = child.animate(keyFrames, {\n            duration: durationMS,\n            easing: \"ease-out\"\n          });\n          idToAnim.set(id, animationObj);\n\n          animationObj.onfinish = function () {\n            return idToAnim[\"delete\"](id);\n          };\n\n          animationObj.oncancel = function () {\n            return idToAnim[\"delete\"](id);\n          };\n        }\n      }\n    });\n  }\n\n  return {\n    read: read,\n    flip: flip\n  };\n}\n\nvar ID_KEY = \"id\";\n\nfunction overrideItemIdKeyNameBeforeInitialisingDndZones$1(newId) {\n  overrideItemIdKeyNameBeforeInitialisingDndZones(newId);\n  ID_KEY = newId;\n}\n\nvar DEFAULT_FLIP_DURATION_MS = 200;\n\nfunction useDndZone(nodeRef, options, onConsider) {\n  var onFinalize = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : onConsider;\n  var updateR = useRef(function () {});\n  var flipper = useRef({});\n  console.debug(\"action running \".concat(JSON.stringify(options, null, 2)));\n  useEffect(function init() {\n    if (!nodeRef.current) return;\n    console.debug(\"init\"); //TODO - deal with flip duration better, should i default to zero?\n\n    flipper.current = createFlipper(nodeRef.current, options.flipDurationMs !== undefined ? options.flipDurationMs : DEFAULT_FLIP_DURATION_MS);\n\n    var _svelteDndZone = dndzone$2(nodeRef.current, _objectSpread2({\n      flipDurationMs: DEFAULT_FLIP_DURATION_MS\n    }, options)),\n        update = _svelteDndZone.update,\n        destroy = _svelteDndZone.destroy;\n\n    updateR.current = update;\n    return destroy;\n  }, [nodeRef]);\n  useEffect(function addListeners() {\n    if (!nodeRef.current) return;\n    var node = nodeRef.current;\n    console.debug(\"adding listeners\", node);\n\n    function adaptConsider(e) {\n      if (flipper.current.read) {\n        flipper.current.read(options.items.map(function (item) {\n          return item[ID_KEY];\n        }));\n      }\n\n      onConsider(e.detail);\n    }\n\n    function adaptFinalize(e) {\n      if (flipper.current.read) {\n        flipper.current.read(options.items.map(function (item) {\n          return item[ID_KEY];\n        }));\n      }\n\n      onFinalize(e.detail);\n    }\n\n    node.addEventListener('consider', adaptConsider);\n    node.addEventListener('finalize', adaptFinalize);\n    return function () {\n      node.removeEventListener('consider', adaptConsider);\n      node.removeEventListener('finalize', adaptFinalize);\n    };\n  }, [nodeRef, options, onConsider, onFinalize]);\n  useLayoutEffect(function update() {\n    if (!nodeRef.current) return;\n    console.debug(\"updating \".concat(JSON.stringify(options)));\n    updateR.current(_objectSpread2({\n      flipDurationMs: DEFAULT_FLIP_DURATION_MS\n    }, options));\n  });\n  useLayoutEffect(function flip() {\n    if (flipper.current.flip) {\n      flipper.current.flip(options.items.map(function (item) {\n        return item[ID_KEY];\n      }));\n    }\n  }, [options.items]);\n}\n\nexport { SHADOW_ITEM_MARKER_PROPERTY_NAME, SOURCES, TRIGGERS, alertToScreenReader, overrideItemIdKeyNameBeforeInitialisingDndZones$1 as overrideItemIdKeyNameBeforeInitialisingDndZones, useDndZone };","map":{"version":3,"sources":["../node_modules/svelte-dnd-action/dist/index.mjs","../src/util/flip.js","../src/useDndZone.js"],"names":["_defineProperty","ownKeys","_objectSpread2","idToRect","idToAnim","Array","anim","node","ids","child","id","currentRect","prevRect","transformX","transformY","keyFrames","transform","animationObj","duration","easing","read","flip","ID_KEY","overrideIId","DEFAULT_FLIP_DURATION_MS","onFinalize","onConsider","updateR","useRef","flipper","console","JSON","useEffect","nodeRef","createFlipper","options","update","destroy","svelteDndZone","flipDurationMs","item","e","useLayoutEffect"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,iBAAT,CAAyB,GAAzB,EAA8B,GAA9B,EAAmC,KAAnC,EAA0C;AACxC,MAAI,GAAG,IAAI,GAAX,EAAgB;AACd,IAAA,MAAM,CAAC,cAAP,CAAsB,GAAtB,EAA2B,GAA3B,EAAgC;AAC9B,MAAA,KAAK,EAAE,KADuB;AAE9B,MAAA,UAAU,EAAE,IAFkB;AAG9B,MAAA,YAAY,EAAE,IAHgB;AAI9B,MAAA,QAAQ,EAAE;AAJoB,KAAhC;AAMD,GAPD,MAOO;AACL,IAAA,GAAG,CAAC,GAAD,CAAH,GAAW,KAAX;AACD;;AAED,SAAO,GAAP;AACD;;AAED,SAASC,SAAT,CAAiB,MAAjB,EAAyB,cAAzB,EAAyC;AACvC,MAAI,IAAI,GAAG,MAAM,CAAC,IAAP,CAAY,MAAZ,CAAX;;AAEA,MAAI,MAAM,CAAC,qBAAX,EAAkC;AAChC,QAAI,OAAO,GAAG,MAAM,CAAC,qBAAP,CAA6B,MAA7B,CAAd;AACA,QAAI,cAAJ,EAAoB,OAAO,GAAG,OAAO,CAAC,MAAR,CAAe,UAAU,GAAV,EAAe;AAC1D,aAAO,MAAM,CAAC,wBAAP,CAAgC,MAAhC,EAAwC,GAAxC,EAA6C,UAApD;AACD,KAF6B,CAAV;AAGpB,IAAA,IAAI,CAAC,IAAL,CAAU,KAAV,CAAgB,IAAhB,EAAsB,OAAtB;AACD;;AAED,SAAO,IAAP;AACD;;AAED,SAASC,gBAAT,CAAwB,MAAxB,EAAgC;AAC9B,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,SAAS,CAAC,MAA9B,EAAsC,CAAC,EAAvC,EAA2C;AACzC,QAAI,MAAM,GAAG,SAAS,CAAC,CAAD,CAAT,IAAgB,IAAhB,GAAuB,SAAS,CAAC,CAAD,CAAhC,GAAsC,EAAnD;;AAEA,QAAI,CAAC,GAAG,CAAR,EAAW;AACTD,MAAAA,SAAO,CAAC,MAAM,CAAC,MAAD,CAAP,EAAiB,IAAjB,CAAPA,CAA8B,OAA9BA,CAAsC,UAAU,GAAV,EAAe;AACnDD,QAAAA,iBAAe,CAAC,MAAD,EAAS,GAAT,EAAc,MAAM,CAAC,GAAD,CAApB,CAAfA;AACD,OAFDC;AAGD,KAJD,MAIO,IAAI,MAAM,CAAC,yBAAX,EAAsC;AAC3C,MAAA,MAAM,CAAC,gBAAP,CAAwB,MAAxB,EAAgC,MAAM,CAAC,yBAAP,CAAiC,MAAjC,CAAhC;AACD,KAFM,MAEA;AACLA,MAAAA,SAAO,CAAC,MAAM,CAAC,MAAD,CAAP,CAAPA,CAAwB,OAAxBA,CAAgC,UAAU,GAAV,EAAe;AAC7C,QAAA,MAAM,CAAC,cAAP,CAAsB,MAAtB,EAA8B,GAA9B,EAAmC,MAAM,CAAC,wBAAP,CAAgC,MAAhC,EAAwC,GAAxC,CAAnC;AACD,OAFDA;AAGD;AACF;;AAED,SAAO,MAAP;AACD;;AAED,SAAS,6BAAT,CAAuC,MAAvC,EAA+C,QAA/C,EAAyD;AACvD,MAAI,MAAM,IAAI,IAAd,EAAoB,OAAO,EAAP;AACpB,MAAI,MAAM,GAAG,EAAb;AACA,MAAI,UAAU,GAAG,MAAM,CAAC,IAAP,CAAY,MAAZ,CAAjB;AACA,MAAI,GAAJ,EAAS,CAAT;;AAEA,OAAK,CAAC,GAAG,CAAT,EAAY,CAAC,GAAG,UAAU,CAAC,MAA3B,EAAmC,CAAC,EAApC,EAAwC;AACtC,IAAA,GAAG,GAAG,UAAU,CAAC,CAAD,CAAhB;AACA,QAAI,QAAQ,CAAC,OAAT,CAAiB,GAAjB,KAAyB,CAA7B,EAAgC;AAChC,IAAA,MAAM,CAAC,GAAD,CAAN,GAAc,MAAM,CAAC,GAAD,CAApB;AACD;;AAED,SAAO,MAAP;AACD;;AAED,SAAS,wBAAT,CAAkC,MAAlC,EAA0C,QAA1C,EAAoD;AAClD,MAAI,MAAM,IAAI,IAAd,EAAoB,OAAO,EAAP;;AAEpB,MAAI,MAAM,GAAG,6BAA6B,CAAC,MAAD,EAAS,QAAT,CAA1C;;AAEA,MAAI,GAAJ,EAAS,CAAT;;AAEA,MAAI,MAAM,CAAC,qBAAX,EAAkC;AAChC,QAAI,gBAAgB,GAAG,MAAM,CAAC,qBAAP,CAA6B,MAA7B,CAAvB;;AAEA,SAAK,CAAC,GAAG,CAAT,EAAY,CAAC,GAAG,gBAAgB,CAAC,MAAjC,EAAyC,CAAC,EAA1C,EAA8C;AAC5C,MAAA,GAAG,GAAG,gBAAgB,CAAC,CAAD,CAAtB;AACA,UAAI,QAAQ,CAAC,OAAT,CAAiB,GAAjB,KAAyB,CAA7B,EAAgC;AAChC,UAAI,CAAC,MAAM,CAAC,SAAP,CAAiB,oBAAjB,CAAsC,IAAtC,CAA2C,MAA3C,EAAmD,GAAnD,CAAL,EAA8D;AAC9D,MAAA,MAAM,CAAC,GAAD,CAAN,GAAc,MAAM,CAAC,GAAD,CAApB;AACD;AACF;;AAED,SAAO,MAAP;AACD;;AAED,SAAS,cAAT,CAAwB,GAAxB,EAA6B,CAA7B,EAAgC;AAC9B,SAAO,eAAe,CAAC,GAAD,CAAf,IAAwB,qBAAqB,CAAC,GAAD,EAAM,CAAN,CAA7C,IAAyD,2BAA2B,CAAC,GAAD,EAAM,CAAN,CAApF,IAAgG,gBAAgB,EAAvH;AACD;;AAED,SAAS,kBAAT,CAA4B,GAA5B,EAAiC;AAC/B,SAAO,kBAAkB,CAAC,GAAD,CAAlB,IAA2B,gBAAgB,CAAC,GAAD,CAA3C,IAAoD,2BAA2B,CAAC,GAAD,CAA/E,IAAwF,kBAAkB,EAAjH;AACD;;AAED,SAAS,kBAAT,CAA4B,GAA5B,EAAiC;AAC/B,MAAI,KAAK,CAAC,OAAN,CAAc,GAAd,CAAJ,EAAwB,OAAO,iBAAiB,CAAC,GAAD,CAAxB;AACzB;;AAED,SAAS,eAAT,CAAyB,GAAzB,EAA8B;AAC5B,MAAI,KAAK,CAAC,OAAN,CAAc,GAAd,CAAJ,EAAwB,OAAO,GAAP;AACzB;;AAED,SAAS,gBAAT,CAA0B,IAA1B,EAAgC;AAC9B,MAAI,OAAO,MAAP,KAAkB,WAAlB,IAAiC,MAAM,CAAC,QAAP,IAAmB,MAAM,CAAC,IAAD,CAA9D,EAAsE,OAAO,KAAK,CAAC,IAAN,CAAW,IAAX,CAAP;AACvE;;AAED,SAAS,qBAAT,CAA+B,GAA/B,EAAoC,CAApC,EAAuC;AACrC,MAAI,OAAO,MAAP,KAAkB,WAAlB,IAAiC,EAAE,MAAM,CAAC,QAAP,IAAmB,MAAM,CAAC,GAAD,CAA3B,CAArC,EAAwE;AACxE,MAAI,IAAI,GAAG,EAAX;AACA,MAAI,EAAE,GAAG,IAAT;AACA,MAAI,EAAE,GAAG,KAAT;AACA,MAAI,EAAE,GAAG,SAAT;;AAEA,MAAI;AACF,SAAK,IAAI,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,QAAR,CAAH,EAAT,EAAiC,EAAtC,EAA0C,EAAE,EAAE,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,IAAH,EAAN,EAAiB,IAAxB,CAA1C,EAAyE,EAAE,GAAG,IAA9E,EAAoF;AAClF,MAAA,IAAI,CAAC,IAAL,CAAU,EAAE,CAAC,KAAb;;AAEA,UAAI,CAAC,IAAI,IAAI,CAAC,MAAL,KAAgB,CAAzB,EAA4B;AAC7B;AACF,GAND,CAME,OAAO,GAAP,EAAY;AACZ,IAAA,EAAE,GAAG,IAAL;AACA,IAAA,EAAE,GAAG,GAAL;AACD,GATD,SASU;AACR,QAAI;AACF,UAAI,CAAC,EAAD,IAAO,EAAE,CAAC,QAAD,CAAF,IAAgB,IAA3B,EAAiC,EAAE,CAAC,QAAD,CAAF;AAClC,KAFD,SAEU;AACR,UAAI,EAAJ,EAAQ,MAAM,EAAN;AACT;AACF;;AAED,SAAO,IAAP;AACD;;AAED,SAAS,2BAAT,CAAqC,CAArC,EAAwC,MAAxC,EAAgD;AAC9C,MAAI,CAAC,CAAL,EAAQ;AACR,MAAI,OAAO,CAAP,KAAa,QAAjB,EAA2B,OAAO,iBAAiB,CAAC,CAAD,EAAI,MAAJ,CAAxB;AAC3B,MAAI,CAAC,GAAG,MAAM,CAAC,SAAP,CAAiB,QAAjB,CAA0B,IAA1B,CAA+B,CAA/B,EAAkC,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAR;AACA,MAAI,CAAC,KAAK,QAAN,IAAkB,CAAC,CAAC,WAAxB,EAAqC,CAAC,GAAG,CAAC,CAAC,WAAF,CAAc,IAAlB;AACrC,MAAI,CAAC,KAAK,KAAN,IAAe,CAAC,KAAK,KAAzB,EAAgC,OAAO,KAAK,CAAC,IAAN,CAAW,CAAX,CAAP;AAChC,MAAI,CAAC,KAAK,WAAN,IAAqB,2CAA2C,IAA3C,CAAgD,CAAhD,CAAzB,EAA6E,OAAO,iBAAiB,CAAC,CAAD,EAAI,MAAJ,CAAxB;AAC9E;;AAED,SAAS,iBAAT,CAA2B,GAA3B,EAAgC,GAAhC,EAAqC;AACnC,MAAI,GAAG,IAAI,IAAP,IAAe,GAAG,GAAG,GAAG,CAAC,MAA7B,EAAqC,GAAG,GAAG,GAAG,CAAC,MAAV;;AAErC,OAAK,IAAI,CAAC,GAAG,CAAR,EAAW,IAAI,GAAG,IAAI,KAAJ,CAAU,GAAV,CAAvB,EAAuC,CAAC,GAAG,GAA3C,EAAgD,CAAC,EAAjD,EAAqD,IAAI,CAAC,CAAD,CAAJ,GAAU,GAAG,CAAC,CAAD,CAAb;;AAErD,SAAO,IAAP;AACD;;AAED,SAAS,kBAAT,GAA8B;AAC5B,QAAM,IAAI,SAAJ,CAAc,sIAAd,CAAN;AACD;;AAED,SAAS,gBAAT,GAA4B;AAC1B,QAAM,IAAI,SAAJ,CAAc,2IAAd,CAAN;AACD;;AAED,SAAS,0BAAT,CAAoC,CAApC,EAAuC,cAAvC,EAAuD;AACrD,MAAI,EAAJ;;AAEA,MAAI,OAAO,MAAP,KAAkB,WAAlB,IAAiC,CAAC,CAAC,MAAM,CAAC,QAAR,CAAD,IAAsB,IAA3D,EAAiE;AAC/D,QAAI,KAAK,CAAC,OAAN,CAAc,CAAd,MAAqB,EAAE,GAAG,2BAA2B,CAAC,CAAD,CAArD,KAA6D,cAAc,IAAI,CAAlB,IAAuB,OAAO,CAAC,CAAC,MAAT,KAAoB,QAA5G,EAAsH;AACpH,UAAI,EAAJ,EAAQ,CAAC,GAAG,EAAJ;AACR,UAAI,CAAC,GAAG,CAAR;;AAEA,UAAI,CAAC,GAAG,YAAY,CAAE,CAAtB;;AAEA,aAAO;AACL,QAAA,CAAC,EAAE,CADE;AAEL,QAAA,CAAC,EAAE,YAAY;AACb,cAAI,CAAC,IAAI,CAAC,CAAC,MAAX,EAAmB,OAAO;AACxB,YAAA,IAAI,EAAE;AADkB,WAAP;AAGnB,iBAAO;AACL,YAAA,IAAI,EAAE,KADD;AAEL,YAAA,KAAK,EAAE,CAAC,CAAC,CAAC,EAAF;AAFH,WAAP;AAID,SAVI;AAWL,QAAA,CAAC,EAAE,UAAU,CAAV,EAAa;AACd,gBAAM,CAAN;AACD,SAbI;AAcL,QAAA,CAAC,EAAE;AAdE,OAAP;AAgBD;;AAED,UAAM,IAAI,SAAJ,CAAc,uIAAd,CAAN;AACD;;AAED,MAAI,gBAAgB,GAAG,IAAvB;AAAA,MACI,MAAM,GAAG,KADb;AAAA,MAEI,GAFJ;AAGA,SAAO;AACL,IAAA,CAAC,EAAE,YAAY;AACb,MAAA,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC,QAAR,CAAD,EAAL;AACD,KAHI;AAIL,IAAA,CAAC,EAAE,YAAY;AACb,UAAI,IAAI,GAAG,EAAE,CAAC,IAAH,EAAX;AACA,MAAA,gBAAgB,GAAG,IAAI,CAAC,IAAxB;AACA,aAAO,IAAP;AACD,KARI;AASL,IAAA,CAAC,EAAE,UAAU,CAAV,EAAa;AACd,MAAA,MAAM,GAAG,IAAT;AACA,MAAA,GAAG,GAAG,CAAN;AACD,KAZI;AAaL,IAAA,CAAC,EAAE,YAAY;AACb,UAAI;AACF,YAAI,CAAC,gBAAD,IAAqB,EAAE,CAAC,MAAH,IAAa,IAAtC,EAA4C,EAAE,CAAC,MAAH;AAC7C,OAFD,SAEU;AACR,YAAI,MAAJ,EAAY,MAAM,GAAN;AACb;AACF;AAnBI,GAAP;AAqBD,C,CAED;;;AACA,IAAI,mBAAmB,GAAG,UAA1B;AACA,IAAI,mBAAmB,GAAG,UAA1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,qBAAT,CAA+B,EAA/B,EAAmC,KAAnC,EAA0C,IAA1C,EAAgD;AAC9C,EAAA,EAAE,CAAC,aAAH,CAAiB,IAAI,WAAJ,CAAgB,mBAAhB,EAAqC;AACpD,IAAA,MAAM,EAAE;AACN,MAAA,KAAK,EAAE,KADD;AAEN,MAAA,IAAI,EAAE;AAFA;AAD4C,GAArC,CAAjB;AAMD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,qBAAT,CAA+B,EAA/B,EAAmC,KAAnC,EAA0C,IAA1C,EAAgD;AAC9C,EAAA,EAAE,CAAC,aAAH,CAAiB,IAAI,WAAJ,CAAgB,mBAAhB,EAAqC;AACpD,IAAA,MAAM,EAAE;AACN,MAAA,KAAK,EAAE,KADD;AAEN,MAAA,IAAI,EAAE;AAFA;AAD4C,GAArC,CAAjB;AAMD,C,CAAA;;;AAED,IAAI,0BAA0B,GAAG,gBAAjC;AACA,IAAI,uBAAuB,GAAG,aAA9B;AACA,IAAI,6BAA6B,GAAG,kBAApC;AACA,IAAI,gCAAgC,GAAG,qBAAvC;AACA,IAAI,kBAAkB,GAAG;AACvB,EAAA,gBAAgB,EAAE,gBADK;AAEvB,EAAA,cAAc,EAAE;AAFO,CAAzB;;AAIA,SAAS,sCAAT,CAAgD,WAAhD,EAA6D,QAA7D,EAAuE,SAAvE,EAAkF;AAChF,EAAA,WAAW,CAAC,aAAZ,CAA0B,IAAI,WAAJ,CAAgB,0BAAhB,EAA4C;AACpE,IAAA,MAAM,EAAE;AACN,MAAA,QAAQ,EAAE,QADJ;AAEN,MAAA,SAAS,EAAE;AAFL;AAD4D,GAA5C,CAA1B;AAMD;;AACD,SAAS,6CAAT,CAAuD,WAAvD,EAAoE,SAApE,EAA+E;AAC7E,EAAA,WAAW,CAAC,aAAZ,CAA0B,IAAI,WAAJ,CAAgB,uBAAhB,EAAyC;AACjE,IAAA,MAAM,EAAE;AACN,MAAA,SAAS,EAAE,SADL;AAEN,MAAA,IAAI,EAAE,kBAAkB,CAAC;AAFnB;AADyD,GAAzC,CAA1B;AAMD;;AACD,SAAS,0CAAT,CAAoD,WAApD,EAAiE,SAAjE,EAA4E;AAC1E,EAAA,WAAW,CAAC,aAAZ,CAA0B,IAAI,WAAJ,CAAgB,uBAAhB,EAAyC;AACjE,IAAA,MAAM,EAAE;AACN,MAAA,SAAS,EAAE,SADL;AAEN,MAAA,IAAI,EAAE,kBAAkB,CAAC;AAFnB;AADyD,GAAzC,CAA1B;AAMD;;AACD,SAAS,iCAAT,CAA2C,WAA3C,EAAwD,QAAxD,EAAkE,SAAlE,EAA6E;AAC3E,EAAA,WAAW,CAAC,aAAZ,CAA0B,IAAI,WAAJ,CAAgB,6BAAhB,EAA+C;AACvE,IAAA,MAAM,EAAE;AACN,MAAA,QAAQ,EAAE,QADJ;AAEN,MAAA,SAAS,EAAE;AAFL;AAD+D,GAA/C,CAA1B;AAMD;;AACD,SAAS,2BAAT,CAAqC,SAArC,EAAgD;AAC9C,EAAA,MAAM,CAAC,aAAP,CAAqB,IAAI,WAAJ,CAAgB,gCAAhB,EAAkD;AACrE,IAAA,MAAM,EAAE;AACN,MAAA,SAAS,EAAE;AADL;AAD6D,GAAlD,CAArB;AAKD;;AAEE,IAAC,QAAQ,GAAG;AACb,EAAA,YAAY,EAAE,aADD;AAEb,EAAA,eAAe,EAAE,0BAFJ;AAGb,EAAA,uBAAuB,EAAE,oBAHZ;AAIb,EAAA,kBAAkB,EAAE,6BAJP;AAKb,EAAA,YAAY,EAAE,uBALD;AAMb,EAAA,gBAAgB,EAAE,gBANL;AAOb,EAAA,iBAAiB,EAAE,iBAPN;AAQb,EAAA,oBAAoB,EAAE,oBART;AASb,EAAA,sBAAsB,EAAE,qBATX;AAUb,EAAA,YAAY,EAAE;AAVD,CAAZ;AAYA,IAAC,OAAO,GAAG;AACZ,EAAA,OAAO,EAAE,SADG;AAEZ,EAAA,QAAQ,EAAE;AAFE,CAAX;AAIA,IAAC,gCAAgC,GAAG,iBAApC;AACH,IAAI,6BAA6B,GAAG,yBAApC;AACA,IAAI,WAAW,GAAG,IAAlB;AACA,IAAI,kBAAkB,GAAG,CAAzB;;AACA,SAAS,4BAAT,GAAwC;AACtC,EAAA,kBAAkB;AACnB;;AACD,SAAS,4BAAT,GAAwC;AACtC,MAAI,kBAAkB,KAAK,CAA3B,EAA8B;AAC5B,UAAM,IAAI,KAAJ,CAAU,sDAAV,CAAN;AACD;;AAED,EAAA,kBAAkB;AACnB;AACD;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,+CAAT,CAAyD,UAAzD,EAAqE;AACnE,MAAI,kBAAkB,GAAG,CAAzB,EAA4B;AAC1B,UAAM,IAAI,KAAJ,CAAU,8DAAV,CAAN;AACD;;AAED,MAAI,OAAO,UAAP,KAAsB,QAA1B,EAAoC;AAClC,UAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACD;;AAKD,EAAA,WAAW,GAAG,UAAd;AACD;;AACD,IAAI,UAAU,GAAG,OAAO,MAAP,KAAkB,WAAnC,C,CAwBA;AACA;;AACA,SAAS,oBAAT,CAA8B,EAA9B,EAAkC;AAChC,MAAI,EAAJ;AACA,MAAI,IAAI,GAAG,EAAE,CAAC,qBAAH,EAAX;AACA,MAAI,KAAK,GAAG,gBAAgB,CAAC,EAAD,CAA5B;AACA,MAAI,EAAE,GAAG,KAAK,CAAC,SAAf;;AAEA,MAAI,EAAJ,EAAQ;AACN,QAAI,EAAJ,EAAQ,EAAR,EAAY,EAAZ,EAAgB,EAAhB;;AAEA,QAAI,EAAE,CAAC,UAAH,CAAc,WAAd,CAAJ,EAAgC;AAC9B,MAAA,EAAE,GAAG,EAAE,CAAC,KAAH,CAAS,CAAT,EAAY,CAAC,CAAb,EAAgB,KAAhB,CAAsB,IAAtB,CAAL;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,CAAD,CAAR;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,CAAD,CAAR;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,EAAD,CAAR;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,EAAD,CAAR;AACD,KAND,MAMO,IAAI,EAAE,CAAC,UAAH,CAAc,SAAd,CAAJ,EAA8B;AACnC,MAAA,EAAE,GAAG,EAAE,CAAC,KAAH,CAAS,CAAT,EAAY,CAAC,CAAb,EAAgB,KAAhB,CAAsB,IAAtB,CAAL;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,CAAD,CAAR;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,CAAD,CAAR;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,CAAD,CAAR;AACA,MAAA,EAAE,GAAG,CAAC,EAAE,CAAC,CAAD,CAAR;AACD,KANM,MAMA;AACL,aAAO,IAAP;AACD;;AAED,QAAI,EAAE,GAAG,KAAK,CAAC,eAAf;AACA,QAAI,CAAC,GAAG,IAAI,CAAC,CAAL,GAAS,EAAT,GAAc,CAAC,IAAI,EAAL,IAAW,UAAU,CAAC,EAAD,CAA3C;AACA,QAAI,CAAC,GAAG,IAAI,CAAC,CAAL,GAAS,EAAT,GAAc,CAAC,IAAI,EAAL,IAAW,UAAU,CAAC,EAAE,CAAC,KAAH,CAAS,EAAE,CAAC,OAAH,CAAW,GAAX,IAAkB,CAA3B,CAAD,CAA3C;AACA,QAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,KAAL,GAAa,EAAhB,GAAqB,EAAE,CAAC,WAAlC;AACA,QAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,MAAL,GAAc,EAAjB,GAAsB,EAAE,CAAC,YAAnC;AACA,WAAO;AACL,MAAA,CAAC,EAAE,CADE;AAEL,MAAA,CAAC,EAAE,CAFE;AAGL,MAAA,KAAK,EAAE,CAHF;AAIL,MAAA,MAAM,EAAE,CAJH;AAKL,MAAA,GAAG,EAAE,CALA;AAML,MAAA,KAAK,EAAE,CAAC,GAAG,CANN;AAOL,MAAA,MAAM,EAAE,CAAC,GAAG,CAPP;AAQL,MAAA,IAAI,EAAE;AARD,KAAP;AAUD,GAlCD,MAkCO;AACL,WAAO,IAAP;AACD;AACF;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAS,2BAAT,CAAqC,EAArC,EAAyC;AACvC,MAAI,IAAI,GAAG,oBAAoB,CAAC,EAAD,CAA/B;AACA,SAAO;AACL,IAAA,GAAG,EAAE,IAAI,CAAC,GAAL,GAAW,MAAM,CAAC,OADlB;AAEL,IAAA,MAAM,EAAE,IAAI,CAAC,MAAL,GAAc,MAAM,CAAC,OAFxB;AAGL,IAAA,IAAI,EAAE,IAAI,CAAC,IAAL,GAAY,MAAM,CAAC,OAHpB;AAIL,IAAA,KAAK,EAAE,IAAI,CAAC,KAAL,GAAa,MAAM,CAAC;AAJtB,GAAP;AAMD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,eAAT,CAAyB,EAAzB,EAA6B;AAC3B,MAAI,IAAI,GAAG,EAAE,CAAC,qBAAH,EAAX;AACA,SAAO;AACL,IAAA,GAAG,EAAE,IAAI,CAAC,GAAL,GAAW,MAAM,CAAC,OADlB;AAEL,IAAA,MAAM,EAAE,IAAI,CAAC,MAAL,GAAc,MAAM,CAAC,OAFxB;AAGL,IAAA,IAAI,EAAE,IAAI,CAAC,IAAL,GAAY,MAAM,CAAC,OAHpB;AAIL,IAAA,KAAK,EAAE,IAAI,CAAC,KAAL,GAAa,MAAM,CAAC;AAJtB,GAAP;AAMD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,UAAT,CAAoB,IAApB,EAA0B;AACxB,SAAO;AACL,IAAA,CAAC,EAAE,CAAC,IAAI,CAAC,IAAL,GAAY,IAAI,CAAC,KAAlB,IAA2B,CADzB;AAEL,IAAA,CAAC,EAAE,CAAC,IAAI,CAAC,GAAL,GAAW,IAAI,CAAC,MAAjB,IAA2B;AAFzB,GAAP;AAID;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,YAAT,CAAsB,MAAtB,EAA8B,MAA9B,EAAsC;AACpC,SAAO,IAAI,CAAC,IAAL,CAAU,IAAI,CAAC,GAAL,CAAS,MAAM,CAAC,CAAP,GAAW,MAAM,CAAC,CAA3B,EAA8B,CAA9B,IAAmC,IAAI,CAAC,GAAL,CAAS,MAAM,CAAC,CAAP,GAAW,MAAM,CAAC,CAA3B,EAA8B,CAA9B,CAA7C,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAS,iBAAT,CAA2B,KAA3B,EAAkC,IAAlC,EAAwC;AACtC,SAAO,KAAK,CAAC,CAAN,IAAW,IAAI,CAAC,MAAhB,IAA0B,KAAK,CAAC,CAAN,IAAW,IAAI,CAAC,GAA1C,IAAiD,KAAK,CAAC,CAAN,IAAW,IAAI,CAAC,IAAjE,IAAyE,KAAK,CAAC,CAAN,IAAW,IAAI,CAAC,KAAhG;AACD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,mBAAT,CAA6B,EAA7B,EAAiC;AAC/B,SAAO,UAAU,CAAC,eAAe,CAAC,EAAD,CAAhB,CAAjB;AACD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,kBAAT,CAA4B,GAA5B,EAAiC,GAAjC,EAAsC;AACpC,MAAI,SAAS,GAAG,mBAAmB,CAAC,GAAD,CAAnC;AACA,MAAI,OAAO,GAAG,2BAA2B,CAAC,GAAD,CAAzC;AACA,SAAO,iBAAiB,CAAC,SAAD,EAAY,OAAZ,CAAxB;AACD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,0BAAT,CAAoC,GAApC,EAAyC,GAAzC,EAA8C;AAC5C,MAAI,SAAS,GAAG,mBAAmB,CAAC,GAAD,CAAnC;AACA,MAAI,SAAS,GAAG,mBAAmB,CAAC,GAAD,CAAnC;AACA,SAAO,YAAY,CAAC,SAAD,EAAY,SAAZ,CAAnB;AACD;AACD;AACA;AACA;AACA;;;AAEA,SAAS,oBAAT,CAA8B,EAA9B,EAAkC;AAChC,MAAI,IAAI,GAAG,eAAe,CAAC,EAAD,CAA1B;AACA,SAAO,IAAI,CAAC,KAAL,GAAa,CAAb,IAAkB,IAAI,CAAC,IAAL,GAAY,QAAQ,CAAC,eAAT,CAAyB,WAAvD,IAAsE,IAAI,CAAC,MAAL,GAAc,CAApF,IAAyF,IAAI,CAAC,GAAL,GAAW,QAAQ,CAAC,eAAT,CAAyB,YAApI;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,+CAAT,CAAyD,KAAzD,EAAgE,EAAhE,EAAoE;AAClE,MAAI,IAAI,GAAG,eAAe,CAAC,EAAD,CAA1B;;AAEA,MAAI,CAAC,iBAAiB,CAAC,KAAD,EAAQ,IAAR,CAAtB,EAAqC;AACnC,WAAO,IAAP;AACD;;AAED,SAAO;AACL,IAAA,GAAG,EAAE,KAAK,CAAC,CAAN,GAAU,IAAI,CAAC,GADf;AAEL,IAAA,MAAM,EAAE,IAAI,CAAC,MAAL,GAAc,KAAK,CAAC,CAFvB;AAGL,IAAA,IAAI,EAAE,KAAK,CAAC,CAAN,GAAU,IAAI,CAAC,IAHhB;AAIT;AACI,IAAA,KAAK,EAAE,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,KAAd,EAAqB,QAAQ,CAAC,eAAT,CAAyB,WAA9C,IAA6D,KAAK,CAAC;AALrE,GAAP;AAOD;;AAED,IAAI,qBAAJ;AACA;AACA;AACA;;AAEA,SAAS,iBAAT,GAA6B;AAI3B,EAAA,qBAAqB,GAAG,IAAI,GAAJ,EAAxB;AACD;;AACD,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,eAAT,CAAyB,EAAzB,EAA6B;AAC3B,MAAI,aAAa,GAAG,KAAK,CAAC,IAAN,CAAW,EAAE,CAAC,QAAd,EAAwB,SAAxB,CAAkC,UAAU,KAAV,EAAiB;AACrE,WAAO,KAAK,CAAC,YAAN,CAAmB,6BAAnB,CAAP;AACD,GAFmB,CAApB;;AAIA,MAAI,aAAa,IAAI,CAArB,EAAwB;AACtB,QAAI,CAAC,qBAAqB,CAAC,GAAtB,CAA0B,EAA1B,CAAL,EAAoC;AAClC,MAAA,qBAAqB,CAAC,GAAtB,CAA0B,EAA1B,EAA8B,IAAI,GAAJ,EAA9B;AACD;;AAED,IAAA,qBAAqB,CAAC,GAAtB,CAA0B,EAA1B,EAA8B,GAA9B,CAAkC,aAAlC,EAAiD,2BAA2B,CAAC,EAAE,CAAC,QAAH,CAAY,aAAZ,CAAD,CAA5E;AACA,WAAO,aAAP;AACD;;AAED,SAAO,SAAP;AACD;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS,gBAAT,CAA0B,eAA1B,EAA2C,iBAA3C,EAA8D;AAC5D,MAAI,CAAC,kBAAkB,CAAC,eAAD,EAAkB,iBAAlB,CAAvB,EAA6D;AAC3D,WAAO,IAAP;AACD;;AAED,MAAI,QAAQ,GAAG,iBAAiB,CAAC,QAAjC,CAL4D,CAKlB;;AAE1C,MAAI,QAAQ,CAAC,MAAT,KAAoB,CAAxB,EAA2B;AACzB,WAAO;AACL,MAAA,KAAK,EAAE,CADF;AAEL,MAAA,gBAAgB,EAAE;AAFb,KAAP;AAID;;AAED,MAAI,aAAa,GAAG,eAAe,CAAC,iBAAD,CAAnC,CAd4D,CAcL;AACzD;;AAEE,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,QAAQ,CAAC,MAA7B,EAAqC,CAAC,EAAtC,EAA0C;AACxC,QAAI,kBAAkB,CAAC,eAAD,EAAkB,QAAQ,CAAC,CAAD,CAA1B,CAAtB,EAAsD;AACpD,UAAI,gBAAgB,GAAG,qBAAqB,CAAC,GAAtB,CAA0B,iBAA1B,KAAgD,qBAAqB,CAAC,GAAtB,CAA0B,iBAA1B,EAA6C,GAA7C,CAAiD,CAAjD,CAAvE;;AAEA,UAAI,gBAAJ,EAAsB;AACpB,YAAI,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,eAAD,CAApB,EAAuC,gBAAvC,CAAtB,EAAgF;AAC9E,iBAAO;AACL,YAAA,KAAK,EAAE,aADF;AAEL,YAAA,gBAAgB,EAAE;AAFb,WAAP;AAID;AACF;;AAED,aAAO;AACL,QAAA,KAAK,EAAE,CADF;AAEL,QAAA,gBAAgB,EAAE;AAFb,OAAP;AAID;AACF,GAnC2D,CAmC3D;AACH;;;AAGE,MAAI,gBAAgB,GAAG,MAAM,CAAC,SAA9B;AACA,MAAI,UAAU,GAAG,SAAjB,CAxC4D,CAwCjC;;AAE3B,OAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,QAAQ,CAAC,MAA/B,EAAuC,EAAE,EAAzC,EAA6C;AAC3C,QAAI,QAAQ,GAAG,0BAA0B,CAAC,eAAD,EAAkB,QAAQ,CAAC,EAAD,CAA1B,CAAzC;;AAEA,QAAI,QAAQ,GAAG,gBAAf,EAAiC;AAC/B,MAAA,gBAAgB,GAAG,QAAnB;AACA,MAAA,UAAU,GAAG,EAAb;AACD;AACF;;AAED,SAAO;AACL,IAAA,KAAK,EAAE,UADF;AAEL,IAAA,gBAAgB,EAAE;AAFb,GAAP;AAID;;AAED,IAAI,cAAc,GAAG,EAArB;;AACA,SAAS,YAAT,GAAwB;AACtB,MAAI,aAAJ;;AAEA,WAAS,cAAT,GAA0B;AACxB,IAAA,aAAa,GAAG;AACd,MAAA,YAAY,EAAE,SADA;AAEd,MAAA,MAAM,EAAE;AAFM,KAAhB;AAID;;AAED,EAAA,cAAc,GAVQ,CAUL;;AAEjB,WAAS,eAAT,CAAyB,WAAzB,EAAsC;AACpC,QAAI,cAAc,GAAG,aAArB;AAAA,QACI,YAAY,GAAG,cAAc,CAAC,YADlC;AAAA,QAEI,MAAM,GAAG,cAAc,CAAC,MAF5B;;AAIA,QAAI,YAAJ,EAAkB;AAChB,MAAA,WAAW,CAAC,QAAZ,CAAqB,YAAY,CAAC,CAAb,GAAiB,MAAtC,EAA8C,YAAY,CAAC,CAAb,GAAiB,MAA/D;AACA,MAAA,MAAM,CAAC,qBAAP,CAA6B,YAAY;AACvC,eAAO,eAAe,CAAC,WAAD,CAAtB;AACD,OAFD;AAGD;AACF;;AAED,WAAS,gBAAT,CAA0B,UAA1B,EAAsC;AACpC,WAAO,cAAc,GAAG,UAAxB;AACD;AACH;AACA;AACA;AACA;AACA;;;AAGE,WAAS,cAAT,CAAwB,OAAxB,EAAiC,eAAjC,EAAkD;AAChD,QAAI,CAAC,eAAL,EAAsB;AACpB,aAAO,KAAP;AACD;;AAED,QAAI,SAAS,GAAG,+CAA+C,CAAC,OAAD,EAAU,eAAV,CAA/D;;AAEA,QAAI,SAAS,KAAK,IAAlB,EAAwB;AACtB,MAAA,cAAc;AACd,aAAO,KAAP;AACD;;AAED,QAAI,kBAAkB,GAAG,CAAC,CAAC,aAAa,CAAC,YAAzC;AACA,QAAI,mBAAmB,GAAG,KAA1B;AAAA,QACI,qBAAqB,GAAG,KAD5B,CAbgD,CAcd;;AAElC,QAAI,eAAe,CAAC,YAAhB,GAA+B,eAAe,CAAC,YAAnD,EAAiE;AAC/D,UAAI,SAAS,CAAC,MAAV,GAAmB,cAAvB,EAAuC;AACrC,QAAA,mBAAmB,GAAG,IAAtB;AACA,QAAA,aAAa,CAAC,YAAd,GAA6B;AAC3B,UAAA,CAAC,EAAE,CADwB;AAE3B,UAAA,CAAC,EAAE;AAFwB,SAA7B;AAIA,QAAA,aAAa,CAAC,MAAd,GAAuB,gBAAgB,CAAC,SAAS,CAAC,MAAX,CAAvC;AACD,OAPD,MAOO,IAAI,SAAS,CAAC,GAAV,GAAgB,cAApB,EAAoC;AACzC,QAAA,mBAAmB,GAAG,IAAtB;AACA,QAAA,aAAa,CAAC,YAAd,GAA6B;AAC3B,UAAA,CAAC,EAAE,CADwB;AAE3B,UAAA,CAAC,EAAE,CAAC;AAFuB,SAA7B;AAIA,QAAA,aAAa,CAAC,MAAd,GAAuB,gBAAgB,CAAC,SAAS,CAAC,GAAX,CAAvC;AACD;;AAED,UAAI,CAAC,kBAAD,IAAuB,mBAA3B,EAAgD;AAC9C,QAAA,eAAe,CAAC,eAAD,CAAf;AACA,eAAO,IAAP;AACD;AACF,KArC+C,CAqC/C;;;AAGD,QAAI,eAAe,CAAC,WAAhB,GAA8B,eAAe,CAAC,WAAlD,EAA+D;AAC7D,UAAI,SAAS,CAAC,KAAV,GAAkB,cAAtB,EAAsC;AACpC,QAAA,qBAAqB,GAAG,IAAxB;AACA,QAAA,aAAa,CAAC,YAAd,GAA6B;AAC3B,UAAA,CAAC,EAAE,CADwB;AAE3B,UAAA,CAAC,EAAE;AAFwB,SAA7B;AAIA,QAAA,aAAa,CAAC,MAAd,GAAuB,gBAAgB,CAAC,SAAS,CAAC,KAAX,CAAvC;AACD,OAPD,MAOO,IAAI,SAAS,CAAC,IAAV,GAAiB,cAArB,EAAqC;AAC1C,QAAA,qBAAqB,GAAG,IAAxB;AACA,QAAA,aAAa,CAAC,YAAd,GAA6B;AAC3B,UAAA,CAAC,EAAE,CAAC,CADuB;AAE3B,UAAA,CAAC,EAAE;AAFwB,SAA7B;AAIA,QAAA,aAAa,CAAC,MAAd,GAAuB,gBAAgB,CAAC,SAAS,CAAC,IAAX,CAAvC;AACD;;AAED,UAAI,CAAC,kBAAD,IAAuB,qBAA3B,EAAkD;AAChD,QAAA,eAAe,CAAC,eAAD,CAAf;AACA,eAAO,IAAP;AACD;AACF;;AAED,IAAA,cAAc;AACd,WAAO,KAAP;AACD;;AAED,SAAO;AACL,IAAA,cAAc,EAAE,cADX;AAEL,IAAA,cAAc,EAAE;AAFX,GAAP;AAID;AAED;AACA;AACA;AACA;;;AACA,SAAS,QAAT,CAAkB,MAAlB,EAA0B;AACxB,SAAO,IAAI,CAAC,SAAL,CAAe,MAAf,EAAuB,IAAvB,EAA6B,CAA7B,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,QAAT,CAAkB,IAAlB,EAAwB;AACtB,MAAI,CAAC,IAAL,EAAW;AACT,UAAM,IAAI,KAAJ,CAAU,kCAAV,CAAN;AACD;;AAED,SAAO,SAAS,CAAC,IAAD,EAAO,CAAP,CAAhB;AACD;;AAED,SAAS,SAAT,CAAmB,IAAnB,EAAyB;AACvB,MAAI,UAAU,GAAG,SAAS,CAAC,MAAV,GAAmB,CAAnB,IAAwB,SAAS,CAAC,CAAD,CAAT,KAAiB,SAAzC,GAAqD,SAAS,CAAC,CAAD,CAA9D,GAAoE,CAArF;;AAEA,MAAI,CAAC,IAAI,CAAC,aAAV,EAAyB;AACvB,WAAO,UAAU,GAAG,CAApB;AACD;;AAED,SAAO,SAAS,CAAC,IAAI,CAAC,aAAN,EAAqB,UAAU,GAAG,CAAlC,CAAhB;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS,sBAAT,CAAgC,IAAhC,EAAsC,IAAtC,EAA4C;AAC1C,MAAI,MAAM,CAAC,IAAP,CAAY,IAAZ,EAAkB,MAAlB,KAA6B,MAAM,CAAC,IAAP,CAAY,IAAZ,EAAkB,MAAnD,EAA2D;AACzD,WAAO,KAAP;AACD;;AAED,OAAK,IAAI,IAAT,IAAiB,IAAjB,EAAuB;AACrB,QAAI,CAAC,GAAG,cAAH,CAAkB,IAAlB,CAAuB,IAAvB,EAA6B,IAA7B,CAAD,IAAuC,IAAI,CAAC,IAAD,CAAJ,KAAe,IAAI,CAAC,IAAD,CAA9D,EAAsE;AACpE,aAAO,KAAP;AACD;AACF;;AAED,SAAO,IAAP;AACD;;AAED,IAAI,WAAW,GAAG,GAAlB;AACA,IAAI,YAAY,GAAG,EAAnB;;AAEA,IAAI,aAAa,GAAG,YAAY,EAAhC;AAAA,IACI,cAAc,GAAG,aAAa,CAAC,cADnC;AAAA,IAEI,cAAc,GAAG,aAAa,CAAC,cAFnC;;AAIA,IAAI,IAAJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,OAAT,CAAiB,SAAjB,EAA4B,SAA5B,EAAuC;AACrC,MAAI,UAAU,GAAG,SAAS,CAAC,MAAV,GAAmB,CAAnB,IAAwB,SAAS,CAAC,CAAD,CAAT,KAAiB,SAAzC,GAAqD,SAAS,CAAC,CAAD,CAA9D,GAAoE,WAArF,CADqC,CAEvC;;AACE,MAAI,iBAAJ;AACA,MAAI,cAAJ;AACA,MAAI,wBAAwB,GAAG,KAA/B;AACA,MAAI,2BAAJ,CANqC,CAML;;AAEhC,MAAI,0BAA0B,GAAG,KAAK,CAAC,IAAN,CAAW,SAAX,EAAsB,IAAtB,CAA2B,UAAU,GAAV,EAAe,GAAf,EAAoB;AAC9E,WAAO,QAAQ,CAAC,GAAD,CAAR,GAAgB,QAAQ,CAAC,GAAD,CAA/B;AACD,GAFgC,CAAjC;AAGF;AACA;AACA;;AAEE,WAAS,MAAT,GAAkB;AAChB,QAAI,sBAAsB,GAAG,mBAAmB,CAAC,SAAD,CAAhD;AACA,QAAI,QAAQ,GAAG,cAAc,CAAC,sBAAD,EAAyB,iBAAzB,CAA7B,CAFgB,CAEyD;;AAEzE,QAAI,CAAC,QAAD,IAAa,2BAAb,IAA4C,IAAI,CAAC,GAAL,CAAS,2BAA2B,CAAC,CAA5B,GAAgC,sBAAsB,CAAC,CAAhE,IAAqE,YAAjH,IAAiI,IAAI,CAAC,GAAL,CAAS,2BAA2B,CAAC,CAA5B,GAAgC,sBAAsB,CAAC,CAAhE,IAAqE,YAA1M,EAAwN;AACtN,MAAA,IAAI,GAAG,MAAM,CAAC,UAAP,CAAkB,MAAlB,EAA0B,UAA1B,CAAP;AACA;AACD;;AAED,QAAI,oBAAoB,CAAC,SAAD,CAAxB,EAAqC;AAInC,MAAA,2BAA2B,CAAC,SAAD,CAA3B;AACA;AACD;;AAED,IAAA,2BAA2B,GAAG,sBAA9B,CAjBgB,CAiBqC;;AAErD,QAAI,oBAAoB,GAAG,KAA3B;;AAEA,QAAI,SAAS,GAAG,0BAA0B,CAAC,0BAAD,CAA1C;AAAA,QACI,KADJ;;AAGA,QAAI;AACF,WAAK,SAAS,CAAC,CAAV,EAAL,EAAoB,CAAC,CAAC,KAAK,GAAG,SAAS,CAAC,CAAV,EAAT,EAAwB,IAA7C,GAAoD;AAClD,YAAI,EAAE,GAAG,KAAK,CAAC,KAAf;AACA,YAAI,QAAQ,GAAG,gBAAgB,CAAC,SAAD,EAAY,EAAZ,CAA/B;;AAEA,YAAI,QAAQ,KAAK,IAAjB,EAAuB;AAC/B;AACU;AACD;;AAED,YAAI,KAAK,GAAG,QAAQ,CAAC,KAArB;AACA,QAAA,oBAAoB,GAAG,IAAvB,CAVkD,CAUtB;;AAE5B,YAAI,EAAE,KAAK,iBAAX,EAA8B;AAC5B,UAAA,iBAAiB,IAAI,6CAA6C,CAAC,iBAAD,EAAoB,SAApB,CAAlE;AACA,UAAA,sCAAsC,CAAC,EAAD,EAAK,QAAL,EAAe,SAAf,CAAtC;AACA,UAAA,iBAAiB,GAAG,EAApB;AACD,SAJD,MAIO,IAAI,KAAK,KAAK,cAAd,EAA8B;AACnC,UAAA,iCAAiC,CAAC,EAAD,EAAK,QAAL,EAAe,SAAf,CAAjC;AACA,UAAA,cAAc,GAAG,KAAjB;AACD,SAnBiD,CAmBjD;;;AAGD;AACD,OAxBC,CAwBD;;AAEF,KA1BD,CA0BE,OAAO,GAAP,EAAY;AACZ,MAAA,SAAS,CAAC,CAAV,CAAY,GAAZ;AACD,KA5BD,SA4BU;AACR,MAAA,SAAS,CAAC,CAAV;AACD;;AAED,QAAI,CAAC,oBAAD,IAAyB,wBAAzB,IAAqD,iBAAzD,EAA4E;AAC1E,MAAA,0CAA0C,CAAC,iBAAD,EAAoB,SAApB,CAA1C;AACA,MAAA,iBAAiB,GAAG,SAApB;AACA,MAAA,cAAc,GAAG,SAAjB;AACA,MAAA,wBAAwB,GAAG,KAA3B;AACD,KALD,MAKO;AACL,MAAA,wBAAwB,GAAG,IAA3B;AACD;;AAED,IAAA,IAAI,GAAG,MAAM,CAAC,UAAP,CAAkB,MAAlB,EAA0B,UAA1B,CAAP;AACD;;AAED,EAAA,MAAM;AACP,C,CAAA;;;AAED,SAAS,SAAT,GAAqB;AAInB,EAAA,YAAY,CAAC,IAAD,CAAZ;AACA,EAAA,cAAc;AACd,EAAA,iBAAiB;AAClB;;AAED,IAAI,aAAa,GAAG,GAApB;AACA,IAAI,aAAJ;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,mBAAT,CAA6B,CAA7B,EAAgC;AAC9B,MAAI,CAAC,GAAG,CAAC,CAAC,OAAF,GAAY,CAAC,CAAC,OAAF,CAAU,CAAV,CAAZ,GAA2B,CAAnC;AACA,EAAA,aAAa,GAAG;AACd,IAAA,CAAC,EAAE,CAAC,CAAC,OADS;AAEd,IAAA,CAAC,EAAE,CAAC,CAAC;AAFS,GAAhB;AAID;;AAED,IAAI,eAAe,GAAG,YAAY,EAAlC;AAAA,IACI,gBAAgB,GAAG,eAAe,CAAC,cADvC;AAAA,IAEI,gBAAgB,GAAG,eAAe,CAAC,cAFvC;;AAIA,IAAI,MAAJ;;AAEA,SAAS,IAAT,GAAgB;AACd,MAAI,aAAJ,EAAmB;AACjB,IAAA,gBAAgB,CAAC,aAAD,EAAgB,QAAQ,CAAC,eAAzB,CAAhB;AACD;;AAED,EAAA,MAAM,GAAG,MAAM,CAAC,UAAP,CAAkB,IAAlB,EAAwB,aAAxB,CAAT;AACD;AACD;AACA;AACA;;;AAGA,SAAS,iBAAT,GAA6B;AAI3B,EAAA,MAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,mBAArC;AACA,EAAA,MAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,mBAArC;AACA,EAAA,IAAI;AACL;AACD;AACA;AACA;;;AAEA,SAAS,oBAAT,GAAgC;AAI9B,EAAA,MAAM,CAAC,mBAAP,CAA2B,WAA3B,EAAwC,mBAAxC;AACA,EAAA,MAAM,CAAC,mBAAP,CAA2B,WAA3B,EAAwC,mBAAxC;AACA,EAAA,aAAa,GAAG,SAAhB;AACA,EAAA,MAAM,CAAC,YAAP,CAAoB,MAApB;AACA,EAAA,gBAAgB;AACjB;;AAED,IAAI,2BAA2B,GAAG,GAAlC;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,GAAT,CAAa,QAAb,EAAuB;AACrB,SAAO,GAAG,MAAH,CAAU,QAAV,EAAoB,GAApB,EAAyB,MAAzB,CAAgC,2BAAhC,EAA6D,QAA7D,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAS,wBAAT,CAAkC,eAAlC,EAAmD;AACjD,MAAI,IAAI,GAAG,eAAe,CAAC,qBAAhB,EAAX;AACA,MAAI,SAAS,GAAG,eAAe,CAAC,SAAhB,CAA0B,IAA1B,CAAhB;AACA,EAAA,gBAAgB,CAAC,eAAD,EAAkB,SAAlB,CAAhB;AACA,EAAA,SAAS,CAAC,EAAV,GAAe,uBAAf;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,QAAhB,GAA2B,OAA3B;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,GAAhB,GAAsB,GAAG,MAAH,CAAU,IAAI,CAAC,GAAf,EAAoB,IAApB,CAAtB;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,IAAhB,GAAuB,GAAG,MAAH,CAAU,IAAI,CAAC,IAAf,EAAqB,IAArB,CAAvB;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,GAAzB,CARiD,CAQpB;;AAE7B,EAAA,SAAS,CAAC,KAAV,CAAgB,SAAhB,GAA4B,YAA5B;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,GAAG,MAAH,CAAU,IAAI,CAAC,MAAf,EAAuB,IAAvB,CAAzB;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,KAAhB,GAAwB,GAAG,MAAH,CAAU,IAAI,CAAC,KAAf,EAAsB,IAAtB,CAAxB;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,UAAhB,GAA6B,GAAG,MAAH,CAAU,GAAG,CAAC,OAAD,CAAb,EAAwB,IAAxB,EAA8B,MAA9B,CAAqC,GAAG,CAAC,QAAD,CAAxC,EAAoD,IAApD,EAA0D,MAA1D,CAAiE,GAAG,CAAC,kBAAD,CAApE,EAA0F,IAA1F,EAAgG,MAAhG,CAAuG,GAAG,CAAC,SAAD,CAA1G,EAAuH,IAAvH,EAA6H,MAA7H,CAAoI,GAAG,CAAC,OAAD,CAAvI,EAAkJ,GAAlJ,CAA7B,CAbiD,CAamI;;AAEpL,EAAA,MAAM,CAAC,UAAP,CAAkB,YAAY;AAC5B,WAAO,SAAS,CAAC,KAAV,CAAgB,UAAhB,IAA8B,KAAK,MAAL,CAAY,GAAG,CAAC,KAAD,CAAf,EAAwB,IAAxB,EAA8B,MAA9B,CAAqC,GAAG,CAAC,MAAD,CAAxC,CAArC;AACD,GAFD,EAEG,CAFH;AAGA,EAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,MAAzB;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,UAAzB;AACA,SAAO,SAAP;AACD;AACD;AACA;AACA;AACA;;;AAEA,SAAS,mCAAT,CAA6C,SAA7C,EAAwD;AACtD,EAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,MAAzB;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,2BAAT,CAAqC,SAArC,EAAgD,UAAhD,EAA4D,aAA5D,EAA2E,aAA3E,EAA0F,uBAA1F,EAAmH;AACjH,MAAI,OAAO,GAAG,UAAU,CAAC,qBAAX,EAAd;AACA,MAAI,aAAa,GAAG,SAAS,CAAC,qBAAV,EAApB;AACA,MAAI,WAAW,GAAG,OAAO,CAAC,KAAR,GAAgB,aAAa,CAAC,KAAhD;AACA,MAAI,YAAY,GAAG,OAAO,CAAC,MAAR,GAAiB,aAAa,CAAC,MAAlD;;AAEA,MAAI,WAAW,IAAI,YAAnB,EAAiC;AAC/B,QAAI,8CAA8C,GAAG;AACnD,MAAA,IAAI,EAAE,CAAC,aAAa,GAAG,aAAa,CAAC,IAA/B,IAAuC,aAAa,CAAC,KADR;AAEnD,MAAA,GAAG,EAAE,CAAC,aAAa,GAAG,aAAa,CAAC,GAA/B,IAAsC,aAAa,CAAC;AAFN,KAArD;AAIA,IAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,GAAG,MAAH,CAAU,OAAO,CAAC,MAAlB,EAA0B,IAA1B,CAAzB;AACA,IAAA,SAAS,CAAC,KAAV,CAAgB,KAAhB,GAAwB,GAAG,MAAH,CAAU,OAAO,CAAC,KAAlB,EAAyB,IAAzB,CAAxB;AACA,IAAA,SAAS,CAAC,KAAV,CAAgB,IAAhB,GAAuB,GAAG,MAAH,CAAU,UAAU,CAAC,SAAS,CAAC,KAAV,CAAgB,IAAjB,CAAV,GAAmC,8CAA8C,CAAC,IAA/C,GAAsD,WAAnG,EAAgH,IAAhH,CAAvB;AACA,IAAA,SAAS,CAAC,KAAV,CAAgB,GAAhB,GAAsB,GAAG,MAAH,CAAU,UAAU,CAAC,SAAS,CAAC,KAAV,CAAgB,GAAjB,CAAV,GAAkC,8CAA8C,CAAC,GAA/C,GAAqD,YAAjG,EAA+G,IAA/G,CAAtB;AACD,GAfgH,CAehH;;;AAGD,EAAA,gBAAgB,CAAC,UAAD,EAAa,SAAb,CAAhB;AACA,EAAA,uBAAuB;AACxB;AACD;AACA;AACA;AACA;;;AAEA,SAAS,gBAAT,CAA0B,UAA1B,EAAsC,QAAtC,EAAgD;AAC9C,MAAI,aAAa,GAAG,MAAM,CAAC,gBAAP,CAAwB,UAAxB,CAApB;AACA,EAAA,KAAK,CAAC,IAAN,CAAW,aAAX,EAA0B,MAA1B,CAAiC,UAAU,CAAV,EAAa;AAC5C,WAAO,CAAC,CAAC,UAAF,CAAa,YAAb,KAA8B,CAAC,CAAC,UAAF,CAAa,SAAb,CAA9B,IAAyD,CAAC,CAAC,UAAF,CAAa,MAAb,CAAzD,IAAiF,CAAC,CAAC,UAAF,CAAa,MAAb,CAAjF,IAAyG,CAAC,CAAC,UAAF,CAAa,OAAb,CAAzG,IAAkI,CAAC,CAAC,UAAF,CAAa,SAAb,CAAlI,IAA6J,CAAC,CAAC,UAAF,CAAa,SAAb,CAA7J,IAAwL,CAAC,CAAC,UAAF,CAAa,MAAb,CAAxL,IAAgN,CAAC,CAAC,UAAF,CAAa,QAAb,CAAhN,IAA0O,CAAC,KAAK,SAAhP,IAA6P,CAAC,KAAK,OAAnQ,IAA8Q,CAAC,KAAK,iBAA3R;AACD,GAFD,EAEG,OAFH,CAEW,UAAU,CAAV,EAAa;AACtB,WAAO,QAAQ,CAAC,KAAT,CAAe,WAAf,CAA2B,CAA3B,EAA8B,aAAa,CAAC,gBAAd,CAA+B,CAA/B,CAA9B,EAAiE,aAAa,CAAC,mBAAd,CAAkC,CAAlC,CAAjE,CAAP;AACD,GAJD;AAKD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAS,cAAT,CAAwB,WAAxB,EAAqC,YAArC,EAAmD;AACjD,EAAA,WAAW,CAAC,SAAZ,GAAwB,KAAxB;;AAEA,EAAA,WAAW,CAAC,WAAZ,GAA0B,YAAY;AACpC,WAAO,KAAP;AACD,GAFD;;AAIA,MAAI,CAAC,YAAL,EAAmB;AACjB,IAAA,WAAW,CAAC,KAAZ,CAAkB,UAAlB,GAA+B,MAA/B;AACA,IAAA,WAAW,CAAC,KAAZ,CAAkB,gBAAlB,GAAqC,MAArC;AACA,IAAA,WAAW,CAAC,KAAZ,CAAkB,MAAlB,GAA2B,MAA3B;AACD,GAJD,MAIO;AACL,IAAA,WAAW,CAAC,KAAZ,CAAkB,UAAlB,GAA+B,EAA/B;AACA,IAAA,WAAW,CAAC,KAAZ,CAAkB,gBAAlB,GAAqC,EAArC;AACA,IAAA,WAAW,CAAC,KAAZ,CAAkB,MAAlB,GAA2B,EAA3B;AACD;AACF;AACD;AACA;AACA;AACA;;;AAEA,SAAS,sBAAT,CAAgC,UAAhC,EAA4C;AAC1C,EAAA,UAAU,CAAC,KAAX,CAAiB,OAAjB,GAA2B,MAA3B;AACA,EAAA,UAAU,CAAC,KAAX,CAAiB,QAAjB,GAA4B,OAA5B;AACA,EAAA,UAAU,CAAC,KAAX,CAAiB,MAAjB,GAA0B,IAA1B;AACD;AACD;AACA;AACA;AACA;;;AAEA,SAAS,gBAAT,CAA0B,QAA1B,EAAoC;AAClC,EAAA,QAAQ,CAAC,KAAT,CAAe,UAAf,GAA4B,QAA5B;AACA,EAAA,QAAQ,CAAC,YAAT,CAAsB,6BAAtB,EAAqD,MAArD;AACD;AACD;AACA;AACA;AACA;;;AAEA,SAAS,uBAAT,CAAiC,QAAjC,EAA2C;AACzC,EAAA,QAAQ,CAAC,KAAT,CAAe,UAAf,GAA4B,EAA5B;AACA,EAAA,QAAQ,CAAC,eAAT,CAAyB,6BAAzB;AACD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,oBAAT,CAA8B,SAA9B,EAAyC;AACvC,MAAI,SAAS,GAAG,SAAS,CAAC,MAAV,GAAmB,CAAnB,IAAwB,SAAS,CAAC,CAAD,CAAT,KAAiB,SAAzC,GAAqD,SAAS,CAAC,CAAD,CAA9D,GAAoE,YAAY,CAAE,CAAlG;AACA,EAAA,SAAS,CAAC,OAAV,CAAkB,UAAU,EAAV,EAAc;AAC9B,QAAI,MAAM,GAAG,SAAS,CAAC,EAAD,CAAtB;AACA,IAAA,MAAM,CAAC,IAAP,CAAY,MAAZ,EAAoB,OAApB,CAA4B,UAAU,KAAV,EAAiB;AAC3C,MAAA,EAAE,CAAC,KAAH,CAAS,KAAT,IAAkB,MAAM,CAAC,KAAD,CAAxB;AACD,KAFD;AAGD,GALD;AAMD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,sBAAT,CAAgC,SAAhC,EAA2C;AACzC,MAAI,SAAS,GAAG,SAAS,CAAC,MAAV,GAAmB,CAAnB,IAAwB,SAAS,CAAC,CAAD,CAAT,KAAiB,SAAzC,GAAqD,SAAS,CAAC,CAAD,CAA9D,GAAoE,YAAY,CAAE,CAAlG;AACA,EAAA,SAAS,CAAC,OAAV,CAAkB,UAAU,EAAV,EAAc;AAC9B,QAAI,MAAM,GAAG,SAAS,CAAC,EAAD,CAAtB;AACA,IAAA,MAAM,CAAC,IAAP,CAAY,MAAZ,EAAoB,OAApB,CAA4B,UAAU,KAAV,EAAiB;AAC3C,MAAA,EAAE,CAAC,KAAH,CAAS,KAAT,IAAkB,EAAlB;AACD,KAFD;AAGD,GALD;AAMD;AACD;AACA;AACA;AACA;AACA;;;AAEA,SAAS,gBAAT,CAA0B,EAA1B,EAA8B;AAC5B,MAAI,iBAAiB,GAAG,EAAE,CAAC,KAAH,CAAS,SAAjC;AACA,EAAA,EAAE,CAAC,KAAH,CAAS,SAAT,GAAqB,MAAM,CAAC,gBAAP,CAAwB,EAAxB,EAA4B,gBAA5B,CAA6C,QAA7C,CAArB;AACA,MAAI,gBAAgB,GAAG,EAAE,CAAC,KAAH,CAAS,QAAhC;AACA,EAAA,EAAE,CAAC,KAAH,CAAS,QAAT,GAAoB,MAAM,CAAC,gBAAP,CAAwB,EAAxB,EAA4B,gBAA5B,CAA6C,OAA7C,CAApB;AACA,SAAO,SAAS,IAAT,GAAgB;AACrB,IAAA,EAAE,CAAC,KAAH,CAAS,SAAT,GAAqB,iBAArB;AACA,IAAA,EAAE,CAAC,KAAH,CAAS,QAAT,GAAoB,gBAApB;AACD,GAHD;AAID;;AAED,IAAI,sBAAsB,GAAG,SAA7B;AACA,IAAI,2BAA2B,GAAG,GAAlC;AACA,IAAI,iCAAiC,GAAG,CAAxC;AACA,IAAI,yBAAyB,GAAG;AAC9B,EAAA,OAAO,EAAE;AADqB,CAAhC;AAGA,IAAI,kBAAJ;AACA,IAAI,SAAJ;AACA,IAAI,aAAJ;AACA,IAAI,aAAJ;AACA,IAAI,cAAJ;AACA,IAAI,WAAJ;AACA,IAAI,YAAJ;AACA,IAAI,gBAAJ;AACA,IAAI,sBAAJ;AACA,IAAI,oBAAJ;AACA,IAAI,uBAAuB,GAAG,KAA9B;AACA,IAAI,sBAAsB,GAAG,KAA7B;AACA,IAAI,2BAAJ;AACA,IAAI,uBAAuB,GAAG,KAA9B,C,CAAoC;;AAEpC,IAAI,eAAe,GAAG,IAAI,GAAJ,EAAtB,C,CAAgC;;AAEhC,IAAI,UAAU,GAAG,IAAI,GAAJ,EAAjB,C,CAA2B;;AAE3B,IAAI,qBAAqB,GAAG,IAAI,OAAJ,EAA5B;AACA;;AAEA,SAAS,gBAAT,CAA0B,UAA1B,EAAsC,IAAtC,EAA4C;AAK1C,MAAI,CAAC,eAAe,CAAC,GAAhB,CAAoB,IAApB,CAAL,EAAgC;AAC9B,IAAA,eAAe,CAAC,GAAhB,CAAoB,IAApB,EAA0B,IAAI,GAAJ,EAA1B;AACD;;AAED,MAAI,CAAC,eAAe,CAAC,GAAhB,CAAoB,IAApB,EAA0B,GAA1B,CAA8B,UAA9B,CAAL,EAAgD;AAC9C,IAAA,eAAe,CAAC,GAAhB,CAAoB,IAApB,EAA0B,GAA1B,CAA8B,UAA9B;AACA,IAAA,4BAA4B;AAC7B;AACF;;AAED,SAAS,kBAAT,CAA4B,UAA5B,EAAwC,IAAxC,EAA8C;AAC5C,EAAA,eAAe,CAAC,GAAhB,CAAoB,IAApB,EAA0B,QAA1B,EAAoC,UAApC;AACA,EAAA,4BAA4B;;AAE5B,MAAI,eAAe,CAAC,GAAhB,CAAoB,IAApB,EAA0B,IAA1B,KAAmC,CAAvC,EAA0C;AACxC,IAAA,eAAe,CAAC,QAAD,CAAf,CAA0B,IAA1B;AACD;AACF;AACD;;;AAGA,SAAS,mBAAT,GAA+B;AAI7B,EAAA,iBAAiB;AACjB,MAAI,SAAS,GAAG,eAAe,CAAC,GAAhB,CAAoB,aAApB,CAAhB;;AAEA,MAAI,SAAS,GAAG,0BAA0B,CAAC,SAAD,CAA1C;AAAA,MACI,KADJ;;AAGA,MAAI;AACF,SAAK,SAAS,CAAC,CAAV,EAAL,EAAoB,CAAC,CAAC,KAAK,GAAG,SAAS,CAAC,CAAV,EAAT,EAAwB,IAA7C,GAAoD;AAClD,UAAI,EAAE,GAAG,KAAK,CAAC,KAAf;AACA,MAAA,EAAE,CAAC,gBAAH,CAAoB,0BAApB,EAAgD,oBAAhD;AACA,MAAA,EAAE,CAAC,gBAAH,CAAoB,uBAApB,EAA6C,iBAA7C;AACA,MAAA,EAAE,CAAC,gBAAH,CAAoB,6BAApB,EAAmD,wBAAnD;AACD;AACF,GAPD,CAOE,OAAO,GAAP,EAAY;AACZ,IAAA,SAAS,CAAC,CAAV,CAAY,GAAZ;AACD,GATD,SASU;AACR,IAAA,SAAS,CAAC,CAAV;AACD;;AAED,EAAA,MAAM,CAAC,gBAAP,CAAwB,gCAAxB,EAA0D,UAA1D,EAvB6B,CAuByC;;AAEtE,MAAI,qBAAqB,GAAG,IAAI,CAAC,GAAL,CAAS,KAAT,CAAe,IAAf,EAAqB,CAAC,2BAAD,EAA8B,MAA9B,CAAqC,kBAAkB,CAAC,KAAK,CAAC,IAAN,CAAW,SAAS,CAAC,IAAV,EAAX,EAA6B,GAA7B,CAAiC,UAAU,EAAV,EAAc;AACtJ,WAAO,UAAU,CAAC,GAAX,CAAe,EAAf,EAAmB,uBAA1B;AACD,GAFwG,CAAD,CAAvD,CAArB,CAA5B;AAGA,EAAA,OAAO,CAAC,SAAD,EAAY,SAAZ,EAAuB,qBAAqB,GAAG,IAA/C,CAAP;AACD;;AAED,SAAS,qBAAT,GAAiC;AAI/B,EAAA,oBAAoB;AACpB,MAAI,SAAS,GAAG,eAAe,CAAC,GAAhB,CAAoB,aAApB,CAAhB;;AAEA,MAAI,UAAU,GAAG,0BAA0B,CAAC,SAAD,CAA3C;AAAA,MACI,MADJ;;AAGA,MAAI;AACF,SAAK,UAAU,CAAC,CAAX,EAAL,EAAqB,CAAC,CAAC,MAAM,GAAG,UAAU,CAAC,CAAX,EAAV,EAA0B,IAAhD,GAAuD;AACrD,UAAI,EAAE,GAAG,MAAM,CAAC,KAAhB;AACA,MAAA,EAAE,CAAC,mBAAH,CAAuB,0BAAvB,EAAmD,oBAAnD;AACA,MAAA,EAAE,CAAC,mBAAH,CAAuB,uBAAvB,EAAgD,iBAAhD;AACA,MAAA,EAAE,CAAC,mBAAH,CAAuB,6BAAvB,EAAsD,wBAAtD;AACD;AACF,GAPD,CAOE,OAAO,GAAP,EAAY;AACZ,IAAA,UAAU,CAAC,CAAX,CAAa,GAAb;AACD,GATD,SASU;AACR,IAAA,UAAU,CAAC,CAAX;AACD;;AAED,EAAA,MAAM,CAAC,mBAAP,CAA2B,gCAA3B,EAA6D,UAA7D;AACA,EAAA,SAAS;AACV;AACD;;;AAGA,SAAS,oBAAT,CAA8B,CAA9B,EAAiC;AAI/B,EAAA,uBAAuB,GAAG,KAA1B;;AAEA,MAAI,eAAe,GAAG,UAAU,CAAC,GAAX,CAAe,CAAC,CAAC,aAAjB,CAAtB;AAAA,MACI,KAAK,GAAG,eAAe,CAAC,KAD5B;AAAA,MAEI,sBAAsB,GAAG,eAAe,CAAC,sBAF7C;;AAIA,MAAI,sBAAsB,IAAI,CAAC,CAAC,aAAF,KAAoB,cAAlD,EAAkE;AAIhE;AACD,GAf8B,CAe9B;;;AAGD,EAAA,KAAK,GAAG,KAAK,CAAC,MAAN,CAAa,UAAU,CAAV,EAAa;AAChC,WAAO,CAAC,CAAC,WAAD,CAAD,KAAmB,YAAY,CAAC,WAAD,CAAtC;AACD,GAFO,CAAR;;AAOA,MAAI,cAAc,KAAK,CAAC,CAAC,aAAzB,EAAwC;AACtC,QAAI,eAAe,GAAG,UAAU,CAAC,GAAX,CAAe,cAAf,EAA+B,KAArD;AACA,QAAI,kBAAkB,GAAG,eAAe,CAAC,MAAhB,CAAuB,UAAU,IAAV,EAAgB;AAC9D,aAAO,CAAC,IAAI,CAAC,gCAAD,CAAZ;AACD,KAFwB,CAAzB;AAGA,IAAA,qBAAqB,CAAC,cAAD,EAAiB,kBAAjB,EAAqC;AACxD,MAAA,OAAO,EAAE,QAAQ,CAAC,uBADsC;AAExD,MAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAFuC;AAGxD,MAAA,MAAM,EAAE,OAAO,CAAC;AAHwC,KAArC,CAArB;AAKD;;AAED,MAAI,kBAAkB,GAAG,CAAC,CAAC,MAAF,CAAS,QAAlC;AAAA,MACI,KAAK,GAAG,kBAAkB,CAAC,KAD/B;AAAA,MAEI,gBAAgB,GAAG,kBAAkB,CAAC,gBAF1C;AAGA,MAAI,WAAW,GAAG,gBAAgB,IAAI,KAAK,KAAK,CAAC,CAAC,aAAF,CAAgB,QAAhB,CAAyB,MAAzB,GAAkC,CAAhE,GAAoE,KAAK,GAAG,CAA5E,GAAgF,KAAlG;AACA,EAAA,gBAAgB,GAAG,CAAC,CAAC,aAArB;AACA,EAAA,KAAK,CAAC,MAAN,CAAa,WAAb,EAA0B,CAA1B,EAA6B,YAA7B;AACA,EAAA,qBAAqB,CAAC,CAAC,CAAC,aAAH,EAAkB,KAAlB,EAAyB;AAC5C,IAAA,OAAO,EAAE,QAAQ,CAAC,eAD0B;AAE5C,IAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAF2B;AAG5C,IAAA,MAAM,EAAE,OAAO,CAAC;AAH4B,GAAzB,CAArB;AAKD;;AAED,SAAS,iBAAT,CAA2B,CAA3B,EAA8B;AAK5B,MAAI,gBAAgB,GAAG,UAAU,CAAC,GAAX,CAAe,CAAC,CAAC,aAAjB,CAAvB;AAAA,MACI,KAAK,GAAG,gBAAgB,CAAC,KAD7B;AAAA,MAEI,sBAAsB,GAAG,gBAAgB,CAAC,sBAF9C;;AAIA,MAAI,sBAAsB,IAAI,CAAC,CAAC,aAAF,KAAoB,cAAlD,EAAkE;AAIhE;AACD;;AAED,MAAI,WAAW,GAAG,KAAK,CAAC,SAAN,CAAgB,UAAU,IAAV,EAAgB;AAChD,WAAO,CAAC,CAAC,IAAI,CAAC,gCAAD,CAAb;AACD,GAFiB,CAAlB;AAGA,MAAI,UAAU,GAAG,KAAK,CAAC,MAAN,CAAa,WAAb,EAA0B,CAA1B,EAA6B,CAA7B,CAAjB;AACA,EAAA,gBAAgB,GAAG,SAAnB;;AAEA,MAAI,CAAC,CAAC,MAAF,CAAS,IAAT,KAAkB,kBAAkB,CAAC,cAAzC,EAAyD;AACvD,IAAA,uBAAuB,GAAG,IAA1B;AACA,IAAA,gBAAgB,GAAG,cAAnB;AACA,QAAI,eAAe,GAAG,UAAU,CAAC,GAAX,CAAe,cAAf,EAA+B,KAArD;AACA,IAAA,eAAe,CAAC,MAAhB,CAAuB,WAAvB,EAAoC,CAApC,EAAuC,UAAvC;AACA,IAAA,qBAAqB,CAAC,cAAD,EAAiB,eAAjB,EAAkC;AACrD,MAAA,OAAO,EAAE,QAAQ,CAAC,gBADmC;AAErD,MAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAFoC;AAGrD,MAAA,MAAM,EAAE,OAAO,CAAC;AAHqC,KAAlC,CAArB;AAKD;;AAED,EAAA,qBAAqB,CAAC,CAAC,CAAC,aAAH,EAAkB,KAAlB,EAAyB;AAC5C,IAAA,OAAO,EAAE,QAAQ,CAAC,YAD0B;AAE5C,IAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAF2B;AAG5C,IAAA,MAAM,EAAE,OAAO,CAAC;AAH4B,GAAzB,CAArB;AAKD;;AAED,SAAS,wBAAT,CAAkC,CAAlC,EAAqC;AAInC,EAAA,uBAAuB,GAAG,KAA1B;;AAEA,MAAI,gBAAgB,GAAG,UAAU,CAAC,GAAX,CAAe,CAAC,CAAC,aAAjB,CAAvB;AAAA,MACI,KAAK,GAAG,gBAAgB,CAAC,KAD7B;AAAA,MAEI,sBAAsB,GAAG,gBAAgB,CAAC,sBAF9C;;AAIA,MAAI,sBAAsB,IAAI,CAAC,CAAC,aAAF,KAAoB,cAAlD,EAAkE;AAIhE;AACD;;AAED,MAAI,KAAK,GAAG,CAAC,CAAC,MAAF,CAAS,QAAT,CAAkB,KAA9B;AACA,MAAI,WAAW,GAAG,KAAK,CAAC,SAAN,CAAgB,UAAU,IAAV,EAAgB;AAChD,WAAO,CAAC,CAAC,IAAI,CAAC,gCAAD,CAAb;AACD,GAFiB,CAAlB;AAGA,EAAA,KAAK,CAAC,MAAN,CAAa,WAAb,EAA0B,CAA1B;AACA,EAAA,KAAK,CAAC,MAAN,CAAa,KAAb,EAAoB,CAApB,EAAuB,YAAvB;AACA,EAAA,qBAAqB,CAAC,CAAC,CAAC,aAAH,EAAkB,KAAlB,EAAyB;AAC5C,IAAA,OAAO,EAAE,QAAQ,CAAC,kBAD0B;AAE5C,IAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAF2B;AAG5C,IAAA,MAAM,EAAE,OAAO,CAAC;AAH4B,GAAzB,CAArB;AAKD,C,CAAA;;;AAGD,SAAS,eAAT,CAAyB,CAAzB,EAA4B;AAC1B,EAAA,CAAC,CAAC,cAAF;AACA,MAAI,CAAC,GAAG,CAAC,CAAC,OAAF,GAAY,CAAC,CAAC,OAAF,CAAU,CAAV,CAAZ,GAA2B,CAAnC;AACA,EAAA,oBAAoB,GAAG;AACrB,IAAA,CAAC,EAAE,CAAC,CAAC,OADgB;AAErB,IAAA,CAAC,EAAE,CAAC,CAAC;AAFgB,GAAvB;AAIA,EAAA,SAAS,CAAC,KAAV,CAAgB,SAAhB,GAA4B,eAAe,MAAf,CAAsB,oBAAoB,CAAC,CAArB,GAAyB,sBAAsB,CAAC,CAAtE,EAAyE,MAAzE,EAAiF,MAAjF,CAAwF,oBAAoB,CAAC,CAArB,GAAyB,sBAAsB,CAAC,CAAxI,EAA2I,QAA3I,CAA5B;AACD;;AAED,SAAS,UAAT,GAAsB;AAIpB,EAAA,sBAAsB,GAAG,IAAzB,CAJoB,CAIU;;AAE9B,EAAA,MAAM,CAAC,mBAAP,CAA2B,WAA3B,EAAwC,eAAxC;AACA,EAAA,MAAM,CAAC,mBAAP,CAA2B,WAA3B,EAAwC,eAAxC;AACA,EAAA,MAAM,CAAC,mBAAP,CAA2B,SAA3B,EAAsC,UAAtC;AACA,EAAA,MAAM,CAAC,mBAAP,CAA2B,UAA3B,EAAuC,UAAvC;AACA,EAAA,qBAAqB;AACrB,EAAA,mCAAmC,CAAC,SAAD,CAAnC,CAXoB,CAW2B;;AAM/C,MAAI,gBAAgB,GAAG,UAAU,CAAC,GAAX,CAAe,gBAAf,CAAvB;AAAA,MACI,KAAK,GAAG,gBAAgB,CAAC,KAD7B;AAAA,MAEI,IAAI,GAAG,gBAAgB,CAAC,IAF5B;;AAIA,EAAA,sBAAsB,CAAC,eAAe,CAAC,GAAhB,CAAoB,IAApB,CAAD,EAA4B,UAAU,EAAV,EAAc;AAC9D,WAAO,UAAU,CAAC,GAAX,CAAe,EAAf,EAAmB,eAA1B;AACD,GAFqB,CAAtB;AAGA,MAAI,WAAW,GAAG,KAAK,CAAC,SAAN,CAAgB,UAAU,IAAV,EAAgB;AAChD,WAAO,CAAC,CAAC,IAAI,CAAC,gCAAD,CAAb;AACD,GAFiB,CAAlB,CAxBoB,CA0BjB;;AAEH,MAAI,WAAW,KAAK,CAAC,CAArB,EAAwB,WAAW,GAAG,WAAd;AACxB,EAAA,KAAK,GAAG,KAAK,CAAC,GAAN,CAAU,UAAU,IAAV,EAAgB;AAChC,WAAO,IAAI,CAAC,gCAAD,CAAJ,GAAyC,aAAzC,GAAyD,IAAhE;AACD,GAFO,CAAR;;AAIA,WAAS,kBAAT,GAA8B;AAC5B,IAAA,2BAA2B;AAC3B,IAAA,qBAAqB,CAAC,gBAAD,EAAmB,KAAnB,EAA0B;AAC7C,MAAA,OAAO,EAAE,uBAAuB,GAAG,QAAQ,CAAC,sBAAZ,GAAqC,QAAQ,CAAC,iBADjC;AAE7C,MAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAF4B;AAG7C,MAAA,MAAM,EAAE,OAAO,CAAC;AAH6B,KAA1B,CAArB;;AAMA,QAAI,gBAAgB,KAAK,cAAzB,EAAyC;AAC7C;AACM,MAAA,qBAAqB,CAAC,cAAD,EAAiB,UAAU,CAAC,GAAX,CAAe,cAAf,EAA+B,KAAhD,EAAuD;AAC1E,QAAA,OAAO,EAAE,QAAQ,CAAC,oBADwD;AAE1E,QAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAFyD;AAG1E,QAAA,MAAM,EAAE,OAAO,CAAC;AAH0D,OAAvD,CAArB;AAKD;;AAED,IAAA,uBAAuB,CAAC,gBAAgB,CAAC,QAAjB,CAA0B,WAA1B,CAAD,CAAvB;AACA,IAAA,eAAe;AAChB;;AAED,EAAA,6BAA6B,CAAC,WAAD,EAAc,kBAAd,CAA7B;AACD,C,CAAA;;;AAGD,SAAS,6BAAT,CAAuC,WAAvC,EAAoD,QAApD,EAA8D;AAC5D,MAAI,YAAY,GAAG,gBAAgB,CAAC,QAAjB,CAA0B,WAA1B,EAAuC,qBAAvC,EAAnB;AACA,MAAI,YAAY,GAAG;AACjB,IAAA,CAAC,EAAE,YAAY,CAAC,IAAb,GAAoB,UAAU,CAAC,SAAS,CAAC,KAAV,CAAgB,IAAjB,CADhB;AAEjB,IAAA,CAAC,EAAE,YAAY,CAAC,GAAb,GAAmB,UAAU,CAAC,SAAS,CAAC,KAAV,CAAgB,GAAjB;AAFf,GAAnB;;AAKA,MAAI,gBAAgB,GAAG,UAAU,CAAC,GAAX,CAAe,gBAAf,CAAvB;AAAA,MACI,uBAAuB,GAAG,gBAAgB,CAAC,uBAD/C;;AAGA,MAAI,UAAU,GAAG,aAAa,MAAb,CAAoB,uBAApB,EAA6C,SAA7C,CAAjB;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,UAAhB,GAA6B,SAAS,CAAC,KAAV,CAAgB,UAAhB,GAA6B,SAAS,CAAC,KAAV,CAAgB,UAAhB,GAA6B,GAA7B,GAAmC,UAAhE,GAA6E,UAA1G;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,SAAhB,GAA4B,eAAe,MAAf,CAAsB,YAAY,CAAC,CAAnC,EAAsC,MAAtC,EAA8C,MAA9C,CAAqD,YAAY,CAAC,CAAlE,EAAqE,QAArE,CAA5B;AACA,EAAA,MAAM,CAAC,UAAP,CAAkB,QAAlB,EAA4B,uBAA5B;AACD;AACD;;;AAGA,SAAS,eAAT,GAA2B;AACzB,EAAA,SAAS,CAAC,MAAV;AACA,EAAA,kBAAkB,CAAC,MAAnB;AACA,EAAA,SAAS,GAAG,SAAZ;AACA,EAAA,kBAAkB,GAAG,SAArB;AACA,EAAA,aAAa,GAAG,SAAhB;AACA,EAAA,aAAa,GAAG,SAAhB;AACA,EAAA,cAAc,GAAG,SAAjB;AACA,EAAA,WAAW,GAAG,SAAd;AACA,EAAA,YAAY,GAAG,SAAf;AACA,EAAA,gBAAgB,GAAG,SAAnB;AACA,EAAA,sBAAsB,GAAG,SAAzB;AACA,EAAA,oBAAoB,GAAG,SAAvB;AACA,EAAA,uBAAuB,GAAG,KAA1B;AACA,EAAA,sBAAsB,GAAG,KAAzB;AACA,EAAA,2BAA2B,GAAG,SAA9B;AACA,EAAA,uBAAuB,GAAG,KAA1B;AACD;;AAED,SAAS,OAAT,CAAiB,IAAjB,EAAuB,OAAvB,EAAgC;AAC9B,MAAI,MAAM,GAAG;AACX,IAAA,KAAK,EAAE,SADI;AAEX,IAAA,IAAI,EAAE,SAFK;AAGX,IAAA,cAAc,EAAE,CAHL;AAIX,IAAA,YAAY,EAAE,KAJH;AAKX,IAAA,sBAAsB,EAAE,KALb;AAMX,IAAA,eAAe,EAAE,yBANN;AAOX,IAAA,uBAAuB,EAAE,SAAS,uBAAT,GAAmC,CAAE;AAPnD,GAAb;AAcA,MAAI,OAAO,GAAG,IAAI,GAAJ,EAAd;;AAEA,WAAS,iBAAT,GAA6B;AAC3B,IAAA,MAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,6BAArC,EAAoE;AAClE,MAAA,OAAO,EAAE;AADyD,KAApE;AAGA,IAAA,MAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,6BAArC,EAAoE;AAClE,MAAA,OAAO,EAAE,KADyD;AAElE,MAAA,OAAO,EAAE;AAFyD,KAApE;AAIA,IAAA,MAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,gBAAnC,EAAqD;AACnD,MAAA,OAAO,EAAE;AAD0C,KAArD;AAGA,IAAA,MAAM,CAAC,gBAAP,CAAwB,UAAxB,EAAoC,gBAApC,EAAsD;AACpD,MAAA,OAAO,EAAE;AAD2C,KAAtD;AAGD;;AAED,WAAS,oBAAT,GAAgC;AAC9B,IAAA,MAAM,CAAC,mBAAP,CAA2B,WAA3B,EAAwC,6BAAxC;AACA,IAAA,MAAM,CAAC,mBAAP,CAA2B,WAA3B,EAAwC,6BAAxC;AACA,IAAA,MAAM,CAAC,mBAAP,CAA2B,SAA3B,EAAsC,gBAAtC;AACA,IAAA,MAAM,CAAC,mBAAP,CAA2B,UAA3B,EAAuC,gBAAvC;AACD;;AAED,WAAS,gBAAT,GAA4B;AAC1B,IAAA,oBAAoB;AACpB,IAAA,kBAAkB,GAAG,SAArB;AACA,IAAA,sBAAsB,GAAG,SAAzB;AACA,IAAA,oBAAoB,GAAG,SAAvB;AACD;;AAED,WAAS,6BAAT,CAAuC,CAAvC,EAA0C;AACxC,IAAA,CAAC,CAAC,cAAF;AACA,QAAI,CAAC,GAAG,CAAC,CAAC,OAAF,GAAY,CAAC,CAAC,OAAF,CAAU,CAAV,CAAZ,GAA2B,CAAnC;AACA,IAAA,oBAAoB,GAAG;AACrB,MAAA,CAAC,EAAE,CAAC,CAAC,OADgB;AAErB,MAAA,CAAC,EAAE,CAAC,CAAC;AAFgB,KAAvB;;AAKA,QAAI,IAAI,CAAC,GAAL,CAAS,oBAAoB,CAAC,CAArB,GAAyB,sBAAsB,CAAC,CAAzD,KAA+D,iCAA/D,IAAoG,IAAI,CAAC,GAAL,CAAS,oBAAoB,CAAC,CAArB,GAAyB,sBAAsB,CAAC,CAAzD,KAA+D,iCAAvK,EAA0M;AACxM,MAAA,oBAAoB;AACpB,MAAA,eAAe;AAChB;AACF;;AAED,WAAS,eAAT,CAAyB,CAAzB,EAA4B;AAC9B;AACI,QAAI,CAAC,CAAC,MAAF,KAAa,CAAC,CAAC,aAAf,KAAiC,CAAC,CAAC,MAAF,CAAS,KAAT,KAAmB,SAAnB,IAAgC,CAAC,CAAC,MAAF,CAAS,iBAA1E,CAAJ,EAAkG;AAIhG;AACD,KAPyB,CAOzB;;;AAGD,QAAI,CAAC,CAAC,MAAN,EAAc;AAIZ;AACD;;AAED,QAAI,uBAAJ,EAA6B;AAI3B;AACD;;AAED,IAAA,CAAC,CAAC,eAAF;AACA,QAAI,CAAC,GAAG,CAAC,CAAC,OAAF,GAAY,CAAC,CAAC,OAAF,CAAU,CAAV,CAAZ,GAA2B,CAAnC;AACA,IAAA,sBAAsB,GAAG;AACvB,MAAA,CAAC,EAAE,CAAC,CAAC,OADkB;AAEvB,MAAA,CAAC,EAAE,CAAC,CAAC;AAFkB,KAAzB;AAIA,IAAA,oBAAoB,GAAGC,gBAAc,CAAC,EAAD,EAAK,sBAAL,CAArC;AACA,IAAA,kBAAkB,GAAG,CAAC,CAAC,aAAvB;AACA,IAAA,iBAAiB;AAClB;;AAED,WAAS,eAAT,GAA2B;AAIzB,IAAA,uBAAuB,GAAG,IAA1B,CAJyB,CAIM;;AAE/B,QAAI,UAAU,GAAG,OAAO,CAAC,GAAR,CAAY,kBAAZ,CAAjB;AACA,IAAA,WAAW,GAAG,UAAd;AACA,IAAA,cAAc,GAAG,kBAAkB,CAAC,aAApC;AACA,QAAI,KAAK,GAAG,MAAM,CAAC,KAAnB;AAAA,QACI,IAAI,GAAG,MAAM,CAAC,IADlB;AAEA,IAAA,aAAa,GAAGA,gBAAc,CAAC,EAAD,EAAK,KAAK,CAAC,UAAD,CAAV,CAA9B;AACA,IAAA,aAAa,GAAG,IAAhB;AACA,IAAA,YAAY,GAAGA,gBAAc,CAACA,gBAAc,CAAC,EAAD,EAAK,aAAL,CAAf,EAAoC,EAApC,EAAwCF,iBAAe,CAAC,EAAD,EAAK,gCAAL,EAAuC,IAAvC,CAAvD,CAA7B,CAbyB,CAayG;;AAElI,IAAA,SAAS,GAAG,wBAAwB,CAAC,kBAAD,CAApC,CAfyB,CAegC;;AAEzD,aAAS,wBAAT,GAAoC;AAClC,UAAI,QAAQ,GAAG,MAAM,CAAC,KAAtB;;AAEA,UAAI,CAAC,SAAS,CAAC,aAAX,KAA6B,CAAC,QAAQ,CAAC,WAAD,CAAT,IAA0B,aAAa,CAAC,WAAD,CAAb,KAA+B,QAAQ,CAAC,WAAD,CAAR,CAAsB,WAAtB,CAAtF,CAAJ,EAA+H;AAC7H,QAAA,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,SAA1B,EAD6H,CACxF;;AAErC,QAAA,SAAS,CAAC,KAAV;AACA,QAAA,mBAAmB;AACnB,QAAA,sBAAsB,CAAC,kBAAD,CAAtB;AACA,QAAA,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,kBAA1B;AACD,OAPD,MAOO;AACL,QAAA,MAAM,CAAC,qBAAP,CAA6B,wBAA7B;AACD;AACF;;AAED,IAAA,MAAM,CAAC,qBAAP,CAA6B,wBAA7B;AACA,IAAA,oBAAoB,CAAC,KAAK,CAAC,IAAN,CAAW,eAAe,CAAC,GAAhB,CAAoB,MAAM,CAAC,IAA3B,CAAX,EAA6C,MAA7C,CAAoD,UAAU,EAAV,EAAc;AACrF,aAAO,EAAE,KAAK,cAAP,IAAyB,CAAC,UAAU,CAAC,GAAX,CAAe,EAAf,EAAmB,sBAApD;AACD,KAFoB,CAAD,EAEhB,UAAU,EAAV,EAAc;AAChB,aAAO,UAAU,CAAC,GAAX,CAAe,EAAf,EAAmB,eAA1B;AACD,KAJmB,CAApB,CAjCyB,CAqCtB;;AAEH,IAAA,KAAK,CAAC,MAAN,CAAa,UAAb,EAAyB,CAAzB;AACA,IAAA,2BAA2B,GAAG,gBAAgB,CAAC,cAAD,CAA9C;AACA,IAAA,qBAAqB,CAAC,cAAD,EAAiB,KAAjB,EAAwB;AAC3C,MAAA,OAAO,EAAE,QAAQ,CAAC,YADyB;AAE3C,MAAA,EAAE,EAAE,aAAa,CAAC,WAAD,CAF0B;AAG3C,MAAA,MAAM,EAAE,OAAO,CAAC;AAH2B,KAAxB,CAArB,CAzCyB,CA6CtB;;AAEH,IAAA,MAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,eAArC,EAAsD;AACpD,MAAA,OAAO,EAAE;AAD2C,KAAtD;AAGA,IAAA,MAAM,CAAC,gBAAP,CAAwB,WAAxB,EAAqC,eAArC,EAAsD;AACpD,MAAA,OAAO,EAAE,KAD2C;AAEpD,MAAA,OAAO,EAAE;AAF2C,KAAtD;AAIA,IAAA,MAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,UAAnC,EAA+C;AAC7C,MAAA,OAAO,EAAE;AADoC,KAA/C;AAGA,IAAA,MAAM,CAAC,gBAAP,CAAwB,UAAxB,EAAoC,UAApC,EAAgD;AAC9C,MAAA,OAAO,EAAE;AADqC,KAAhD;AAGD;;AAED,WAAS,SAAT,CAAmB,IAAnB,EAAyB;AACvB,QAAI,UAAU,GAAG,IAAI,CAAC,KAAtB;AAAA,QACI,KAAK,GAAG,UAAU,KAAK,KAAK,CAApB,GAAwB,SAAxB,GAAoC,UADhD;AAAA,QAEI,mBAAmB,GAAG,IAAI,CAAC,cAF/B;AAAA,QAGI,uBAAuB,GAAG,mBAAmB,KAAK,KAAK,CAA7B,GAAiC,CAAjC,GAAqC,mBAHnE;AAAA,QAII,SAAS,GAAG,IAAI,CAAC,IAJrB;AAAA,QAKI,OAAO,GAAG,SAAS,KAAK,KAAK,CAAnB,GAAuB,sBAAvB,GAAgD,SAL9D;AAAA,QAMI,iBAAiB,GAAG,IAAI,CAAC,YAN7B;AAAA,QAOI,YAAY,GAAG,iBAAiB,KAAK,KAAK,CAA3B,GAA+B,KAA/B,GAAuC,iBAP1D;AAAA,QAQI,qBAAqB,GAAG,IAAI,CAAC,sBARjC;AAAA,QASI,sBAAsB,GAAG,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,KAAnC,GAA2C,qBATxE;AAAA,QAUI,oBAAoB,GAAG,IAAI,CAAC,eAVhC;AAAA,QAWI,eAAe,GAAG,oBAAoB,KAAK,KAAK,CAA9B,GAAkC,yBAAlC,GAA8D,oBAXpF;AAAA,QAYI,qBAAqB,GAAG,IAAI,CAAC,uBAZjC;AAAA,QAaI,uBAAuB,GAAG,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,YAAY,CAAE,CAAjD,GAAoD,qBAblF;AAcA,IAAA,MAAM,CAAC,uBAAP,GAAiC,uBAAjC;;AAEA,QAAI,MAAM,CAAC,IAAP,IAAe,OAAO,KAAK,MAAM,CAAC,IAAtC,EAA4C;AAC1C,MAAA,kBAAkB,CAAC,IAAD,EAAO,MAAM,CAAC,IAAd,CAAlB;AACD;;AAED,IAAA,MAAM,CAAC,IAAP,GAAc,OAAd;AACA,IAAA,gBAAgB,CAAC,IAAD,EAAO,OAAP,CAAhB;AACA,IAAA,MAAM,CAAC,KAAP,GAAe,kBAAkB,CAAC,KAAD,CAAjC;AACA,IAAA,MAAM,CAAC,YAAP,GAAsB,YAAtB;AACA,IAAA,MAAM,CAAC,uBAAP,GAAiC,uBAAjC,CAzBuB,CAyBkC;;AAEzD,QAAI,uBAAuB,IAAI,CAAC,sBAA5B,IAAsD,CAAC,sBAAsB,CAAC,eAAD,EAAkB,MAAM,CAAC,eAAzB,CAAjF,EAA4H;AAC1H,MAAA,sBAAsB,CAAC,CAAC,IAAD,CAAD,EAAS,YAAY;AACzC,eAAO,MAAM,CAAC,eAAd;AACD,OAFqB,CAAtB;AAGA,MAAA,oBAAoB,CAAC,CAAC,IAAD,CAAD,EAAS,YAAY;AACvC,eAAO,eAAP;AACD,OAFmB,CAApB;AAGD;;AAED,IAAA,MAAM,CAAC,eAAP,GAAyB,eAAzB,CApCuB,CAoCkB;;AAEzC,QAAI,uBAAuB,IAAI,MAAM,CAAC,sBAAP,KAAkC,sBAAjE,EAAyF;AACvF,UAAI,sBAAJ,EAA4B;AAC1B,QAAA,sBAAsB,CAAC,CAAC,IAAD,CAAD,EAAS,UAAU,EAAV,EAAc;AAC3C,iBAAO,UAAU,CAAC,GAAX,CAAe,EAAf,EAAmB,eAA1B;AACD,SAFqB,CAAtB;AAGD,OAJD,MAIO;AACL,QAAA,oBAAoB,CAAC,CAAC,IAAD,CAAD,EAAS,UAAU,EAAV,EAAc;AACzC,iBAAO,UAAU,CAAC,GAAX,CAAe,EAAf,EAAmB,eAA1B;AACD,SAFmB,CAApB;AAGD;AACF;;AAED,IAAA,MAAM,CAAC,sBAAP,GAAgC,sBAAhC;AACA,IAAA,UAAU,CAAC,GAAX,CAAe,IAAf,EAAqB,MAArB;;AAEA,QAAI,KAAK,GAAG,SAAS,KAAT,CAAe,GAAf,EAAoB;AAC9B,UAAI,WAAW,GAAG,IAAI,CAAC,QAAL,CAAc,GAAd,CAAlB;AACA,MAAA,cAAc,CAAC,WAAD,EAAc,YAAd,CAAd;;AAEA,UAAI,MAAM,CAAC,KAAP,CAAa,GAAb,EAAkB,gCAAlB,CAAJ,EAAyD;AACvD,QAAA,2BAA2B,CAAC,SAAD,EAAY,WAAZ,EAAyB,oBAAoB,CAAC,CAA9C,EAAiD,oBAAoB,CAAC,CAAtE,EAAyE,YAAY;AAC9G,iBAAO,MAAM,CAAC,uBAAP,CAA+B,SAA/B,EAA0C,aAA1C,EAAyD,GAAzD,CAAP;AACD,SAF0B,CAA3B;AAGA,QAAA,gBAAgB,CAAC,WAAD,CAAhB;AACA,eAAO,UAAP;AACD;;AAED,MAAA,WAAW,CAAC,mBAAZ,CAAgC,WAAhC,EAA6C,qBAAqB,CAAC,GAAtB,CAA0B,WAA1B,CAA7C;AACA,MAAA,WAAW,CAAC,mBAAZ,CAAgC,YAAhC,EAA8C,qBAAqB,CAAC,GAAtB,CAA0B,WAA1B,CAA9C;;AAEA,UAAI,CAAC,YAAL,EAAmB;AACjB,QAAA,WAAW,CAAC,gBAAZ,CAA6B,WAA7B,EAA0C,eAA1C;AACA,QAAA,WAAW,CAAC,gBAAZ,CAA6B,YAA7B,EAA2C,eAA3C;AACA,QAAA,qBAAqB,CAAC,GAAtB,CAA0B,WAA1B,EAAuC,eAAvC;AACD,OAnB6B,CAmB7B;;;AAGD,MAAA,OAAO,CAAC,GAAR,CAAY,WAAZ,EAAyB,GAAzB;AACD,KAvBD;;AAyBA,SAAK,IAAI,GAAG,GAAG,CAAf,EAAkB,GAAG,GAAG,IAAI,CAAC,QAAL,CAAc,MAAtC,EAA8C,GAAG,EAAjD,EAAqD;AACnD,UAAI,IAAI,GAAG,KAAK,CAAC,GAAD,CAAhB;;AAEA,UAAI,IAAI,KAAK,UAAb,EAAyB;AAC1B;AACF;;AAED,EAAA,SAAS,CAAC,OAAD,CAAT;AACA,SAAO;AACL,IAAA,MAAM,EAAE,SAAS,MAAT,CAAgB,UAAhB,EAA4B;AAIlC,MAAA,SAAS,CAAC,UAAD,CAAT;AACD,KANI;AAOL,IAAA,OAAO,EAAE,SAAS,OAAT,GAAmB;AAI1B,MAAA,kBAAkB,CAAC,IAAD,EAAO,MAAM,CAAC,IAAd,CAAlB;AACA,MAAA,UAAU,CAAC,QAAD,CAAV,CAAqB,IAArB;AACD;AAbI,GAAP;AAeD;;AAED,IAAI,kBAAJ;;AACA,IAAI,eAAe,GAAG;AACpB,EAAA,eAAe,EAAE,iBADG;AAEpB,EAAA,sBAAsB,EAAE;AAFJ,CAAtB;AAIA,IAAI,iBAAiB,IAAI,kBAAkB,GAAG,EAArB,EAAyBA,iBAAe,CAAC,kBAAD,EAAqB,eAAe,CAAC,eAArC,EAAsD,wEAAtD,CAAxC,EAAyKA,iBAAe,CAAC,kBAAD,EAAqB,eAAe,CAAC,sBAArC,EAA6D,uCAA7D,CAAxL,EAA+R,kBAAnS,CAArB;AACA,IAAI,YAAY,GAAG,uBAAnB;AACA,IAAI,SAAJ;AACA;AACA;AACA;AACA;;AAEA,SAAS,QAAT,GAAoB;AAClB,MAAI,UAAJ,EAAgB,OAAO,IAAP;AAChB,EAAA,MAAM,CAAC,gBAAP,CAAwB,kBAAxB,EAA4C,YAAY;AAC1D;AACI,IAAA,SAAS,GAAG,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAZ;;AAEA,KAAC,SAAS,aAAT,GAAyB;AACxB,MAAA,SAAS,CAAC,EAAV,GAAe,YAAf,CADwB,CACI;AAClC;;AAEM,MAAA,SAAS,CAAC,KAAV,CAAgB,QAAhB,GAA2B,OAA3B;AACA,MAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,GAAzB;AACA,MAAA,SAAS,CAAC,KAAV,CAAgB,IAAhB,GAAuB,GAAvB;AACA,MAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,IAAzB;AACA,MAAA,SAAS,CAAC,KAAV,CAAgB,OAAhB,GAA0B,GAA1B;AACA,MAAA,SAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,GAAzB;AACA,MAAA,SAAS,CAAC,KAAV,CAAgB,KAAhB,GAAwB,GAAxB;AACA,MAAA,SAAS,CAAC,YAAV,CAAuB,MAAvB,EAA+B,OAA/B;AACD,KAZD;;AAcA,IAAA,QAAQ,CAAC,IAAT,CAAc,OAAd,CAAsB,SAAtB,EAlBsD,CAkBrB;;AAEjC,IAAA,MAAM,CAAC,OAAP,CAAe,iBAAf,EAAkC,OAAlC,CAA0C,UAAU,IAAV,EAAgB;AACxD,UAAI,KAAK,GAAG,cAAc,CAAC,IAAD,EAAO,CAAP,CAA1B;AAAA,UACI,EAAE,GAAG,KAAK,CAAC,CAAD,CADd;AAAA,UAEI,GAAG,GAAG,KAAK,CAAC,CAAD,CAFf;;AAIA,aAAO,QAAQ,CAAC,IAAT,CAAc,OAAd,CAAsB,sBAAsB,CAAC,EAAD,EAAK,GAAL,CAA5C,CAAP;AACD,KAND;AAOD,GA3BD;AA4BA,SAAOE,gBAAc,CAAC,EAAD,EAAK,eAAL,CAArB;AACD;;AAED,SAAS,sBAAT,CAAgC,EAAhC,EAAoC,GAApC,EAAyC;AACvC,MAAI,GAAG,GAAG,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAV;AACA,EAAA,GAAG,CAAC,EAAJ,GAAS,EAAT;AACA,EAAA,GAAG,CAAC,SAAJ,GAAgB,MAAM,MAAN,CAAa,GAAb,EAAkB,MAAlB,CAAhB;AACA,EAAA,GAAG,CAAC,KAAJ,CAAU,OAAV,GAAoB,MAApB;AACA,EAAA,GAAG,CAAC,KAAJ,CAAU,QAAV,GAAqB,OAArB;AACA,EAAA,GAAG,CAAC,KAAJ,CAAU,MAAV,GAAmB,IAAnB;AACA,SAAO,GAAP;AACD;AACD;AACA;AACA;AACA;;;AAGA,SAAS,mBAAT,CAA6B,GAA7B,EAAkC;AAChC,EAAA,SAAS,CAAC,SAAV,GAAsB,EAAtB;AACA,MAAI,SAAS,GAAG,QAAQ,CAAC,cAAT,CAAwB,GAAxB,CAAhB;AACA,EAAA,SAAS,CAAC,WAAV,CAAsB,SAAtB,EAHgC,CAGC;;AAEjC,EAAA,SAAS,CAAC,KAAV,CAAgB,OAAhB,GAA0B,MAA1B;AACA,EAAA,SAAS,CAAC,KAAV,CAAgB,OAAhB,GAA0B,QAA1B;AACD;;AAED,IAAI,wBAAwB,GAAG,SAA/B;AACA,IAAI,2BAA2B,GAAG;AAChC,EAAA,OAAO,EAAE;AADuB,CAAlC;AAGA,IAAI,UAAU,GAAG,KAAjB;AACA,IAAI,eAAJ;AACA,IAAI,SAAJ;AACA,IAAI,cAAc,GAAG,EAArB;AACA,IAAI,WAAJ;AACA,IAAI,aAAJ;AACA,IAAI,gBAAgB,GAAG,EAAvB;AACA,IAAI,cAAc,GAAG,IAAI,OAAJ,EAArB;AACA,IAAI,oBAAoB,GAAG,IAAI,OAAJ,EAA3B;AACA,IAAI,kBAAkB,GAAG,IAAI,OAAJ,EAAzB;AACA,IAAI,WAAW,GAAG,IAAI,GAAJ,EAAlB;AACA,IAAI,YAAY,GAAG,IAAI,GAAJ,EAAnB;AACA,IAAI,iBAAiB,GAAG,IAAI,GAAJ,EAAxB;AACA;AACA;AACA;AACA;;AAEA,IAAI,iBAAiB,GAAG,QAAQ,EAAhC;AACA;;AAEA,SAAS,kBAAT,CAA4B,UAA5B,EAAwC,IAAxC,EAA8C;AAK5C,MAAI,iBAAiB,CAAC,IAAlB,KAA2B,CAA/B,EAAkC;AAIhC,IAAA,MAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,oBAAnC;AACA,IAAA,MAAM,CAAC,gBAAP,CAAwB,OAAxB,EAAiC,kBAAjC;AACD;;AAED,MAAI,CAAC,iBAAiB,CAAC,GAAlB,CAAsB,IAAtB,CAAL,EAAkC;AAChC,IAAA,iBAAiB,CAAC,GAAlB,CAAsB,IAAtB,EAA4B,IAAI,GAAJ,EAA5B;AACD;;AAED,MAAI,CAAC,iBAAiB,CAAC,GAAlB,CAAsB,IAAtB,EAA4B,GAA5B,CAAgC,UAAhC,CAAL,EAAkD;AAChD,IAAA,iBAAiB,CAAC,GAAlB,CAAsB,IAAtB,EAA4B,GAA5B,CAAgC,UAAhC;AACA,IAAA,4BAA4B;AAC7B;AACF;;AAED,SAAS,oBAAT,CAA8B,UAA9B,EAA0C,IAA1C,EAAgD;AAK9C,MAAI,SAAS,KAAK,UAAlB,EAA8B;AAC5B,IAAA,YAAY;AACb;;AAED,EAAA,iBAAiB,CAAC,GAAlB,CAAsB,IAAtB,EAA4B,QAA5B,EAAsC,UAAtC;AACA,EAAA,4BAA4B;;AAE5B,MAAI,iBAAiB,CAAC,GAAlB,CAAsB,IAAtB,EAA4B,IAA5B,KAAqC,CAAzC,EAA4C;AAC1C,IAAA,iBAAiB,CAAC,QAAD,CAAjB,CAA4B,IAA5B;AACD;;AAED,MAAI,iBAAiB,CAAC,IAAlB,KAA2B,CAA/B,EAAkC;AAIhC,IAAA,MAAM,CAAC,mBAAP,CAA2B,SAA3B,EAAsC,oBAAtC;AACA,IAAA,MAAM,CAAC,mBAAP,CAA2B,OAA3B,EAAoC,kBAApC;AACD;AACF;;AAED,SAAS,oBAAT,CAA8B,CAA9B,EAAiC;AAC/B,MAAI,CAAC,UAAL,EAAiB;;AAEjB,UAAQ,CAAC,CAAC,GAAV;AACE,SAAK,QAAL;AACE;AACE,QAAA,YAAY;AACZ;AACD;AALL;AAOD;;AAED,SAAS,kBAAT,GAA8B;AAC5B,MAAI,CAAC,UAAL,EAAiB;;AAEjB,MAAI,CAAC,cAAc,CAAC,GAAf,CAAmB,QAAQ,CAAC,aAA5B,CAAL,EAAiD;AAI/C,IAAA,YAAY;AACb;AACF;;AAED,SAAS,eAAT,CAAyB,CAAzB,EAA4B;AAI1B,MAAI,CAAC,UAAL,EAAiB;AACjB,MAAI,cAAc,GAAG,CAAC,CAAC,aAAvB;AACA,MAAI,cAAc,KAAK,SAAvB,EAAkC;AAClC,EAAA,cAAc,GAAG,cAAc,CAAC,YAAf,CAA4B,YAA5B,KAA6C,EAA9D;;AAEA,MAAI,eAAe,GAAG,YAAY,CAAC,GAAb,CAAiB,SAAjB,CAAtB;AAAA,MACI,WAAW,GAAG,eAAe,CAAC,KADlC;;AAGA,MAAI,UAAU,GAAG,WAAW,CAAC,IAAZ,CAAiB,UAAU,IAAV,EAAgB;AAChD,WAAO,IAAI,CAAC,WAAD,CAAJ,KAAsB,aAA7B;AACD,GAFgB,CAAjB;AAGA,MAAI,SAAS,GAAG,WAAW,CAAC,OAAZ,CAAoB,UAApB,CAAhB;AACA,MAAI,UAAU,GAAG,WAAW,CAAC,MAAZ,CAAmB,SAAnB,EAA8B,CAA9B,EAAiC,CAAjC,CAAjB;;AAEA,MAAI,gBAAgB,GAAG,YAAY,CAAC,GAAb,CAAiB,cAAjB,CAAvB;AAAA,MACI,WAAW,GAAG,gBAAgB,CAAC,KADnC;AAAA,MAEI,gBAAgB,GAAG,gBAAgB,CAAC,gBAFxC;;AAIA,MAAI,cAAc,CAAC,qBAAf,GAAuC,GAAvC,GAA6C,SAAS,CAAC,qBAAV,GAAkC,GAA/E,IAAsF,cAAc,CAAC,qBAAf,GAAuC,IAAvC,GAA8C,SAAS,CAAC,qBAAV,GAAkC,IAA1K,EAAgL;AAC9K,IAAA,WAAW,CAAC,IAAZ,CAAiB,UAAjB;;AAEA,QAAI,CAAC,gBAAL,EAAuB;AACrB,MAAA,mBAAmB,CAAC,cAAc,MAAd,CAAqB,gBAArB,EAAuC,0BAAvC,EAAmE,MAAnE,CAA0E,cAA1E,CAAD,CAAnB;AACD;AACF,GAND,MAMO;AACL,IAAA,WAAW,CAAC,OAAZ,CAAoB,UAApB;;AAEA,QAAI,CAAC,gBAAL,EAAuB;AACrB,MAAA,mBAAmB,CAAC,cAAc,MAAd,CAAqB,gBAArB,EAAuC,gCAAvC,EAAyE,MAAzE,CAAgF,cAAhF,CAAD,CAAnB;AACD;AACF;;AAED,MAAI,MAAM,GAAG,SAAb;AACA,EAAA,qBAAqB,CAAC,MAAD,EAAS,WAAT,EAAsB;AACzC,IAAA,OAAO,EAAE,QAAQ,CAAC,oBADuB;AAEzC,IAAA,EAAE,EAAE,aAFqC;AAGzC,IAAA,MAAM,EAAE,OAAO,CAAC;AAHyB,GAAtB,CAArB;AAKA,EAAA,qBAAqB,CAAC,cAAD,EAAiB,WAAjB,EAA8B;AACjD,IAAA,OAAO,EAAE,QAAQ,CAAC,iBAD+B;AAEjD,IAAA,EAAE,EAAE,aAF6C;AAGjD,IAAA,MAAM,EAAE,OAAO,CAAC;AAHiC,GAA9B,CAArB;AAKA,EAAA,SAAS,GAAG,cAAZ;AACD;;AAED,SAAS,mBAAT,GAA+B;AAC7B,EAAA,WAAW,CAAC,OAAZ,CAAoB,UAAU,IAAV,EAAgB,EAAhB,EAAoB;AACtC,QAAI,MAAM,GAAG,IAAI,CAAC,MAAlB;AACA,WAAO,MAAM,CAAC,YAAY,CAAC,GAAb,CAAiB,EAAjB,CAAD,CAAb;AACD,GAHD;AAID;;AAED,SAAS,YAAT,GAAwB;AACtB,MAAI,gBAAgB,GAAG,SAAS,CAAC,MAAV,GAAmB,CAAnB,IAAwB,SAAS,CAAC,CAAD,CAAT,KAAiB,SAAzC,GAAqD,SAAS,CAAC,CAAD,CAA9D,GAAoE,IAA3F;;AAKA,MAAI,CAAC,YAAY,CAAC,GAAb,CAAiB,SAAjB,EAA4B,gBAAjC,EAAmD;AACjD,IAAA,mBAAmB,CAAC,yBAAyB,MAAzB,CAAgC,gBAAhC,CAAD,CAAnB;AACD;;AAED,MAAI,cAAc,CAAC,GAAf,CAAmB,QAAQ,CAAC,aAA5B,CAAJ,EAAgD;AAC9C,IAAA,QAAQ,CAAC,aAAT,CAAuB,IAAvB;AACD;;AAED,MAAI,gBAAJ,EAAsB;AACpB,IAAA,qBAAqB,CAAC,SAAD,EAAY,YAAY,CAAC,GAAb,CAAiB,SAAjB,EAA4B,KAAxC,EAA+C;AAClE,MAAA,OAAO,EAAE,QAAQ,CAAC,YADgD;AAElE,MAAA,EAAE,EAAE,aAF8D;AAGlE,MAAA,MAAM,EAAE,OAAO,CAAC;AAHkD,KAA/C,CAArB;AAKD;;AAED,EAAA,sBAAsB,CAAC,iBAAiB,CAAC,GAAlB,CAAsB,eAAtB,CAAD,EAAyC,UAAU,EAAV,EAAc;AAC3E,WAAO,YAAY,CAAC,GAAb,CAAiB,EAAjB,EAAqB,eAA5B;AACD,GAFqB,CAAtB;AAGA,EAAA,WAAW,GAAG,IAAd;AACA,EAAA,aAAa,GAAG,IAAhB;AACA,EAAA,gBAAgB,GAAG,EAAnB;AACA,EAAA,eAAe,GAAG,IAAlB;AACA,EAAA,SAAS,GAAG,IAAZ;AACA,EAAA,cAAc,GAAG,EAAjB;AACA,EAAA,UAAU,GAAG,KAAb;AACA,EAAA,mBAAmB;AACpB,C,CAAA;;;AAGD,SAAS,SAAT,CAAmB,IAAnB,EAAyB,OAAzB,EAAkC;AAChC,MAAI,MAAM,GAAG;AACX,IAAA,KAAK,EAAE,SADI;AAEX,IAAA,IAAI,EAAE,SAFK;AAGX,IAAA,YAAY,EAAE,KAHH;AAIX,IAAA,sBAAsB,EAAE,KAJb;AAKX,IAAA,eAAe,EAAE,2BALN;AAMX,IAAA,gBAAgB,EAAE;AANP,GAAb;;AASA,WAAS,IAAT,CAAc,GAAd,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB;AACvB,QAAI,GAAG,CAAC,MAAJ,IAAc,CAAlB,EAAqB;AACrB,IAAA,GAAG,CAAC,MAAJ,CAAW,CAAX,EAAc,CAAd,EAAiB,GAAG,CAAC,MAAJ,CAAW,CAAX,EAAc,CAAd,EAAiB,GAAG,CAAC,CAAD,CAApB,EAAyB,CAAzB,CAAjB;AACD;;AAED,WAAS,aAAT,CAAuB,CAAvB,EAA0B;AAKxB,YAAQ,CAAC,CAAC,GAAV;AACE,WAAK,OAAL;AACA,WAAK,GAAL;AACE;AACR;AACU,cAAI,CAAC,CAAC,CAAC,MAAF,CAAS,KAAT,KAAmB,SAAnB,IAAgC,CAAC,CAAC,MAAF,CAAS,iBAA1C,KAAgE,CAAC,cAAc,CAAC,GAAf,CAAmB,CAAC,CAAC,MAArB,CAArE,EAAmG;AACjG;AACD;;AAED,UAAA,CAAC,CAAC,cAAF,GANF,CAMqB;;AAEnB,UAAA,CAAC,CAAC,eAAF;;AAEA,cAAI,UAAJ,EAAgB;AAC1B;AACY,YAAA,YAAY;AACb,WAHD,MAGO;AACjB;AACY,YAAA,eAAe,CAAC,CAAD,CAAf;AACD;;AAED;AACD;;AAEH,WAAK,WAAL;AACA,WAAK,YAAL;AACE;AACE,cAAI,CAAC,UAAL,EAAiB;AACjB,UAAA,CAAC,CAAC,cAAF,GAFF,CAEqB;;AAEnB,UAAA,CAAC,CAAC,eAAF;;AAEA,cAAI,gBAAgB,GAAG,YAAY,CAAC,GAAb,CAAiB,IAAjB,CAAvB;AAAA,cACI,KAAK,GAAG,gBAAgB,CAAC,KAD7B;;AAGA,cAAI,QAAQ,GAAG,KAAK,CAAC,IAAN,CAAW,IAAI,CAAC,QAAhB,CAAf;AACA,cAAI,GAAG,GAAG,QAAQ,CAAC,OAAT,CAAiB,CAAC,CAAC,aAAnB,CAAV;;AAKA,cAAI,GAAG,GAAG,QAAQ,CAAC,MAAT,GAAkB,CAA5B,EAA+B;AAC7B,gBAAI,CAAC,MAAM,CAAC,gBAAZ,EAA8B;AAC5B,cAAA,mBAAmB,CAAC,cAAc,MAAd,CAAqB,gBAArB,EAAuC,eAAvC,EAAwD,MAAxD,CAA+D,GAAG,GAAG,CAArE,EAAwE,eAAxE,EAAyF,MAAzF,CAAgG,cAAhG,CAAD,CAAnB;AACD;;AAED,YAAA,IAAI,CAAC,KAAD,EAAQ,GAAR,EAAa,GAAG,GAAG,CAAnB,CAAJ;AACA,YAAA,qBAAqB,CAAC,IAAD,EAAO,KAAP,EAAc;AACjC,cAAA,OAAO,EAAE,QAAQ,CAAC,iBADe;AAEjC,cAAA,EAAE,EAAE,aAF6B;AAGjC,cAAA,MAAM,EAAE,OAAO,CAAC;AAHiB,aAAd,CAArB;AAKD;;AAED;AACD;;AAEH,WAAK,SAAL;AACA,WAAK,WAAL;AACE;AACE,cAAI,CAAC,UAAL,EAAiB;AACjB,UAAA,CAAC,CAAC,cAAF,GAFF,CAEqB;;AAEnB,UAAA,CAAC,CAAC,eAAF;;AAEA,cAAI,gBAAgB,GAAG,YAAY,CAAC,GAAb,CAAiB,IAAjB,CAAvB;AAAA,cACI,MAAM,GAAG,gBAAgB,CAAC,KAD9B;;AAGA,cAAI,SAAS,GAAG,KAAK,CAAC,IAAN,CAAW,IAAI,CAAC,QAAhB,CAAhB;;AAEA,cAAI,IAAI,GAAG,SAAS,CAAC,OAAV,CAAkB,CAAC,CAAC,aAApB,CAAX;;AAMA,cAAI,IAAI,GAAG,CAAX,EAAc;AACZ,gBAAI,CAAC,MAAM,CAAC,gBAAZ,EAA8B;AAC5B,cAAA,mBAAmB,CAAC,cAAc,MAAd,CAAqB,gBAArB,EAAuC,eAAvC,EAAwD,MAAxD,CAA+D,IAA/D,EAAqE,eAArE,EAAsF,MAAtF,CAA6F,cAA7F,CAAD,CAAnB;AACD;;AAED,YAAA,IAAI,CAAC,MAAD,EAAS,IAAT,EAAe,IAAI,GAAG,CAAtB,CAAJ;AACA,YAAA,qBAAqB,CAAC,IAAD,EAAO,MAAP,EAAe;AAClC,cAAA,OAAO,EAAE,QAAQ,CAAC,iBADgB;AAElC,cAAA,EAAE,EAAE,aAF8B;AAGlC,cAAA,MAAM,EAAE,OAAO,CAAC;AAHkB,aAAf,CAArB;AAKD;;AAED;AACD;AA1FL;AA4FD;;AAED,WAAS,eAAT,CAAyB,CAAzB,EAA4B;AAI1B,IAAA,qBAAqB,CAAC,CAAC,CAAC,aAAH,CAArB;AACA,IAAA,SAAS,GAAG,IAAZ;AACA,IAAA,eAAe,GAAG,MAAM,CAAC,IAAzB;AACA,IAAA,UAAU,GAAG,IAAb;AACA,QAAI,WAAW,GAAG,KAAK,CAAC,IAAN,CAAW,iBAAiB,CAAC,GAAlB,CAAsB,MAAM,CAAC,IAA7B,CAAX,EAA+C,MAA/C,CAAsD,UAAU,EAAV,EAAc;AACpF,aAAO,EAAE,KAAK,SAAP,IAAoB,CAAC,YAAY,CAAC,GAAb,CAAiB,EAAjB,EAAqB,sBAAjD;AACD,KAFiB,CAAlB;AAGA,IAAA,oBAAoB,CAAC,WAAD,EAAc,UAAU,EAAV,EAAc;AAC9C,aAAO,YAAY,CAAC,GAAb,CAAiB,EAAjB,EAAqB,eAA5B;AACD,KAFmB,CAApB;;AAIA,QAAI,CAAC,MAAM,CAAC,gBAAZ,EAA8B;AAC5B,UAAI,GAAG,GAAG,yBAAyB,MAAzB,CAAgC,gBAAhC,EAAkD,kDAAlD,EAAsG,MAAtG,CAA6G,cAA7G,CAAV;;AAEA,UAAI,WAAW,CAAC,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B,QAAA,GAAG,IAAI,4DAAP;AACD;;AAED,MAAA,mBAAmB,CAAC,GAAD,CAAnB;AACD;;AAED,IAAA,qBAAqB,CAAC,IAAD,EAAO,YAAY,CAAC,GAAb,CAAiB,IAAjB,EAAuB,KAA9B,EAAqC;AACxD,MAAA,OAAO,EAAE,QAAQ,CAAC,YADsC;AAExD,MAAA,EAAE,EAAE,aAFoD;AAGxD,MAAA,MAAM,EAAE,OAAO,CAAC;AAHwC,KAArC,CAArB;AAKA,IAAA,mBAAmB;AACpB;;AAED,WAAS,WAAT,CAAqB,CAArB,EAAwB;AACtB,QAAI,CAAC,UAAL,EAAiB;AACjB,QAAI,CAAC,CAAC,aAAF,KAAoB,WAAxB,EAAqC;AACrC,IAAA,CAAC,CAAC,eAAF;AACA,IAAA,YAAY,CAAC,KAAD,CAAZ;AACA,IAAA,eAAe,CAAC,CAAD,CAAf;AACD;;AAED,WAAS,qBAAT,CAA+B,WAA/B,EAA4C;AAC1C,QAAI,gBAAgB,GAAG,YAAY,CAAC,GAAb,CAAiB,IAAjB,CAAvB;AAAA,QACI,KAAK,GAAG,gBAAgB,CAAC,KAD7B;;AAGA,QAAI,QAAQ,GAAG,KAAK,CAAC,IAAN,CAAW,IAAI,CAAC,QAAhB,CAAf;AACA,QAAI,cAAc,GAAG,QAAQ,CAAC,OAAT,CAAiB,WAAjB,CAArB;AACA,IAAA,WAAW,GAAG,WAAd;AACA,IAAA,aAAa,GAAG,KAAK,CAAC,cAAD,CAAL,CAAsB,WAAtB,CAAhB;AACA,IAAA,gBAAgB,GAAG,QAAQ,CAAC,cAAD,CAAR,CAAyB,YAAzB,CAAsC,YAAtC,KAAuD,EAA1E;AACD;;AAED,WAAS,SAAT,CAAmB,KAAnB,EAA0B;AACxB,QAAI,WAAW,GAAG,KAAK,CAAC,KAAxB;AAAA,QACI,KAAK,GAAG,WAAW,KAAK,KAAK,CAArB,GAAyB,EAAzB,GAA8B,WAD1C;AAAA,QAEI,UAAU,GAAG,KAAK,CAAC,IAFvB;AAAA,QAGI,OAAO,GAAG,UAAU,KAAK,KAAK,CAApB,GAAwB,wBAAxB,GAAmD,UAHjE;AAAA,QAII,kBAAkB,GAAG,KAAK,CAAC,YAJ/B;AAAA,QAKI,YAAY,GAAG,kBAAkB,KAAK,KAAK,CAA5B,GAAgC,KAAhC,GAAwC,kBAL3D;AAAA,QAMI,qBAAqB,GAAG,KAAK,CAAC,sBANlC;AAAA,QAOI,sBAAsB,GAAG,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,KAAnC,GAA2C,qBAPxE;AAAA,QAQI,qBAAqB,GAAG,KAAK,CAAC,eARlC;AAAA,QASI,eAAe,GAAG,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,2BAAnC,GAAiE,qBATvF;AAAA,QAUI,qBAAqB,GAAG,KAAK,CAAC,gBAVlC;AAAA,QAWI,gBAAgB,GAAG,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,KAAnC,GAA2C,qBAXlE;AAYA,IAAA,MAAM,CAAC,KAAP,GAAe,kBAAkB,CAAC,KAAD,CAAjC;AACA,IAAA,MAAM,CAAC,YAAP,GAAsB,YAAtB;AACA,IAAA,MAAM,CAAC,sBAAP,GAAgC,sBAAhC;AACA,IAAA,MAAM,CAAC,eAAP,GAAyB,eAAzB;AACA,IAAA,MAAM,CAAC,gBAAP,GAA0B,gBAA1B;;AAEA,QAAI,CAAC,gBAAL,EAAuB;AACrB,MAAA,IAAI,CAAC,YAAL,CAAkB,eAAlB,EAAmC,YAAnC;AACA,MAAA,IAAI,CAAC,YAAL,CAAkB,MAAlB,EAA0B,MAA1B;AACA,MAAA,IAAI,CAAC,YAAL,CAAkB,kBAAlB,EAAsC,YAAY,GAAG,iBAAiB,CAAC,sBAArB,GAA8C,iBAAiB,CAAC,eAAlH;AACD;;AAED,QAAI,MAAM,CAAC,IAAP,IAAe,OAAO,KAAK,MAAM,CAAC,IAAtC,EAA4C;AAC1C,MAAA,oBAAoB,CAAC,IAAD,EAAO,MAAM,CAAC,IAAd,CAApB;AACD;;AAED,IAAA,MAAM,CAAC,IAAP,GAAc,OAAd;AACA,IAAA,kBAAkB,CAAC,IAAD,EAAO,OAAP,CAAlB;AACA,IAAA,YAAY,CAAC,GAAb,CAAiB,IAAjB,EAAuB,MAAvB;AACA,IAAA,IAAI,CAAC,QAAL,GAAgB,UAAU,KAAK,IAAI,KAAK,SAAT,IAAsB,WAAW,CAAC,QAAZ,CAAqB,IAArB,CAAtB,IAAoD,MAAM,CAAC,sBAA3D,IAAqF,SAAS,IAAI,MAAM,CAAC,IAAP,KAAgB,YAAY,CAAC,GAAb,CAAiB,SAAjB,EAA4B,IAAnJ,CAAV,GAAqK,CAAC,CAAtK,GAA0K,CAA1L;AACA,IAAA,IAAI,CAAC,gBAAL,CAAsB,OAAtB,EAA+B,eAA/B;;AAEA,QAAI,KAAK,GAAG,SAAS,KAAT,CAAe,CAAf,EAAkB;AAC5B,UAAI,WAAW,GAAG,IAAI,CAAC,QAAL,CAAc,CAAd,CAAlB;AACA,MAAA,cAAc,CAAC,GAAf,CAAmB,WAAnB;AACA,MAAA,WAAW,CAAC,QAAZ,GAAuB,UAAU,GAAG,CAAC,CAAJ,GAAQ,CAAzC;;AAEA,UAAI,CAAC,gBAAL,EAAuB;AACrB,QAAA,WAAW,CAAC,YAAZ,CAAyB,MAAzB,EAAiC,UAAjC;AACD;;AAED,MAAA,WAAW,CAAC,mBAAZ,CAAgC,SAAhC,EAA2C,oBAAoB,CAAC,GAArB,CAAyB,WAAzB,CAA3C;AACA,MAAA,WAAW,CAAC,mBAAZ,CAAgC,OAAhC,EAAyC,kBAAkB,CAAC,GAAnB,CAAuB,WAAvB,CAAzC;;AAEA,UAAI,CAAC,YAAL,EAAmB;AACjB,QAAA,WAAW,CAAC,gBAAZ,CAA6B,SAA7B,EAAwC,aAAxC;AACA,QAAA,oBAAoB,CAAC,GAArB,CAAyB,WAAzB,EAAsC,aAAtC;AACA,QAAA,WAAW,CAAC,gBAAZ,CAA6B,OAA7B,EAAsC,WAAtC;AACA,QAAA,kBAAkB,CAAC,GAAnB,CAAuB,WAAvB,EAAoC,WAApC;AACD;;AAED,UAAI,UAAU,IAAI,MAAM,CAAC,KAAP,CAAa,CAAb,EAAgB,WAAhB,MAAiC,aAAnD,EAAkE;AAQhE,QAAA,WAAW,GAAG,WAAd,CARgE,CAQtC;;AAE1B,QAAA,WAAW,CAAC,KAAZ;AACD;AACF,KA/BD;;AAiCA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,QAAL,CAAc,MAAlC,EAA0C,CAAC,EAA3C,EAA+C;AAC7C,MAAA,KAAK,CAAC,CAAD,CAAL;AACD;AACF;;AAED,EAAA,SAAS,CAAC,OAAD,CAAT;AACA,MAAI,OAAO,GAAG;AACZ,IAAA,MAAM,EAAE,SAAS,MAAT,CAAgB,UAAhB,EAA4B;AAIlC,MAAA,SAAS,CAAC,UAAD,CAAT;AACD,KANW;AAOZ,IAAA,OAAO,EAAE,SAAS,OAAT,GAAmB;AAI1B,MAAA,oBAAoB,CAAC,IAAD,EAAO,MAAM,CAAC,IAAd,CAApB;AACA,MAAA,YAAY,CAAC,QAAD,CAAZ,CAAuB,IAAvB;AACA,MAAA,WAAW,CAAC,QAAD,CAAX,CAAsB,IAAtB;AACD;AAdW,GAAd;AAgBA,EAAA,WAAW,CAAC,GAAZ,CAAgB,IAAhB,EAAsB,OAAtB;AACA,SAAO,OAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAAS,SAAT,CAAmB,IAAnB,EAAyB,OAAzB,EAAkC;AAChC,EAAA,eAAe,CAAC,OAAD,CAAf;AACA,MAAI,WAAW,GAAG,OAAO,CAAC,IAAD,EAAO,OAAP,CAAzB;AACA,MAAI,YAAY,GAAG,SAAS,CAAC,IAAD,EAAO,OAAP,CAA5B;AACA,SAAO;AACL,IAAA,MAAM,EAAE,SAAS,MAAT,CAAgB,UAAhB,EAA4B;AAClC,MAAA,eAAe,CAAC,UAAD,CAAf;AACA,MAAA,WAAW,CAAC,MAAZ,CAAmB,UAAnB;AACA,MAAA,YAAY,CAAC,MAAb,CAAoB,UAApB;AACD,KALI;AAML,IAAA,OAAO,EAAE,SAAS,OAAT,GAAmB;AAC1B,MAAA,WAAW,CAAC,OAAZ;AACA,MAAA,YAAY,CAAC,OAAb;AACD;AATI,GAAP;AAWD;;AAED,SAAS,eAAT,CAAyB,OAAzB,EAAkC;AAClC;AACE,MAAI,KAAK,GAAG,OAAO,CAAC,KAApB;AAAA,MACI,cAAc,GAAG,OAAO,CAAC,cAD7B;AAAA,MAEI,IAAI,GAAG,OAAO,CAAC,IAFnB;AAAA,MAGI,YAAY,GAAG,OAAO,CAAC,YAH3B;AAAA,MAII,sBAAsB,GAAG,OAAO,CAAC,sBAJrC;AAAA,MAKI,eAAe,GAAG,OAAO,CAAC,eAL9B;AAAA,MAMI,uBAAuB,GAAG,OAAO,CAAC,uBANtC;AAAA,MAOI,gBAAgB,GAAG,OAAO,CAAC,gBAP/B;AAAA,MAQI,IAAI,GAAG,wBAAwB,CAAC,OAAD,EAAU,CAAC,OAAD,EAAU,gBAAV,EAA4B,MAA5B,EAAoC,cAApC,EAAoD,wBAApD,EAA8E,iBAA9E,EAAiG,yBAAjG,EAA4H,kBAA5H,CAAV,CARnC;AASF;;;AAGE,MAAI,MAAM,CAAC,IAAP,CAAY,IAAZ,EAAkB,MAAlB,GAA2B,CAA/B,EAAkC;AAChC,IAAA,OAAO,CAAC,IAAR,CAAa,qCAAb,EAAoD,IAApD;AACD;;AAED,MAAI,CAAC,KAAL,EAAY;AACV,UAAM,IAAI,KAAJ,CAAU,oCAAV,CAAN;AACD;;AAED,MAAI,iBAAiB,GAAG,KAAK,CAAC,IAAN,CAAW,UAAU,IAAV,EAAgB;AACjD,WAAO,CAAC,GAAG,cAAH,CAAkB,IAAlB,CAAuB,IAAvB,EAA6B,WAA7B,CAAR;AACD,GAFuB,CAAxB;;AAIA,MAAI,iBAAJ,EAAuB;AACrB,UAAM,IAAI,KAAJ,CAAU,YAAY,MAAZ,CAAmB,WAAnB,EAAgC,sBAAhC,EAAwD,MAAxD,CAA+D,QAAQ,CAAC,iBAAD,CAAvE,CAAV,CAAN;AACD;AACH;;AC1zEO,SAAA,aAAA,CAAA,IAAA,EAAA,UAAA,EAAyC;AAC5C,MAAIC,QAAQ,GAAG,IAAf,GAAe,EAAf;AACA,MAAIC,QAAQ,GAAG,IAAf,GAAe,EAAf;;AACA,WAAA,IAAA,CAAA,GAAA,EAAmB;AACf;AACAC,IAAAA,KAAK,CAALA,IAAAA,CAAWD,QAAQ,CAAnBC,MAAWD,EAAXC,EAAAA,OAAAA,CAAsC,UAAA,IAAA,EAAI;AAAA,aAAIC,IAAI,CAAR,MAAIA,EAAJ;AAA1CD,KAAAA;AACAF,IAAAA,QAAQ,GAAG,IAAXA,GAAW,EAAXA;AACAE,IAAAA,KAAK,CAALA,IAAAA,CAAWE,IAAI,CAAfF,QAAAA,EAAAA,OAAAA,CAAkC,UAAA,KAAA,EAAA,KAAA,EAAkB;AAChDF,MAAAA,QAAQ,CAARA,GAAAA,CAAaK,GAAG,CAAhBL,KAAgB,CAAhBA,EAAyBM,KAAK,CAA9BN,qBAAyBM,EAAzBN;AADJE,KAAAA;AAGH;;AACD,WAAA,IAAA,CAAA,GAAA,EAAmB;AACf;AACAA,IAAAA,KAAK,CAALA,IAAAA,CAAWE,IAAI,CAAfF,QAAAA,EAAAA,OAAAA,CAAkC,UAAA,KAAA,EAAA,KAAA,EAAkB;AAChD,UAAMK,EAAE,GAAGF,GAAG,CAAd,KAAc,CAAd;AACA,UAAMG,WAAW,GAAGF,KAAK,CAAzB,qBAAoBA,EAApB;AACA,UAAMG,QAAQ,GAAGT,QAAQ,CAARA,GAAAA,CAAjB,EAAiBA,CAAjB;;AACA,UAAA,QAAA,EAAc;AACX,YAAMU,UAAU,GAAGD,QAAQ,CAARA,IAAAA,GAAgBD,WAAW,CAA9C,IAAA;AACA,YAAMG,UAAU,GAAGF,QAAQ,CAARA,GAAAA,GAAeD,WAAW,CAA7C,GAAA;;AACA,YAAIE,UAAU,IAAd,UAAA,EAA8B;AAC1B,cAAME,SAAS,GAAG,CACd;AAAEC,YAAAA,SAAS,EAAA,eAAA,MAAA,CAAA,UAAA,EAAA,MAAA,EAAA,MAAA,CAAA,UAAA,EAAA,QAAA;AAAX,WADc,EAEd;AAAEA,YAAAA,SAAS,EAAE;AAAb,WAFc,CAAlB;AAIA,cAAMC,YAAY,GAAG,KAAK,CAAL,OAAA,CAAA,SAAA,EAAyB;AAACC,YAAAA,QAAQ,EAAT,UAAA;AAAuBC,YAAAA,MAAM,EAAE;AAA/B,WAAzB,CAArB;AACAf,UAAAA,QAAQ,CAARA,GAAAA,CAAAA,EAAAA,EAAAA,YAAAA;;AACAa,UAAAA,YAAY,CAAZA,QAAAA,GAAwB,YAAA;AAAA,mBAAMb,QAAQ,CAARA,QAAQ,CAARA,CAAN,EAAMA,CAAN;AAAxBa,WAAAA;;AACAA,UAAAA,YAAY,CAAZA,QAAAA,GAAwB,YAAA;AAAA,mBAAMb,QAAQ,CAARA,QAAQ,CAARA,CAAN,EAAMA,CAAN;AAAxBa,WAAAA;AACH;AACJ;AAjBJZ,KAAAA;AAmBH;;AACD,SAAO;AAACe,IAAAA,IAAI,EAAL,IAAA;AAAOC,IAAAA,IAAI,EAAJA;AAAP,GAAP;AACH;;AC9BD,IAAIC,MAAM,GAAV,IAAA;;AACO,SAAA,iDAAA,CAAA,KAAA,EAAgE;AACrEC,EAAAA,+CAAW,CAAXA,KAAW,CAAXA;AACAD,EAAAA,MAAM,GAANA,KAAAA;AACD;;AAED,IAAME,wBAAwB,GAA9B,GAAA;;AAEO,SAAA,UAAA,CAAA,OAAA,EAAA,OAAA,EAAA,UAAA,EAA2E;AAAA,MAAzBC,UAAyB,GAAA,SAAA,CAAA,MAAA,GAAA,CAAA,IAAA,SAAA,CAAA,CAAA,CAAA,KAAA,SAAA,GAAA,SAAA,CAAA,CAAA,CAAA,GAAZC,UAAY;AAC9E,MAAMC,OAAO,GAAGC,MAAM,CAAC,YAAM,CAA7B,CAAsB,CAAtB;AACA,MAAMC,OAAO,GAAGD,MAAM,CAAtB,EAAsB,CAAtB;AACAE,EAAAA,OAAO,CAAPA,KAAAA,CAAAA,kBAAAA,MAAAA,CAAgCC,IAAI,CAAJA,SAAAA,CAAAA,OAAAA,EAAAA,IAAAA,EAAhCD,CAAgCC,CAAhCD,CAAAA;AACAE,EAAAA,SAAS,CAAC,SAAA,IAAA,GAAgB;AACtB,QAAI,CAACC,OAAO,CAAZ,OAAA,EAAsB;AACtBH,IAAAA,OAAO,CAAPA,KAAAA,CAFsB,MAEtBA,EAFsB,CAAA;;AAItBD,IAAAA,OAAO,CAAPA,OAAAA,GAAkBK,aAAa,CAACD,OAAO,CAAR,OAAA,EAAkBE,OAAO,CAAPA,cAAAA,KAAAA,SAAAA,GAAuCA,OAAO,CAA9CA,cAAAA,GAAjDN,wBAA+B,CAA/BA;;AAJsB,QAAA,cAAA,GAMIS,SAAa,CAACL,OAAO,CAAR,OAAA,EAAA,cAAA,CAAA;AAAmBM,MAAAA,cAAc,EAAEf;AAAnC,KAAA,EANjB,OAMiB,CAAA,CANjB;AAAA,QAMfY,MANe,GAAA,cAAA,CAAA,MAAA;AAAA,QAMPC,OANO,GAAA,cAAA,CAAA,OAAA;;AAOtBV,IAAAA,OAAO,CAAPA,OAAAA,GAAAA,MAAAA;AACA,WAAA,OAAA;AARK,GAAA,EASN,CATHK,OASG,CATM,CAATA;AAUAA,EAAAA,SAAS,CAAC,SAAA,YAAA,GAAwB;AAC9B,QAAI,CAACC,OAAO,CAAZ,OAAA,EAAsB;AACtB,QAAM1B,IAAI,GAAG0B,OAAO,CAApB,OAAA;AACAH,IAAAA,OAAO,CAAPA,KAAAA,CAAAA,kBAAAA,EAAAA,IAAAA;;AACA,aAAA,aAAA,CAAA,CAAA,EAA0B;AACtB,UAAID,OAAO,CAAPA,OAAAA,CAAJ,IAAA,EAA0B;AACtBA,QAAAA,OAAO,CAAPA,OAAAA,CAAAA,IAAAA,CAAqB,OAAO,CAAP,KAAA,CAAA,GAAA,CAAkB,UAAA,IAAA,EAAI;AAAA,iBAAIW,IAAI,CAAR,MAAQ,CAAR;AAA3CX,SAAqB,CAArBA;AACH;;AACDH,MAAAA,UAAU,CAACe,CAAC,CAAZf,MAAU,CAAVA;AACH;;AACD,aAAA,aAAA,CAAA,CAAA,EAA0B;AACtB,UAAIG,OAAO,CAAPA,OAAAA,CAAJ,IAAA,EAA0B;AACtBA,QAAAA,OAAO,CAAPA,OAAAA,CAAAA,IAAAA,CAAqB,OAAO,CAAP,KAAA,CAAA,GAAA,CAAkB,UAAA,IAAA,EAAI;AAAA,iBAAIW,IAAI,CAAR,MAAQ,CAAR;AAA3CX,SAAqB,CAArBA;AACH;;AACDJ,MAAAA,UAAU,CAACgB,CAAC,CAAZhB,MAAU,CAAVA;AACH;;AACDlB,IAAAA,IAAI,CAAJA,gBAAAA,CAAAA,UAAAA,EAAAA,aAAAA;AACAA,IAAAA,IAAI,CAAJA,gBAAAA,CAAAA,UAAAA,EAAAA,aAAAA;AACA,WAAO,YAAM;AACTA,MAAAA,IAAI,CAAJA,mBAAAA,CAAAA,UAAAA,EAAAA,aAAAA;AACAA,MAAAA,IAAI,CAAJA,mBAAAA,CAAAA,UAAAA,EAAAA,aAAAA;AAFJ,KAAA;AAlBK,GAAA,EAsBN,CAAA,OAAA,EAAA,OAAA,EAAA,UAAA,EAtBHyB,UAsBG,CAtBM,CAATA;AAuBAU,EAAAA,eAAe,CAAC,SAAA,MAAA,GAAkB;AAC9B,QAAI,CAACT,OAAO,CAAZ,OAAA,EAAsB;AACtBH,IAAAA,OAAO,CAAPA,KAAAA,CAAAA,YAAAA,MAAAA,CAA0BC,IAAI,CAAJA,SAAAA,CAA1BD,OAA0BC,CAA1BD,CAAAA;AACAH,IAAAA,OAAO,CAAPA,OAAAA,CAAAA,cAAAA,CAAAA;AAAiBY,MAAAA,cAAc,EAAEf;AAAjCG,KAAAA,EAAAA,OAAAA,CAAAA;AAHJe,GAAe,CAAfA;AAKAA,EAAAA,eAAe,CAAC,SAAA,IAAA,GAAgB;AAC5B,QAAIb,OAAO,CAAPA,OAAAA,CAAJ,IAAA,EAA0B;AACtBA,MAAAA,OAAO,CAAPA,OAAAA,CAAAA,IAAAA,CAAqB,OAAO,CAAP,KAAA,CAAA,GAAA,CAAkB,UAAA,IAAA,EAAI;AAAA,eAAIW,IAAI,CAAR,MAAQ,CAAR;AAA3CX,OAAqB,CAArBA;AACH;AAHU,GAAA,EAIZ,CAACM,OAAO,CAJXO,KAIG,CAJY,CAAfA;AAKH","sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = o[Symbol.iterator]();\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\n// external events\nvar FINALIZE_EVENT_NAME = \"finalize\";\nvar CONSIDER_EVENT_NAME = \"consider\";\n/**\n * @typedef {Object} Info\n * @property {string} trigger\n * @property {string} id\n * @property {string} source\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\n\nfunction dispatchFinalizeEvent(el, items, info) {\n  el.dispatchEvent(new CustomEvent(FINALIZE_EVENT_NAME, {\n    detail: {\n      items: items,\n      info: info\n    }\n  }));\n}\n/**\n * Dispatches a consider event\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\n\nfunction dispatchConsiderEvent(el, items, info) {\n  el.dispatchEvent(new CustomEvent(CONSIDER_EVENT_NAME, {\n    detail: {\n      items: items,\n      info: info\n    }\n  }));\n} // internal events\n\nvar DRAGGED_ENTERED_EVENT_NAME = \"draggedEntered\";\nvar DRAGGED_LEFT_EVENT_NAME = \"draggedLeft\";\nvar DRAGGED_OVER_INDEX_EVENT_NAME = \"draggedOverIndex\";\nvar DRAGGED_LEFT_DOCUMENT_EVENT_NAME = \"draggedLeftDocument\";\nvar DRAGGED_LEFT_TYPES = {\n  LEFT_FOR_ANOTHER: \"leftForAnother\",\n  OUTSIDE_OF_ANY: \"outsideOfAny\"\n};\nfunction dispatchDraggedElementEnteredContainer(containerEl, indexObj, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_ENTERED_EVENT_NAME, {\n    detail: {\n      indexObj: indexObj,\n      draggedEl: draggedEl\n    }\n  }));\n}\nfunction dispatchDraggedElementLeftContainerForAnother(containerEl, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n    detail: {\n      draggedEl: draggedEl,\n      type: DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER\n    }\n  }));\n}\nfunction dispatchDraggedElementLeftContainerForNone(containerEl, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n    detail: {\n      draggedEl: draggedEl,\n      type: DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY\n    }\n  }));\n}\nfunction dispatchDraggedElementIsOverIndex(containerEl, indexObj, draggedEl) {\n  containerEl.dispatchEvent(new CustomEvent(DRAGGED_OVER_INDEX_EVENT_NAME, {\n    detail: {\n      indexObj: indexObj,\n      draggedEl: draggedEl\n    }\n  }));\n}\nfunction dispatchDraggedLeftDocument(draggedEl) {\n  window.dispatchEvent(new CustomEvent(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, {\n    detail: {\n      draggedEl: draggedEl\n    }\n  }));\n}\n\nvar TRIGGERS = {\n  DRAG_STARTED: \"dragStarted\",\n  DRAGGED_ENTERED: DRAGGED_ENTERED_EVENT_NAME,\n  DRAGGED_ENTERED_ANOTHER: \"dragEnteredAnother\",\n  DRAGGED_OVER_INDEX: DRAGGED_OVER_INDEX_EVENT_NAME,\n  DRAGGED_LEFT: DRAGGED_LEFT_EVENT_NAME,\n  DRAGGED_LEFT_ALL: \"draggedLeftAll\",\n  DROPPED_INTO_ZONE: \"droppedIntoZone\",\n  DROPPED_INTO_ANOTHER: \"droppedIntoAnother\",\n  DROPPED_OUTSIDE_OF_ANY: \"droppedOutsideOfAny\",\n  DRAG_STOPPED: \"dragStopped\"\n};\nvar SOURCES = {\n  POINTER: \"pointer\",\n  KEYBOARD: \"keyboard\"\n};\nvar SHADOW_ITEM_MARKER_PROPERTY_NAME = \"isDndShadowItem\";\nvar SHADOW_ELEMENT_ATTRIBUTE_NAME = \"data-is-dnd-shadow-item\";\nvar ITEM_ID_KEY = \"id\";\nvar activeDndZoneCount = 0;\nfunction incrementActiveDropZoneCount() {\n  activeDndZoneCount++;\n}\nfunction decrementActiveDropZoneCount() {\n  if (activeDndZoneCount === 0) {\n    throw new Error(\"Bug! trying to decrement when there are no dropzones\");\n  }\n\n  activeDndZoneCount--;\n}\n/**\n * Allows using another key instead of \"id\" in the items data. This is global and applies to all dndzones.\n * Has to be called when there are no rendered dndzones whatsoever.\n * @param {String} newKeyName\n * @throws {Error} if it was called when there are rendered dndzones or if it is given the wrong type (not a string)\n */\n\nfunction overrideItemIdKeyNameBeforeInitialisingDndZones(newKeyName) {\n  if (activeDndZoneCount > 0) {\n    throw new Error(\"can only override the id key before initialising any dndzone\");\n  }\n\n  if (typeof newKeyName !== \"string\") {\n    throw new Error(\"item id key has to be a string\");\n  }\n\n  printDebug(function () {\n    return [\"overriding item id key name\", newKeyName];\n  });\n  ITEM_ID_KEY = newKeyName;\n}\nvar isOnServer = typeof window === \"undefined\";\nvar printDebug = function printDebug() {};\n/**\n * Allows the user to show/hide console debug output\n * * @param {Boolean} isDebug\n */\n\nfunction setDebugMode(isDebug) {\n  if (isDebug) {\n    printDebug = function printDebug(generateMessage) {\n      var logFunction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : console.debug;\n      var message = generateMessage();\n\n      if (Array.isArray(message)) {\n        logFunction.apply(void 0, _toConsumableArray(message));\n      } else {\n        logFunction(message);\n      }\n    };\n  } else {\n    printDebug = function printDebug() {};\n  }\n}\n\n// This is based off https://stackoverflow.com/questions/27745438/how-to-compute-getboundingclientrect-without-considering-transforms/57876601#57876601\n// It removes the transforms that are potentially applied by the flip animations\nfunction adjustedBoundingRect(el) {\n  var ta;\n  var rect = el.getBoundingClientRect();\n  var style = getComputedStyle(el);\n  var tx = style.transform;\n\n  if (tx) {\n    var sx, sy, dx, dy;\n\n    if (tx.startsWith(\"matrix3d(\")) {\n      ta = tx.slice(9, -1).split(/, /);\n      sx = +ta[0];\n      sy = +ta[5];\n      dx = +ta[12];\n      dy = +ta[13];\n    } else if (tx.startsWith(\"matrix(\")) {\n      ta = tx.slice(7, -1).split(/, /);\n      sx = +ta[0];\n      sy = +ta[3];\n      dx = +ta[4];\n      dy = +ta[5];\n    } else {\n      return rect;\n    }\n\n    var to = style.transformOrigin;\n    var x = rect.x - dx - (1 - sx) * parseFloat(to);\n    var y = rect.y - dy - (1 - sy) * parseFloat(to.slice(to.indexOf(\" \") + 1));\n    var w = sx ? rect.width / sx : el.offsetWidth;\n    var h = sy ? rect.height / sy : el.offsetHeight;\n    return {\n      x: x,\n      y: y,\n      width: w,\n      height: h,\n      top: y,\n      right: x + w,\n      bottom: y + h,\n      left: x\n    };\n  } else {\n    return rect;\n  }\n}\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position and removes transforms)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\n\n\nfunction getAbsoluteRectNoTransforms(el) {\n  var rect = adjustedBoundingRect(el);\n  return {\n    top: rect.top + window.scrollY,\n    bottom: rect.bottom + window.scrollY,\n    left: rect.left + window.scrollX,\n    right: rect.right + window.scrollX\n  };\n}\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\n\nfunction getAbsoluteRect(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    top: rect.top + window.scrollY,\n    bottom: rect.bottom + window.scrollY,\n    left: rect.left + window.scrollX,\n    right: rect.right + window.scrollX\n  };\n}\n/**\n * finds the center :)\n * @typedef {Object} Rect\n * @property {number} top\n * @property {number} bottom\n * @property {number} left\n * @property {number} right\n * @param {Rect} rect\n * @return {{x: number, y: number}}\n */\n\nfunction findCenter(rect) {\n  return {\n    x: (rect.left + rect.right) / 2,\n    y: (rect.top + rect.bottom) / 2\n  };\n}\n/**\n * @typedef {Object} Point\n * @property {number} x\n * @property {number} y\n * @param {Point} pointA\n * @param {Point} pointB\n * @return {number}\n */\n\nfunction calcDistance(pointA, pointB) {\n  return Math.sqrt(Math.pow(pointA.x - pointB.x, 2) + Math.pow(pointA.y - pointB.y, 2));\n}\n/**\n * @param {Point} point\n * @param {Rect} rect\n * @return {boolean|boolean}\n */\n\n\nfunction isPointInsideRect(point, rect) {\n  return point.y <= rect.bottom && point.y >= rect.top && point.x >= rect.left && point.x <= rect.right;\n}\n/**\n * find the absolute coordinates of the center of a dom element\n * @param el {HTMLElement}\n * @returns {{x: number, y: number}}\n */\n\nfunction findCenterOfElement(el) {\n  return findCenter(getAbsoluteRect(el));\n}\n/**\n * @param {HTMLElement} elA\n * @param {HTMLElement} elB\n * @return {boolean}\n */\n\nfunction isCenterOfAInsideB(elA, elB) {\n  var centerOfA = findCenterOfElement(elA);\n  var rectOfB = getAbsoluteRectNoTransforms(elB);\n  return isPointInsideRect(centerOfA, rectOfB);\n}\n/**\n * @param {HTMLElement|ChildNode} elA\n * @param {HTMLElement|ChildNode} elB\n * @return {number}\n */\n\nfunction calcDistanceBetweenCenters(elA, elB) {\n  var centerOfA = findCenterOfElement(elA);\n  var centerOfB = findCenterOfElement(elB);\n  return calcDistance(centerOfA, centerOfB);\n}\n/**\n * @param {HTMLElement} el - the element to check\n * @returns {boolean} - true if the element in its entirety is off screen including the scrollable area (the normal dom events look at the mouse rather than the element)\n */\n\nfunction isElementOffDocument(el) {\n  var rect = getAbsoluteRect(el);\n  return rect.right < 0 || rect.left > document.documentElement.scrollWidth || rect.bottom < 0 || rect.top > document.documentElement.scrollHeight;\n}\n/**\n * If the point is inside the element returns its distances from the sides, otherwise returns null\n * @param {Point} point\n * @param {HTMLElement} el\n * @return {null|{top: number, left: number, bottom: number, right: number}}\n */\n\nfunction calcInnerDistancesBetweenPointAndSidesOfElement(point, el) {\n  var rect = getAbsoluteRect(el);\n\n  if (!isPointInsideRect(point, rect)) {\n    return null;\n  }\n\n  return {\n    top: point.y - rect.top,\n    bottom: rect.bottom - point.y,\n    left: point.x - rect.left,\n    // TODO - figure out what is so special about right (why the rect is too big)\n    right: Math.min(rect.right, document.documentElement.clientWidth) - point.x\n  };\n}\n\nvar dzToShadowIndexToRect;\n/**\n * Resets the cache that allows for smarter \"would be index\" resolution. Should be called after every drag operation\n */\n\nfunction resetIndexesCache() {\n  printDebug(function () {\n    return \"resetting indexes cache\";\n  });\n  dzToShadowIndexToRect = new Map();\n}\nresetIndexesCache();\n/**\n * Caches the coordinates of the shadow element when it's in a certain index in a certain dropzone.\n * Helpful in order to determine \"would be index\" more effectively\n * @param {HTMLElement} dz\n * @return {number} - the shadow element index\n */\n\nfunction cacheShadowRect(dz) {\n  var shadowElIndex = Array.from(dz.children).findIndex(function (child) {\n    return child.getAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME);\n  });\n\n  if (shadowElIndex >= 0) {\n    if (!dzToShadowIndexToRect.has(dz)) {\n      dzToShadowIndexToRect.set(dz, new Map());\n    }\n\n    dzToShadowIndexToRect.get(dz).set(shadowElIndex, getAbsoluteRectNoTransforms(dz.children[shadowElIndex]));\n    return shadowElIndex;\n  }\n\n  return undefined;\n}\n/**\n * @typedef {Object} Index\n * @property {number} index - the would be index\n * @property {boolean} isProximityBased - false if the element is actually over the index, true if it is not over it but this index is the closest\n */\n\n/**\n * Find the index for the dragged element in the list it is dragged over\n * @param {HTMLElement} floatingAboveEl\n * @param {HTMLElement} collectionBelowEl\n * @returns {Index|null} -  if the element is over the container the Index object otherwise null\n */\n\n\nfunction findWouldBeIndex(floatingAboveEl, collectionBelowEl) {\n  if (!isCenterOfAInsideB(floatingAboveEl, collectionBelowEl)) {\n    return null;\n  }\n\n  var children = collectionBelowEl.children; // the container is empty, floating element should be the first\n\n  if (children.length === 0) {\n    return {\n      index: 0,\n      isProximityBased: true\n    };\n  }\n\n  var shadowElIndex = cacheShadowRect(collectionBelowEl); // the search could be more efficient but keeping it simple for now\n  // a possible improvement: pass in the lastIndex it was found in and check there first, then expand from there\n\n  for (var i = 0; i < children.length; i++) {\n    if (isCenterOfAInsideB(floatingAboveEl, children[i])) {\n      var cachedShadowRect = dzToShadowIndexToRect.has(collectionBelowEl) && dzToShadowIndexToRect.get(collectionBelowEl).get(i);\n\n      if (cachedShadowRect) {\n        if (!isPointInsideRect(findCenterOfElement(floatingAboveEl), cachedShadowRect)) {\n          return {\n            index: shadowElIndex,\n            isProximityBased: false\n          };\n        }\n      }\n\n      return {\n        index: i,\n        isProximityBased: false\n      };\n    }\n  } // this can happen if there is space around the children so the floating element has\n  //entered the container but not any of the children, in this case we will find the nearest child\n\n\n  var minDistanceSoFar = Number.MAX_VALUE;\n  var indexOfMin = undefined; // we are checking all of them because we don't know whether we are dealing with a horizontal or vertical container and where the floating element entered from\n\n  for (var _i = 0; _i < children.length; _i++) {\n    var distance = calcDistanceBetweenCenters(floatingAboveEl, children[_i]);\n\n    if (distance < minDistanceSoFar) {\n      minDistanceSoFar = distance;\n      indexOfMin = _i;\n    }\n  }\n\n  return {\n    index: indexOfMin,\n    isProximityBased: true\n  };\n}\n\nvar SCROLL_ZONE_PX = 25;\nfunction makeScroller() {\n  var scrollingInfo;\n\n  function resetScrolling() {\n    scrollingInfo = {\n      directionObj: undefined,\n      stepPx: 0\n    };\n  }\n\n  resetScrolling(); // directionObj {x: 0|1|-1, y:0|1|-1} - 1 means down in y and right in x\n\n  function scrollContainer(containerEl) {\n    var _scrollingInfo = scrollingInfo,\n        directionObj = _scrollingInfo.directionObj,\n        stepPx = _scrollingInfo.stepPx;\n\n    if (directionObj) {\n      containerEl.scrollBy(directionObj.x * stepPx, directionObj.y * stepPx);\n      window.requestAnimationFrame(function () {\n        return scrollContainer(containerEl);\n      });\n    }\n  }\n\n  function calcScrollStepPx(distancePx) {\n    return SCROLL_ZONE_PX - distancePx;\n  }\n  /**\n   * If the pointer is next to the sides of the element to scroll, will trigger scrolling\n   * Can be called repeatedly with updated pointer and elementToScroll values without issues\n   * @return {boolean} - true if scrolling was needed\n   */\n\n\n  function scrollIfNeeded(pointer, elementToScroll) {\n    if (!elementToScroll) {\n      return false;\n    }\n\n    var distances = calcInnerDistancesBetweenPointAndSidesOfElement(pointer, elementToScroll);\n\n    if (distances === null) {\n      resetScrolling();\n      return false;\n    }\n\n    var isAlreadyScrolling = !!scrollingInfo.directionObj;\n    var scrollingVertically = false,\n        scrollingHorizontally = false; // vertical\n\n    if (elementToScroll.scrollHeight > elementToScroll.clientHeight) {\n      if (distances.bottom < SCROLL_ZONE_PX) {\n        scrollingVertically = true;\n        scrollingInfo.directionObj = {\n          x: 0,\n          y: 1\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.bottom);\n      } else if (distances.top < SCROLL_ZONE_PX) {\n        scrollingVertically = true;\n        scrollingInfo.directionObj = {\n          x: 0,\n          y: -1\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.top);\n      }\n\n      if (!isAlreadyScrolling && scrollingVertically) {\n        scrollContainer(elementToScroll);\n        return true;\n      }\n    } // horizontal\n\n\n    if (elementToScroll.scrollWidth > elementToScroll.clientWidth) {\n      if (distances.right < SCROLL_ZONE_PX) {\n        scrollingHorizontally = true;\n        scrollingInfo.directionObj = {\n          x: 1,\n          y: 0\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.right);\n      } else if (distances.left < SCROLL_ZONE_PX) {\n        scrollingHorizontally = true;\n        scrollingInfo.directionObj = {\n          x: -1,\n          y: 0\n        };\n        scrollingInfo.stepPx = calcScrollStepPx(distances.left);\n      }\n\n      if (!isAlreadyScrolling && scrollingHorizontally) {\n        scrollContainer(elementToScroll);\n        return true;\n      }\n    }\n\n    resetScrolling();\n    return false;\n  }\n\n  return {\n    scrollIfNeeded: scrollIfNeeded,\n    resetScrolling: resetScrolling\n  };\n}\n\n/**\n * @param {Object} object\n * @return {string}\n */\nfunction toString(object) {\n  return JSON.stringify(object, null, 2);\n}\n/**\n * Finds the depth of the given node in the DOM tree\n * @param {HTMLElement} node\n * @return {number} - the depth of the node\n */\n\nfunction getDepth(node) {\n  if (!node) {\n    throw new Error(\"cannot get depth of a falsy node\");\n  }\n\n  return _getDepth(node, 0);\n}\n\nfunction _getDepth(node) {\n  var countSoFar = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  if (!node.parentElement) {\n    return countSoFar - 1;\n  }\n\n  return _getDepth(node.parentElement, countSoFar + 1);\n}\n/**\n * A simple util to shallow compare objects quickly, it doesn't validate the arguments so pass objects in\n * @param {Object} objA\n * @param {Object} objB\n * @return {boolean} - true if objA and objB are shallow equal\n */\n\n\nfunction areObjectsShallowEqual(objA, objB) {\n  if (Object.keys(objA).length !== Object.keys(objB).length) {\n    return false;\n  }\n\n  for (var keyA in objA) {\n    if (!{}.hasOwnProperty.call(objB, keyA) || objB[keyA] !== objA[keyA]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar INTERVAL_MS = 200;\nvar TOLERANCE_PX = 10;\n\nvar _makeScroller = makeScroller(),\n    scrollIfNeeded = _makeScroller.scrollIfNeeded,\n    resetScrolling = _makeScroller.resetScrolling;\n\nvar next;\n/**\n * Tracks the dragged elements and performs the side effects when it is dragged over a drop zone (basically dispatching custom-events scrolling)\n * @param {Set<HTMLElement>} dropZones\n * @param {HTMLElement} draggedEl\n * @param {number} [intervalMs = INTERVAL_MS]\n */\n\nfunction observe(draggedEl, dropZones) {\n  var intervalMs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : INTERVAL_MS;\n  // initialization\n  var lastDropZoneFound;\n  var lastIndexFound;\n  var lastIsDraggedInADropZone = false;\n  var lastCentrePositionOfDragged; // We are sorting to make sure that in case of nested zones of the same type the one \"on top\" is considered first\n\n  var dropZonesFromDeepToShallow = Array.from(dropZones).sort(function (dz1, dz2) {\n    return getDepth(dz2) - getDepth(dz1);\n  });\n  /**\n   * The main function in this module. Tracks where everything is/ should be a take the actions\n   */\n\n  function andNow() {\n    var currentCenterOfDragged = findCenterOfElement(draggedEl);\n    var scrolled = scrollIfNeeded(currentCenterOfDragged, lastDropZoneFound); // we only want to make a new decision after the element was moved a bit to prevent flickering\n\n    if (!scrolled && lastCentrePositionOfDragged && Math.abs(lastCentrePositionOfDragged.x - currentCenterOfDragged.x) < TOLERANCE_PX && Math.abs(lastCentrePositionOfDragged.y - currentCenterOfDragged.y) < TOLERANCE_PX) {\n      next = window.setTimeout(andNow, intervalMs);\n      return;\n    }\n\n    if (isElementOffDocument(draggedEl)) {\n      printDebug(function () {\n        return \"off document\";\n      });\n      dispatchDraggedLeftDocument(draggedEl);\n      return;\n    }\n\n    lastCentrePositionOfDragged = currentCenterOfDragged; // this is a simple algorithm, potential improvement: first look at lastDropZoneFound\n\n    var isDraggedInADropZone = false;\n\n    var _iterator = _createForOfIteratorHelper(dropZonesFromDeepToShallow),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var dz = _step.value;\n        var indexObj = findWouldBeIndex(draggedEl, dz);\n\n        if (indexObj === null) {\n          // it is not inside\n          continue;\n        }\n\n        var index = indexObj.index;\n        isDraggedInADropZone = true; // the element is over a container\n\n        if (dz !== lastDropZoneFound) {\n          lastDropZoneFound && dispatchDraggedElementLeftContainerForAnother(lastDropZoneFound, draggedEl);\n          dispatchDraggedElementEnteredContainer(dz, indexObj, draggedEl);\n          lastDropZoneFound = dz;\n        } else if (index !== lastIndexFound) {\n          dispatchDraggedElementIsOverIndex(dz, indexObj, draggedEl);\n          lastIndexFound = index;\n        } // we handle looping with the 'continue' statement above\n\n\n        break;\n      } // the first time the dragged element is not in any dropzone we need to notify the last dropzone it was in\n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    if (!isDraggedInADropZone && lastIsDraggedInADropZone && lastDropZoneFound) {\n      dispatchDraggedElementLeftContainerForNone(lastDropZoneFound, draggedEl);\n      lastDropZoneFound = undefined;\n      lastIndexFound = undefined;\n      lastIsDraggedInADropZone = false;\n    } else {\n      lastIsDraggedInADropZone = true;\n    }\n\n    next = window.setTimeout(andNow, intervalMs);\n  }\n\n  andNow();\n} // assumption - we can only observe one dragged element at a time, this could be changed in the future\n\nfunction unobserve() {\n  printDebug(function () {\n    return \"unobserving\";\n  });\n  clearTimeout(next);\n  resetScrolling();\n  resetIndexesCache();\n}\n\nvar INTERVAL_MS$1 = 300;\nvar mousePosition;\n/**\n * Do not use this! it is visible for testing only until we get over the issue Cypress not triggering the mousemove listeners\n * // TODO - make private (remove export)\n * @param {{clientX: number, clientY: number}} e\n */\n\nfunction updateMousePosition(e) {\n  var c = e.touches ? e.touches[0] : e;\n  mousePosition = {\n    x: c.clientX,\n    y: c.clientY\n  };\n}\n\nvar _makeScroller$1 = makeScroller(),\n    scrollIfNeeded$1 = _makeScroller$1.scrollIfNeeded,\n    resetScrolling$1 = _makeScroller$1.resetScrolling;\n\nvar next$1;\n\nfunction loop() {\n  if (mousePosition) {\n    scrollIfNeeded$1(mousePosition, document.documentElement);\n  }\n\n  next$1 = window.setTimeout(loop, INTERVAL_MS$1);\n}\n/**\n * will start watching the mouse pointer and scroll the window if it goes next to the edges\n */\n\n\nfunction armWindowScroller() {\n  printDebug(function () {\n    return \"arming window scroller\";\n  });\n  window.addEventListener(\"mousemove\", updateMousePosition);\n  window.addEventListener(\"touchmove\", updateMousePosition);\n  loop();\n}\n/**\n * will stop watching the mouse pointer and won't scroll the window anymore\n */\n\nfunction disarmWindowScroller() {\n  printDebug(function () {\n    return \"disarming window scroller\";\n  });\n  window.removeEventListener(\"mousemove\", updateMousePosition);\n  window.removeEventListener(\"touchmove\", updateMousePosition);\n  mousePosition = undefined;\n  window.clearTimeout(next$1);\n  resetScrolling$1();\n}\n\nvar TRANSITION_DURATION_SECONDS = 0.2;\n/**\n * private helper function - creates a transition string for a property\n * @param {string} property\n * @return {string} - the transition string\n */\n\nfunction trs(property) {\n  return \"\".concat(property, \" \").concat(TRANSITION_DURATION_SECONDS, \"s ease\");\n}\n/**\n * clones the given element and applies proper styles and transitions to the dragged element\n * @param {HTMLElement} originalElement\n * @return {Node} - the cloned, styled element\n */\n\n\nfunction createDraggedElementFrom(originalElement) {\n  var rect = originalElement.getBoundingClientRect();\n  var draggedEl = originalElement.cloneNode(true);\n  copyStylesFromTo(originalElement, draggedEl);\n  draggedEl.id = \"dnd-action-dragged-el\";\n  draggedEl.style.position = \"fixed\";\n  draggedEl.style.top = \"\".concat(rect.top, \"px\");\n  draggedEl.style.left = \"\".concat(rect.left, \"px\");\n  draggedEl.style.margin = \"0\"; // we can't have relative or automatic height and width or it will break the illusion\n\n  draggedEl.style.boxSizing = \"border-box\";\n  draggedEl.style.height = \"\".concat(rect.height, \"px\");\n  draggedEl.style.width = \"\".concat(rect.width, \"px\");\n  draggedEl.style.transition = \"\".concat(trs(\"width\"), \", \").concat(trs(\"height\"), \", \").concat(trs(\"background-color\"), \", \").concat(trs(\"opacity\"), \", \").concat(trs(\"color\"), \" \"); // this is a workaround for a strange browser bug that causes the right border to disappear when all the transitions are added at the same time\n\n  window.setTimeout(function () {\n    return draggedEl.style.transition += \", \".concat(trs(\"top\"), \", \").concat(trs(\"left\"));\n  }, 0);\n  draggedEl.style.zIndex = \"9999\";\n  draggedEl.style.cursor = \"grabbing\";\n  return draggedEl;\n}\n/**\n * styles the dragged element to a 'dropped' state\n * @param {HTMLElement} draggedEl\n */\n\nfunction moveDraggedElementToWasDroppedState(draggedEl) {\n  draggedEl.style.cursor = \"grab\";\n}\n/**\n * Morphs the dragged element style, maintains the mouse pointer within the element\n * @param {HTMLElement} draggedEl\n * @param {HTMLElement} copyFromEl - the element the dragged element should look like, typically the shadow element\n * @param {number} currentMouseX\n * @param {number} currentMouseY\n * @param {function} transformDraggedElement - function to transform the dragged element, does nothing by default.\n */\n\nfunction morphDraggedElementToBeLike(draggedEl, copyFromEl, currentMouseX, currentMouseY, transformDraggedElement) {\n  var newRect = copyFromEl.getBoundingClientRect();\n  var draggedElRect = draggedEl.getBoundingClientRect();\n  var widthChange = newRect.width - draggedElRect.width;\n  var heightChange = newRect.height - draggedElRect.height;\n\n  if (widthChange || heightChange) {\n    var relativeDistanceOfMousePointerFromDraggedSides = {\n      left: (currentMouseX - draggedElRect.left) / draggedElRect.width,\n      top: (currentMouseY - draggedElRect.top) / draggedElRect.height\n    };\n    draggedEl.style.height = \"\".concat(newRect.height, \"px\");\n    draggedEl.style.width = \"\".concat(newRect.width, \"px\");\n    draggedEl.style.left = \"\".concat(parseFloat(draggedEl.style.left) - relativeDistanceOfMousePointerFromDraggedSides.left * widthChange, \"px\");\n    draggedEl.style.top = \"\".concat(parseFloat(draggedEl.style.top) - relativeDistanceOfMousePointerFromDraggedSides.top * heightChange, \"px\");\n  } /// other properties\n\n\n  copyStylesFromTo(copyFromEl, draggedEl);\n  transformDraggedElement();\n}\n/**\n * @param {HTMLElement} copyFromEl\n * @param {HTMLElement} copyToEl\n */\n\nfunction copyStylesFromTo(copyFromEl, copyToEl) {\n  var computedStyle = window.getComputedStyle(copyFromEl);\n  Array.from(computedStyle).filter(function (s) {\n    return s.startsWith(\"background\") || s.startsWith(\"padding\") || s.startsWith(\"font\") || s.startsWith(\"text\") || s.startsWith(\"align\") || s.startsWith(\"justify\") || s.startsWith(\"display\") || s.startsWith(\"flex\") || s.startsWith(\"border\") || s === \"opacity\" || s === \"color\" || s === \"list-style-type\";\n  }).forEach(function (s) {\n    return copyToEl.style.setProperty(s, computedStyle.getPropertyValue(s), computedStyle.getPropertyPriority(s));\n  });\n}\n/**\n * makes the element compatible with being draggable\n * @param {HTMLElement} draggableEl\n * @param {boolean} dragDisabled\n */\n\n\nfunction styleDraggable(draggableEl, dragDisabled) {\n  draggableEl.draggable = false;\n\n  draggableEl.ondragstart = function () {\n    return false;\n  };\n\n  if (!dragDisabled) {\n    draggableEl.style.userSelect = \"none\";\n    draggableEl.style.WebkitUserSelect = \"none\";\n    draggableEl.style.cursor = \"grab\";\n  } else {\n    draggableEl.style.userSelect = \"\";\n    draggableEl.style.WebkitUserSelect = \"\";\n    draggableEl.style.cursor = \"\";\n  }\n}\n/**\n * Hides the provided element so that it can stay in the dom without interrupting\n * @param {HTMLElement} dragTarget\n */\n\nfunction hideOriginalDragTarget(dragTarget) {\n  dragTarget.style.display = \"none\";\n  dragTarget.style.position = \"fixed\";\n  dragTarget.style.zIndex = \"-5\";\n}\n/**\n * styles the shadow element\n * @param {HTMLElement} shadowEl\n */\n\nfunction decorateShadowEl(shadowEl) {\n  shadowEl.style.visibility = \"hidden\";\n  shadowEl.setAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME, \"true\");\n}\n/**\n * undo the styles the shadow element\n * @param {HTMLElement} shadowEl\n */\n\nfunction unDecorateShadowElement(shadowEl) {\n  shadowEl.style.visibility = \"\";\n  shadowEl.removeAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME);\n}\n/**\n * will mark the given dropzones as visually active\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object (so the styles can be removed)\n */\n\nfunction styleActiveDropZones(dropZones) {\n  var getStyles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  dropZones.forEach(function (dz) {\n    var styles = getStyles(dz);\n    Object.keys(styles).forEach(function (style) {\n      dz.style[style] = styles[style];\n    });\n  });\n}\n/**\n * will remove the 'active' styling from given dropzones\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object\n */\n\nfunction styleInactiveDropZones(dropZones) {\n  var getStyles = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  dropZones.forEach(function (dz) {\n    var styles = getStyles(dz);\n    Object.keys(styles).forEach(function (style) {\n      dz.style[style] = \"\";\n    });\n  });\n}\n/**\n * will prevent the provided element from shrinking by setting its minWidth and minHeight to the current width and height values\n * @param {HTMLElement} el\n * @return {function(): void} - run this function to undo the operation and restore the original values\n */\n\nfunction preventShrinking(el) {\n  var originalMinHeight = el.style.minHeight;\n  el.style.minHeight = window.getComputedStyle(el).getPropertyValue(\"height\");\n  var originalMinWidth = el.style.minWidth;\n  el.style.minWidth = window.getComputedStyle(el).getPropertyValue(\"width\");\n  return function undo() {\n    el.style.minHeight = originalMinHeight;\n    el.style.minWidth = originalMinWidth;\n  };\n}\n\nvar DEFAULT_DROP_ZONE_TYPE = \"--any--\";\nvar MIN_OBSERVATION_INTERVAL_MS = 100;\nvar MIN_MOVEMENT_BEFORE_DRAG_START_PX = 3;\nvar DEFAULT_DROP_TARGET_STYLE = {\n  outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\nvar originalDragTarget;\nvar draggedEl;\nvar draggedElData;\nvar draggedElType;\nvar originDropZone;\nvar originIndex;\nvar shadowElData;\nvar shadowElDropZone;\nvar dragStartMousePosition;\nvar currentMousePosition;\nvar isWorkingOnPreviousDrag = false;\nvar finalizingPreviousDrag = false;\nvar unlockOriginDzMinDimensions;\nvar isDraggedOutsideOfAnyDz = false; // a map from type to a set of drop-zones\n\nvar typeToDropZones = new Map(); // important - this is needed because otherwise the config that would be used for everyone is the config of the element that created the event listeners\n\nvar dzToConfig = new Map(); // this is needed in order to be able to cleanup old listeners and avoid stale closures issues (as the listener is defined within each zone)\n\nvar elToMouseDownListener = new WeakMap();\n/* drop-zones registration management */\n\nfunction registerDropZone(dropZoneEl, type) {\n  printDebug(function () {\n    return \"registering drop-zone if absent\";\n  });\n\n  if (!typeToDropZones.has(type)) {\n    typeToDropZones.set(type, new Set());\n  }\n\n  if (!typeToDropZones.get(type).has(dropZoneEl)) {\n    typeToDropZones.get(type).add(dropZoneEl);\n    incrementActiveDropZoneCount();\n  }\n}\n\nfunction unregisterDropZone(dropZoneEl, type) {\n  typeToDropZones.get(type)[\"delete\"](dropZoneEl);\n  decrementActiveDropZoneCount();\n\n  if (typeToDropZones.get(type).size === 0) {\n    typeToDropZones[\"delete\"](type);\n  }\n}\n/* functions to manage observing the dragged element and trigger custom drag-events */\n\n\nfunction watchDraggedElement() {\n  printDebug(function () {\n    return \"watching dragged element\";\n  });\n  armWindowScroller();\n  var dropZones = typeToDropZones.get(draggedElType);\n\n  var _iterator = _createForOfIteratorHelper(dropZones),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var dz = _step.value;\n      dz.addEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n      dz.addEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n      dz.addEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  window.addEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop); // it is important that we don't have an interval that is faster than the flip duration because it can cause elements to jump bach and forth\n\n  var observationIntervalMs = Math.max.apply(Math, [MIN_OBSERVATION_INTERVAL_MS].concat(_toConsumableArray(Array.from(dropZones.keys()).map(function (dz) {\n    return dzToConfig.get(dz).dropAnimationDurationMs;\n  }))));\n  observe(draggedEl, dropZones, observationIntervalMs * 1.07);\n}\n\nfunction unWatchDraggedElement() {\n  printDebug(function () {\n    return \"unwatching dragged element\";\n  });\n  disarmWindowScroller();\n  var dropZones = typeToDropZones.get(draggedElType);\n\n  var _iterator2 = _createForOfIteratorHelper(dropZones),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var dz = _step2.value;\n      dz.removeEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n      dz.removeEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n      dz.removeEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  window.removeEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop);\n  unobserve();\n}\n/* custom drag-events handlers */\n\n\nfunction handleDraggedEntered(e) {\n  printDebug(function () {\n    return [\"dragged entered\", e.currentTarget, e.detail];\n  });\n  isDraggedOutsideOfAnyDz = false;\n\n  var _dzToConfig$get = dzToConfig.get(e.currentTarget),\n      items = _dzToConfig$get.items,\n      dropFromOthersDisabled = _dzToConfig$get.dropFromOthersDisabled;\n\n  if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n    printDebug(function () {\n      return \"drop is currently disabled\";\n    });\n    return;\n  } // this deals with another race condition. in rare occasions (super rapid operations) the list hasn't updated yet\n\n\n  items = items.filter(function (i) {\n    return i[ITEM_ID_KEY] !== shadowElData[ITEM_ID_KEY];\n  });\n  printDebug(function () {\n    return \"dragged entered items \".concat(toString(items));\n  });\n\n  if (originDropZone !== e.currentTarget) {\n    var originZoneItems = dzToConfig.get(originDropZone).items;\n    var newOriginZoneItems = originZoneItems.filter(function (item) {\n      return !item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n    });\n    dispatchConsiderEvent(originDropZone, newOriginZoneItems, {\n      trigger: TRIGGERS.DRAGGED_ENTERED_ANOTHER,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    });\n  }\n\n  var _e$detail$indexObj = e.detail.indexObj,\n      index = _e$detail$indexObj.index,\n      isProximityBased = _e$detail$indexObj.isProximityBased;\n  var shadowElIdx = isProximityBased && index === e.currentTarget.children.length - 1 ? index + 1 : index;\n  shadowElDropZone = e.currentTarget;\n  items.splice(shadowElIdx, 0, shadowElData);\n  dispatchConsiderEvent(e.currentTarget, items, {\n    trigger: TRIGGERS.DRAGGED_ENTERED,\n    id: draggedElData[ITEM_ID_KEY],\n    source: SOURCES.POINTER\n  });\n}\n\nfunction handleDraggedLeft(e) {\n  printDebug(function () {\n    return [\"dragged left\", e.currentTarget, e.detail];\n  });\n\n  var _dzToConfig$get2 = dzToConfig.get(e.currentTarget),\n      items = _dzToConfig$get2.items,\n      dropFromOthersDisabled = _dzToConfig$get2.dropFromOthersDisabled;\n\n  if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n    printDebug(function () {\n      return \"drop is currently disabled\";\n    });\n    return;\n  }\n\n  var shadowElIdx = items.findIndex(function (item) {\n    return !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n  });\n  var shadowItem = items.splice(shadowElIdx, 1)[0];\n  shadowElDropZone = undefined;\n\n  if (e.detail.type === DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY) {\n    isDraggedOutsideOfAnyDz = true;\n    shadowElDropZone = originDropZone;\n    var originZoneItems = dzToConfig.get(originDropZone).items;\n    originZoneItems.splice(originIndex, 0, shadowItem);\n    dispatchConsiderEvent(originDropZone, originZoneItems, {\n      trigger: TRIGGERS.DRAGGED_LEFT_ALL,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    });\n  }\n\n  dispatchConsiderEvent(e.currentTarget, items, {\n    trigger: TRIGGERS.DRAGGED_LEFT,\n    id: draggedElData[ITEM_ID_KEY],\n    source: SOURCES.POINTER\n  });\n}\n\nfunction handleDraggedIsOverIndex(e) {\n  printDebug(function () {\n    return [\"dragged is over index\", e.currentTarget, e.detail];\n  });\n  isDraggedOutsideOfAnyDz = false;\n\n  var _dzToConfig$get3 = dzToConfig.get(e.currentTarget),\n      items = _dzToConfig$get3.items,\n      dropFromOthersDisabled = _dzToConfig$get3.dropFromOthersDisabled;\n\n  if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n    printDebug(function () {\n      return \"drop is currently disabled\";\n    });\n    return;\n  }\n\n  var index = e.detail.indexObj.index;\n  var shadowElIdx = items.findIndex(function (item) {\n    return !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n  });\n  items.splice(shadowElIdx, 1);\n  items.splice(index, 0, shadowElData);\n  dispatchConsiderEvent(e.currentTarget, items, {\n    trigger: TRIGGERS.DRAGGED_OVER_INDEX,\n    id: draggedElData[ITEM_ID_KEY],\n    source: SOURCES.POINTER\n  });\n} // Global mouse/touch-events handlers\n\n\nfunction handleMouseMove(e) {\n  e.preventDefault();\n  var c = e.touches ? e.touches[0] : e;\n  currentMousePosition = {\n    x: c.clientX,\n    y: c.clientY\n  };\n  draggedEl.style.transform = \"translate3d(\".concat(currentMousePosition.x - dragStartMousePosition.x, \"px, \").concat(currentMousePosition.y - dragStartMousePosition.y, \"px, 0)\");\n}\n\nfunction handleDrop() {\n  printDebug(function () {\n    return \"dropped\";\n  });\n  finalizingPreviousDrag = true; // cleanup\n\n  window.removeEventListener(\"mousemove\", handleMouseMove);\n  window.removeEventListener(\"touchmove\", handleMouseMove);\n  window.removeEventListener(\"mouseup\", handleDrop);\n  window.removeEventListener(\"touchend\", handleDrop);\n  unWatchDraggedElement();\n  moveDraggedElementToWasDroppedState(draggedEl); // it was dropped in a drop-zone\n\n  printDebug(function () {\n    return [\"dropped in dz\", shadowElDropZone];\n  });\n\n  var _dzToConfig$get4 = dzToConfig.get(shadowElDropZone),\n      items = _dzToConfig$get4.items,\n      type = _dzToConfig$get4.type;\n\n  styleInactiveDropZones(typeToDropZones.get(type), function (dz) {\n    return dzToConfig.get(dz).dropTargetStyle;\n  });\n  var shadowElIdx = items.findIndex(function (item) {\n    return !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME];\n  }); // the handler might remove the shadow element, ex: dragula like copy on drag\n\n  if (shadowElIdx === -1) shadowElIdx = originIndex;\n  items = items.map(function (item) {\n    return item[SHADOW_ITEM_MARKER_PROPERTY_NAME] ? draggedElData : item;\n  });\n\n  function finalizeWithinZone() {\n    unlockOriginDzMinDimensions();\n    dispatchFinalizeEvent(shadowElDropZone, items, {\n      trigger: isDraggedOutsideOfAnyDz ? TRIGGERS.DROPPED_OUTSIDE_OF_ANY : TRIGGERS.DROPPED_INTO_ZONE,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    });\n\n    if (shadowElDropZone !== originDropZone) {\n      // letting the origin drop zone know the element was permanently taken away\n      dispatchFinalizeEvent(originDropZone, dzToConfig.get(originDropZone).items, {\n        trigger: TRIGGERS.DROPPED_INTO_ANOTHER,\n        id: draggedElData[ITEM_ID_KEY],\n        source: SOURCES.POINTER\n      });\n    }\n\n    unDecorateShadowElement(shadowElDropZone.children[shadowElIdx]);\n    cleanupPostDrop();\n  }\n\n  animateDraggedToFinalPosition(shadowElIdx, finalizeWithinZone);\n} // helper function for handleDrop\n\n\nfunction animateDraggedToFinalPosition(shadowElIdx, callback) {\n  var shadowElRect = shadowElDropZone.children[shadowElIdx].getBoundingClientRect();\n  var newTransform = {\n    x: shadowElRect.left - parseFloat(draggedEl.style.left),\n    y: shadowElRect.top - parseFloat(draggedEl.style.top)\n  };\n\n  var _dzToConfig$get5 = dzToConfig.get(shadowElDropZone),\n      dropAnimationDurationMs = _dzToConfig$get5.dropAnimationDurationMs;\n\n  var transition = \"transform \".concat(dropAnimationDurationMs, \"ms ease\");\n  draggedEl.style.transition = draggedEl.style.transition ? draggedEl.style.transition + \",\" + transition : transition;\n  draggedEl.style.transform = \"translate3d(\".concat(newTransform.x, \"px, \").concat(newTransform.y, \"px, 0)\");\n  window.setTimeout(callback, dropAnimationDurationMs);\n}\n/* cleanup */\n\n\nfunction cleanupPostDrop() {\n  draggedEl.remove();\n  originalDragTarget.remove();\n  draggedEl = undefined;\n  originalDragTarget = undefined;\n  draggedElData = undefined;\n  draggedElType = undefined;\n  originDropZone = undefined;\n  originIndex = undefined;\n  shadowElData = undefined;\n  shadowElDropZone = undefined;\n  dragStartMousePosition = undefined;\n  currentMousePosition = undefined;\n  isWorkingOnPreviousDrag = false;\n  finalizingPreviousDrag = false;\n  unlockOriginDzMinDimensions = undefined;\n  isDraggedOutsideOfAnyDz = false;\n}\n\nfunction dndzone(node, options) {\n  var config = {\n    items: undefined,\n    type: undefined,\n    flipDurationMs: 0,\n    dragDisabled: false,\n    dropFromOthersDisabled: false,\n    dropTargetStyle: DEFAULT_DROP_TARGET_STYLE,\n    transformDraggedElement: function transformDraggedElement() {}\n  };\n  printDebug(function () {\n    return [\"dndzone good to go options: \".concat(toString(options), \", config: \").concat(toString(config)), {\n      node: node\n    }];\n  });\n  var elToIdx = new Map();\n\n  function addMaybeListeners() {\n    window.addEventListener(\"mousemove\", handleMouseMoveMaybeDragStart, {\n      passive: false\n    });\n    window.addEventListener(\"touchmove\", handleMouseMoveMaybeDragStart, {\n      passive: false,\n      capture: false\n    });\n    window.addEventListener(\"mouseup\", handleFalseAlarm, {\n      passive: false\n    });\n    window.addEventListener(\"touchend\", handleFalseAlarm, {\n      passive: false\n    });\n  }\n\n  function removeMaybeListeners() {\n    window.removeEventListener(\"mousemove\", handleMouseMoveMaybeDragStart);\n    window.removeEventListener(\"touchmove\", handleMouseMoveMaybeDragStart);\n    window.removeEventListener(\"mouseup\", handleFalseAlarm);\n    window.removeEventListener(\"touchend\", handleFalseAlarm);\n  }\n\n  function handleFalseAlarm() {\n    removeMaybeListeners();\n    originalDragTarget = undefined;\n    dragStartMousePosition = undefined;\n    currentMousePosition = undefined;\n  }\n\n  function handleMouseMoveMaybeDragStart(e) {\n    e.preventDefault();\n    var c = e.touches ? e.touches[0] : e;\n    currentMousePosition = {\n      x: c.clientX,\n      y: c.clientY\n    };\n\n    if (Math.abs(currentMousePosition.x - dragStartMousePosition.x) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX || Math.abs(currentMousePosition.y - dragStartMousePosition.y) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX) {\n      removeMaybeListeners();\n      handleDragStart();\n    }\n  }\n\n  function handleMouseDown(e) {\n    // on safari clicking on a select element doesn't fire mouseup at the end of the click and in general this makes more sense\n    if (e.target !== e.currentTarget && (e.target.value !== undefined || e.target.isContentEditable)) {\n      printDebug(function () {\n        return \"won't initiate drag on a nested input element\";\n      });\n      return;\n    } // prevents responding to any button but left click which equals 0 (which is falsy)\n\n\n    if (e.button) {\n      printDebug(function () {\n        return \"ignoring none left click button: \".concat(e.button);\n      });\n      return;\n    }\n\n    if (isWorkingOnPreviousDrag) {\n      printDebug(function () {\n        return \"cannot start a new drag before finalizing previous one\";\n      });\n      return;\n    }\n\n    e.stopPropagation();\n    var c = e.touches ? e.touches[0] : e;\n    dragStartMousePosition = {\n      x: c.clientX,\n      y: c.clientY\n    };\n    currentMousePosition = _objectSpread2({}, dragStartMousePosition);\n    originalDragTarget = e.currentTarget;\n    addMaybeListeners();\n  }\n\n  function handleDragStart() {\n    printDebug(function () {\n      return [\"drag start config: \".concat(toString(config)), originalDragTarget];\n    });\n    isWorkingOnPreviousDrag = true; // initialising globals\n\n    var currentIdx = elToIdx.get(originalDragTarget);\n    originIndex = currentIdx;\n    originDropZone = originalDragTarget.parentElement;\n    var items = config.items,\n        type = config.type;\n    draggedElData = _objectSpread2({}, items[currentIdx]);\n    draggedElType = type;\n    shadowElData = _objectSpread2(_objectSpread2({}, draggedElData), {}, _defineProperty({}, SHADOW_ITEM_MARKER_PROPERTY_NAME, true)); // creating the draggable element\n\n    draggedEl = createDraggedElementFrom(originalDragTarget); // We will keep the original dom node in the dom because touch events keep firing on it, we want to re-add it after the framework removes it\n\n    function keepOriginalElementInDom() {\n      var itemsNow = config.items;\n\n      if (!draggedEl.parentElement && (!itemsNow[originIndex] || draggedElData[ITEM_ID_KEY] !== itemsNow[originIndex][ITEM_ID_KEY])) {\n        document.body.appendChild(draggedEl); // to prevent the outline from disappearing\n\n        draggedEl.focus();\n        watchDraggedElement();\n        hideOriginalDragTarget(originalDragTarget);\n        document.body.appendChild(originalDragTarget);\n      } else {\n        window.requestAnimationFrame(keepOriginalElementInDom);\n      }\n    }\n\n    window.requestAnimationFrame(keepOriginalElementInDom);\n    styleActiveDropZones(Array.from(typeToDropZones.get(config.type)).filter(function (dz) {\n      return dz === originDropZone || !dzToConfig.get(dz).dropFromOthersDisabled;\n    }), function (dz) {\n      return dzToConfig.get(dz).dropTargetStyle;\n    }); // removing the original element by removing its data entry\n\n    items.splice(currentIdx, 1);\n    unlockOriginDzMinDimensions = preventShrinking(originDropZone);\n    dispatchConsiderEvent(originDropZone, items, {\n      trigger: TRIGGERS.DRAG_STARTED,\n      id: draggedElData[ITEM_ID_KEY],\n      source: SOURCES.POINTER\n    }); // handing over to global handlers - starting to watch the element\n\n    window.addEventListener(\"mousemove\", handleMouseMove, {\n      passive: false\n    });\n    window.addEventListener(\"touchmove\", handleMouseMove, {\n      passive: false,\n      capture: false\n    });\n    window.addEventListener(\"mouseup\", handleDrop, {\n      passive: false\n    });\n    window.addEventListener(\"touchend\", handleDrop, {\n      passive: false\n    });\n  }\n\n  function configure(_ref) {\n    var _ref$items = _ref.items,\n        items = _ref$items === void 0 ? undefined : _ref$items,\n        _ref$flipDurationMs = _ref.flipDurationMs,\n        dropAnimationDurationMs = _ref$flipDurationMs === void 0 ? 0 : _ref$flipDurationMs,\n        _ref$type = _ref.type,\n        newType = _ref$type === void 0 ? DEFAULT_DROP_ZONE_TYPE : _ref$type,\n        _ref$dragDisabled = _ref.dragDisabled,\n        dragDisabled = _ref$dragDisabled === void 0 ? false : _ref$dragDisabled,\n        _ref$dropFromOthersDi = _ref.dropFromOthersDisabled,\n        dropFromOthersDisabled = _ref$dropFromOthersDi === void 0 ? false : _ref$dropFromOthersDi,\n        _ref$dropTargetStyle = _ref.dropTargetStyle,\n        dropTargetStyle = _ref$dropTargetStyle === void 0 ? DEFAULT_DROP_TARGET_STYLE : _ref$dropTargetStyle,\n        _ref$transformDragged = _ref.transformDraggedElement,\n        transformDraggedElement = _ref$transformDragged === void 0 ? function () {} : _ref$transformDragged;\n    config.dropAnimationDurationMs = dropAnimationDurationMs;\n\n    if (config.type && newType !== config.type) {\n      unregisterDropZone(node, config.type);\n    }\n\n    config.type = newType;\n    registerDropZone(node, newType);\n    config.items = _toConsumableArray(items);\n    config.dragDisabled = dragDisabled;\n    config.transformDraggedElement = transformDraggedElement; // realtime update for dropTargetStyle\n\n    if (isWorkingOnPreviousDrag && !finalizingPreviousDrag && !areObjectsShallowEqual(dropTargetStyle, config.dropTargetStyle)) {\n      styleInactiveDropZones([node], function () {\n        return config.dropTargetStyle;\n      });\n      styleActiveDropZones([node], function () {\n        return dropTargetStyle;\n      });\n    }\n\n    config.dropTargetStyle = dropTargetStyle; // realtime update for dropFromOthersDisabled\n\n    if (isWorkingOnPreviousDrag && config.dropFromOthersDisabled !== dropFromOthersDisabled) {\n      if (dropFromOthersDisabled) {\n        styleInactiveDropZones([node], function (dz) {\n          return dzToConfig.get(dz).dropTargetStyle;\n        });\n      } else {\n        styleActiveDropZones([node], function (dz) {\n          return dzToConfig.get(dz).dropTargetStyle;\n        });\n      }\n    }\n\n    config.dropFromOthersDisabled = dropFromOthersDisabled;\n    dzToConfig.set(node, config);\n\n    var _loop = function _loop(idx) {\n      var draggableEl = node.children[idx];\n      styleDraggable(draggableEl, dragDisabled);\n\n      if (config.items[idx][SHADOW_ITEM_MARKER_PROPERTY_NAME]) {\n        morphDraggedElementToBeLike(draggedEl, draggableEl, currentMousePosition.x, currentMousePosition.y, function () {\n          return config.transformDraggedElement(draggedEl, draggedElData, idx);\n        });\n        decorateShadowEl(draggableEl);\n        return \"continue\";\n      }\n\n      draggableEl.removeEventListener(\"mousedown\", elToMouseDownListener.get(draggableEl));\n      draggableEl.removeEventListener(\"touchstart\", elToMouseDownListener.get(draggableEl));\n\n      if (!dragDisabled) {\n        draggableEl.addEventListener(\"mousedown\", handleMouseDown);\n        draggableEl.addEventListener(\"touchstart\", handleMouseDown);\n        elToMouseDownListener.set(draggableEl, handleMouseDown);\n      } // updating the idx\n\n\n      elToIdx.set(draggableEl, idx);\n    };\n\n    for (var idx = 0; idx < node.children.length; idx++) {\n      var _ret = _loop(idx);\n\n      if (_ret === \"continue\") continue;\n    }\n  }\n\n  configure(options);\n  return {\n    update: function update(newOptions) {\n      printDebug(function () {\n        return \"pointer dndzone will update newOptions: \".concat(toString(newOptions));\n      });\n      configure(newOptions);\n    },\n    destroy: function destroy() {\n      printDebug(function () {\n        return \"pointer dndzone will destroy\";\n      });\n      unregisterDropZone(node, config.type);\n      dzToConfig[\"delete\"](node);\n    }\n  };\n}\n\nvar _ID_TO_INSTRUCTION;\nvar INSTRUCTION_IDs = {\n  DND_ZONE_ACTIVE: \"dnd-zone-active\",\n  DND_ZONE_DRAG_DISABLED: \"dnd-zone-drag-disabled\"\n};\nvar ID_TO_INSTRUCTION = (_ID_TO_INSTRUCTION = {}, _defineProperty(_ID_TO_INSTRUCTION, INSTRUCTION_IDs.DND_ZONE_ACTIVE, \"Tab to one the items and press space-bar or enter to start dragging it\"), _defineProperty(_ID_TO_INSTRUCTION, INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED, \"This is a disabled drag and drop list\"), _ID_TO_INSTRUCTION);\nvar ALERT_DIV_ID = \"dnd-action-aria-alert\";\nvar alertsDiv;\n/**\n * Initializes the static aria instructions so they can be attached to zones\n * @return {{DND_ZONE_ACTIVE: string, DND_ZONE_DRAG_DISABLED: string} | null} - the IDs for static aria instruction (to be used via aria-describedby) or null on the server\n */\n\nfunction initAria() {\n  if (isOnServer) return null;\n  window.addEventListener(\"DOMContentLoaded\", function () {\n    // setting the dynamic alerts\n    alertsDiv = document.createElement(\"div\");\n\n    (function initAlertsDiv() {\n      alertsDiv.id = ALERT_DIV_ID; // tab index -1 makes the alert be read twice on chrome for some reason\n      //alertsDiv.tabIndex = -1;\n\n      alertsDiv.style.position = \"fixed\";\n      alertsDiv.style.bottom = \"0\";\n      alertsDiv.style.left = \"0\";\n      alertsDiv.style.zIndex = \"-5\";\n      alertsDiv.style.opacity = \"0\";\n      alertsDiv.style.height = \"0\";\n      alertsDiv.style.width = \"0\";\n      alertsDiv.setAttribute(\"role\", \"alert\");\n    })();\n\n    document.body.prepend(alertsDiv); // setting the instructions\n\n    Object.entries(ID_TO_INSTRUCTION).forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          id = _ref2[0],\n          txt = _ref2[1];\n\n      return document.body.prepend(instructionToHiddenDiv(id, txt));\n    });\n  });\n  return _objectSpread2({}, INSTRUCTION_IDs);\n}\n\nfunction instructionToHiddenDiv(id, txt) {\n  var div = document.createElement(\"div\");\n  div.id = id;\n  div.innerHTML = \"<p>\".concat(txt, \"</p>\");\n  div.style.display = \"none\";\n  div.style.position = \"fixed\";\n  div.style.zIndex = \"-5\";\n  return div;\n}\n/**\n * Will make the screen reader alert the provided text to the user\n * @param {string} txt\n */\n\n\nfunction alertToScreenReader(txt) {\n  alertsDiv.innerHTML = \"\";\n  var alertText = document.createTextNode(txt);\n  alertsDiv.appendChild(alertText); // this is needed for Safari\n\n  alertsDiv.style.display = \"none\";\n  alertsDiv.style.display = \"inline\";\n}\n\nvar DEFAULT_DROP_ZONE_TYPE$1 = \"--any--\";\nvar DEFAULT_DROP_TARGET_STYLE$1 = {\n  outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\nvar isDragging = false;\nvar draggedItemType;\nvar focusedDz;\nvar focusedDzLabel = \"\";\nvar focusedItem;\nvar focusedItemId;\nvar focusedItemLabel = \"\";\nvar allDragTargets = new WeakSet();\nvar elToKeyDownListeners = new WeakMap();\nvar elToFocusListeners = new WeakMap();\nvar dzToHandles = new Map();\nvar dzToConfig$1 = new Map();\nvar typeToDropZones$1 = new Map();\n/* TODO (potentially)\n * what's the deal with the black border of voice-reader not following focus?\n * maybe keep focus on the last dragged item upon drop?\n */\n\nvar INSTRUCTION_IDs$1 = initAria();\n/* drop-zones registration management */\n\nfunction registerDropZone$1(dropZoneEl, type) {\n  printDebug(function () {\n    return \"registering drop-zone if absent\";\n  });\n\n  if (typeToDropZones$1.size === 0) {\n    printDebug(function () {\n      return \"adding global keydown and click handlers\";\n    });\n    window.addEventListener(\"keydown\", globalKeyDownHandler);\n    window.addEventListener(\"click\", globalClickHandler);\n  }\n\n  if (!typeToDropZones$1.has(type)) {\n    typeToDropZones$1.set(type, new Set());\n  }\n\n  if (!typeToDropZones$1.get(type).has(dropZoneEl)) {\n    typeToDropZones$1.get(type).add(dropZoneEl);\n    incrementActiveDropZoneCount();\n  }\n}\n\nfunction unregisterDropZone$1(dropZoneEl, type) {\n  printDebug(function () {\n    return \"unregistering drop-zone\";\n  });\n\n  if (focusedDz === dropZoneEl) {\n    handleDrop$1();\n  }\n\n  typeToDropZones$1.get(type)[\"delete\"](dropZoneEl);\n  decrementActiveDropZoneCount();\n\n  if (typeToDropZones$1.get(type).size === 0) {\n    typeToDropZones$1[\"delete\"](type);\n  }\n\n  if (typeToDropZones$1.size === 0) {\n    printDebug(function () {\n      return \"removing global keydown and click handlers\";\n    });\n    window.removeEventListener(\"keydown\", globalKeyDownHandler);\n    window.removeEventListener(\"click\", globalClickHandler);\n  }\n}\n\nfunction globalKeyDownHandler(e) {\n  if (!isDragging) return;\n\n  switch (e.key) {\n    case \"Escape\":\n      {\n        handleDrop$1();\n        break;\n      }\n  }\n}\n\nfunction globalClickHandler() {\n  if (!isDragging) return;\n\n  if (!allDragTargets.has(document.activeElement)) {\n    printDebug(function () {\n      return \"clicked outside of any draggable\";\n    });\n    handleDrop$1();\n  }\n}\n\nfunction handleZoneFocus(e) {\n  printDebug(function () {\n    return \"zone focus\";\n  });\n  if (!isDragging) return;\n  var newlyFocusedDz = e.currentTarget;\n  if (newlyFocusedDz === focusedDz) return;\n  focusedDzLabel = newlyFocusedDz.getAttribute(\"aria-label\") || \"\";\n\n  var _dzToConfig$get = dzToConfig$1.get(focusedDz),\n      originItems = _dzToConfig$get.items;\n\n  var originItem = originItems.find(function (item) {\n    return item[ITEM_ID_KEY] === focusedItemId;\n  });\n  var originIdx = originItems.indexOf(originItem);\n  var itemToMove = originItems.splice(originIdx, 1)[0];\n\n  var _dzToConfig$get2 = dzToConfig$1.get(newlyFocusedDz),\n      targetItems = _dzToConfig$get2.items,\n      autoAriaDisabled = _dzToConfig$get2.autoAriaDisabled;\n\n  if (newlyFocusedDz.getBoundingClientRect().top < focusedDz.getBoundingClientRect().top || newlyFocusedDz.getBoundingClientRect().left < focusedDz.getBoundingClientRect().left) {\n    targetItems.push(itemToMove);\n\n    if (!autoAriaDisabled) {\n      alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to the end of the list \").concat(focusedDzLabel));\n    }\n  } else {\n    targetItems.unshift(itemToMove);\n\n    if (!autoAriaDisabled) {\n      alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to the beginning of the list \").concat(focusedDzLabel));\n    }\n  }\n\n  var dzFrom = focusedDz;\n  dispatchFinalizeEvent(dzFrom, originItems, {\n    trigger: TRIGGERS.DROPPED_INTO_ANOTHER,\n    id: focusedItemId,\n    source: SOURCES.KEYBOARD\n  });\n  dispatchFinalizeEvent(newlyFocusedDz, targetItems, {\n    trigger: TRIGGERS.DROPPED_INTO_ZONE,\n    id: focusedItemId,\n    source: SOURCES.KEYBOARD\n  });\n  focusedDz = newlyFocusedDz;\n}\n\nfunction triggerAllDzsUpdate() {\n  dzToHandles.forEach(function (_ref, dz) {\n    var update = _ref.update;\n    return update(dzToConfig$1.get(dz));\n  });\n}\n\nfunction handleDrop$1() {\n  var dispatchConsider = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n  printDebug(function () {\n    return \"drop\";\n  });\n\n  if (!dzToConfig$1.get(focusedDz).autoAriaDisabled) {\n    alertToScreenReader(\"Stopped dragging item \".concat(focusedItemLabel));\n  }\n\n  if (allDragTargets.has(document.activeElement)) {\n    document.activeElement.blur();\n  }\n\n  if (dispatchConsider) {\n    dispatchConsiderEvent(focusedDz, dzToConfig$1.get(focusedDz).items, {\n      trigger: TRIGGERS.DRAG_STOPPED,\n      id: focusedItemId,\n      source: SOURCES.KEYBOARD\n    });\n  }\n\n  styleInactiveDropZones(typeToDropZones$1.get(draggedItemType), function (dz) {\n    return dzToConfig$1.get(dz).dropTargetStyle;\n  });\n  focusedItem = null;\n  focusedItemId = null;\n  focusedItemLabel = \"\";\n  draggedItemType = null;\n  focusedDz = null;\n  focusedDzLabel = \"\";\n  isDragging = false;\n  triggerAllDzsUpdate();\n} //////\n\n\nfunction dndzone$1(node, options) {\n  var config = {\n    items: undefined,\n    type: undefined,\n    dragDisabled: false,\n    dropFromOthersDisabled: false,\n    dropTargetStyle: DEFAULT_DROP_TARGET_STYLE$1,\n    autoAriaDisabled: false\n  };\n\n  function swap(arr, i, j) {\n    if (arr.length <= 1) return;\n    arr.splice(j, 1, arr.splice(i, 1, arr[j])[0]);\n  }\n\n  function handleKeyDown(e) {\n    printDebug(function () {\n      return [\"handling key down\", e.key];\n    });\n\n    switch (e.key) {\n      case \"Enter\":\n      case \" \":\n        {\n          // we don't want to affect nested input elements\n          if ((e.target.value !== undefined || e.target.isContentEditable) && !allDragTargets.has(e.target)) {\n            return;\n          }\n\n          e.preventDefault(); // preventing scrolling on spacebar\n\n          e.stopPropagation();\n\n          if (isDragging) {\n            // TODO - should this trigger a drop? only here or in general (as in when hitting space or enter outside of any zone)?\n            handleDrop$1();\n          } else {\n            // drag start\n            handleDragStart(e);\n          }\n\n          break;\n        }\n\n      case \"ArrowDown\":\n      case \"ArrowRight\":\n        {\n          if (!isDragging) return;\n          e.preventDefault(); // prevent scrolling\n\n          e.stopPropagation();\n\n          var _dzToConfig$get3 = dzToConfig$1.get(node),\n              items = _dzToConfig$get3.items;\n\n          var children = Array.from(node.children);\n          var idx = children.indexOf(e.currentTarget);\n          printDebug(function () {\n            return [\"arrow down\", idx];\n          });\n\n          if (idx < children.length - 1) {\n            if (!config.autoAriaDisabled) {\n              alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to position \").concat(idx + 2, \" in the list \").concat(focusedDzLabel));\n            }\n\n            swap(items, idx, idx + 1);\n            dispatchFinalizeEvent(node, items, {\n              trigger: TRIGGERS.DROPPED_INTO_ZONE,\n              id: focusedItemId,\n              source: SOURCES.KEYBOARD\n            });\n          }\n\n          break;\n        }\n\n      case \"ArrowUp\":\n      case \"ArrowLeft\":\n        {\n          if (!isDragging) return;\n          e.preventDefault(); // prevent scrolling\n\n          e.stopPropagation();\n\n          var _dzToConfig$get4 = dzToConfig$1.get(node),\n              _items = _dzToConfig$get4.items;\n\n          var _children = Array.from(node.children);\n\n          var _idx = _children.indexOf(e.currentTarget);\n\n          printDebug(function () {\n            return [\"arrow up\", _idx];\n          });\n\n          if (_idx > 0) {\n            if (!config.autoAriaDisabled) {\n              alertToScreenReader(\"Moved item \".concat(focusedItemLabel, \" to position \").concat(_idx, \" in the list \").concat(focusedDzLabel));\n            }\n\n            swap(_items, _idx, _idx - 1);\n            dispatchFinalizeEvent(node, _items, {\n              trigger: TRIGGERS.DROPPED_INTO_ZONE,\n              id: focusedItemId,\n              source: SOURCES.KEYBOARD\n            });\n          }\n\n          break;\n        }\n    }\n  }\n\n  function handleDragStart(e) {\n    printDebug(function () {\n      return \"drag start\";\n    });\n    setCurrentFocusedItem(e.currentTarget);\n    focusedDz = node;\n    draggedItemType = config.type;\n    isDragging = true;\n    var dropTargets = Array.from(typeToDropZones$1.get(config.type)).filter(function (dz) {\n      return dz === focusedDz || !dzToConfig$1.get(dz).dropFromOthersDisabled;\n    });\n    styleActiveDropZones(dropTargets, function (dz) {\n      return dzToConfig$1.get(dz).dropTargetStyle;\n    });\n\n    if (!config.autoAriaDisabled) {\n      var msg = \"Started dragging item \".concat(focusedItemLabel, \". Use the arrow keys to move it within its list \").concat(focusedDzLabel);\n\n      if (dropTargets.length > 1) {\n        msg += \", or tab to another list in order to move the item into it\";\n      }\n\n      alertToScreenReader(msg);\n    }\n\n    dispatchConsiderEvent(node, dzToConfig$1.get(node).items, {\n      trigger: TRIGGERS.DRAG_STARTED,\n      id: focusedItemId,\n      source: SOURCES.KEYBOARD\n    });\n    triggerAllDzsUpdate();\n  }\n\n  function handleClick(e) {\n    if (!isDragging) return;\n    if (e.currentTarget === focusedItem) return;\n    e.stopPropagation();\n    handleDrop$1(false);\n    handleDragStart(e);\n  }\n\n  function setCurrentFocusedItem(draggableEl) {\n    var _dzToConfig$get5 = dzToConfig$1.get(node),\n        items = _dzToConfig$get5.items;\n\n    var children = Array.from(node.children);\n    var focusedItemIdx = children.indexOf(draggableEl);\n    focusedItem = draggableEl;\n    focusedItemId = items[focusedItemIdx][ITEM_ID_KEY];\n    focusedItemLabel = children[focusedItemIdx].getAttribute(\"aria-label\") || \"\";\n  }\n\n  function configure(_ref2) {\n    var _ref2$items = _ref2.items,\n        items = _ref2$items === void 0 ? [] : _ref2$items,\n        _ref2$type = _ref2.type,\n        newType = _ref2$type === void 0 ? DEFAULT_DROP_ZONE_TYPE$1 : _ref2$type,\n        _ref2$dragDisabled = _ref2.dragDisabled,\n        dragDisabled = _ref2$dragDisabled === void 0 ? false : _ref2$dragDisabled,\n        _ref2$dropFromOthersD = _ref2.dropFromOthersDisabled,\n        dropFromOthersDisabled = _ref2$dropFromOthersD === void 0 ? false : _ref2$dropFromOthersD,\n        _ref2$dropTargetStyle = _ref2.dropTargetStyle,\n        dropTargetStyle = _ref2$dropTargetStyle === void 0 ? DEFAULT_DROP_TARGET_STYLE$1 : _ref2$dropTargetStyle,\n        _ref2$autoAriaDisable = _ref2.autoAriaDisabled,\n        autoAriaDisabled = _ref2$autoAriaDisable === void 0 ? false : _ref2$autoAriaDisable;\n    config.items = _toConsumableArray(items);\n    config.dragDisabled = dragDisabled;\n    config.dropFromOthersDisabled = dropFromOthersDisabled;\n    config.dropTargetStyle = dropTargetStyle;\n    config.autoAriaDisabled = autoAriaDisabled;\n\n    if (!autoAriaDisabled) {\n      node.setAttribute(\"aria-disabled\", dragDisabled);\n      node.setAttribute(\"role\", \"list\");\n      node.setAttribute(\"aria-describedby\", dragDisabled ? INSTRUCTION_IDs$1.DND_ZONE_DRAG_DISABLED : INSTRUCTION_IDs$1.DND_ZONE_ACTIVE);\n    }\n\n    if (config.type && newType !== config.type) {\n      unregisterDropZone$1(node, config.type);\n    }\n\n    config.type = newType;\n    registerDropZone$1(node, newType);\n    dzToConfig$1.set(node, config);\n    node.tabIndex = isDragging && (node === focusedDz || focusedItem.contains(node) || config.dropFromOthersDisabled || focusedDz && config.type !== dzToConfig$1.get(focusedDz).type) ? -1 : 0;\n    node.addEventListener(\"focus\", handleZoneFocus);\n\n    var _loop = function _loop(i) {\n      var draggableEl = node.children[i];\n      allDragTargets.add(draggableEl);\n      draggableEl.tabIndex = isDragging ? -1 : 0;\n\n      if (!autoAriaDisabled) {\n        draggableEl.setAttribute(\"role\", \"listitem\");\n      }\n\n      draggableEl.removeEventListener(\"keydown\", elToKeyDownListeners.get(draggableEl));\n      draggableEl.removeEventListener(\"click\", elToFocusListeners.get(draggableEl));\n\n      if (!dragDisabled) {\n        draggableEl.addEventListener(\"keydown\", handleKeyDown);\n        elToKeyDownListeners.set(draggableEl, handleKeyDown);\n        draggableEl.addEventListener(\"click\", handleClick);\n        elToFocusListeners.set(draggableEl, handleClick);\n      }\n\n      if (isDragging && config.items[i][ITEM_ID_KEY] === focusedItemId) {\n        printDebug(function () {\n          return [\"focusing on\", {\n            i: i,\n            focusedItemId: focusedItemId\n          }];\n        }); // if it is a nested dropzone, it was re-rendered and we need to refresh our pointer\n\n        focusedItem = draggableEl; // without this the element loses focus if it moves backwards in the list\n\n        draggableEl.focus();\n      }\n    };\n\n    for (var i = 0; i < node.children.length; i++) {\n      _loop(i);\n    }\n  }\n\n  configure(options);\n  var handles = {\n    update: function update(newOptions) {\n      printDebug(function () {\n        return \"keyboard dndzone will update newOptions: \".concat(toString(newOptions));\n      });\n      configure(newOptions);\n    },\n    destroy: function destroy() {\n      printDebug(function () {\n        return \"keyboard dndzone will destroy\";\n      });\n      unregisterDropZone$1(node, config.type);\n      dzToConfig$1[\"delete\"](node);\n      dzToHandles[\"delete\"](node);\n    }\n  };\n  dzToHandles.set(node, handles);\n  return handles;\n}\n\n/**\n * A custom action to turn any container to a dnd zone and all of its direct children to draggables\n * Supports mouse, touch and keyboard interactions.\n * Dispatches two events that the container is expected to react to by modifying its list of items,\n * which will then feed back in to this action via the update function\n *\n * @typedef {Object} Options\n * @property {Array} items - the list of items that was used to generate the children of the given node (the list used in the #each block\n * @property {string} [type] - the type of the dnd zone. children dragged from here can only be dropped in other zones of the same type, default to a base type\n * @property {number} [flipDurationMs] - if the list animated using flip (recommended), specifies the flip duration such that everything syncs with it without conflict, defaults to zero\n * @property {boolean} [dragDisabled]\n * @property {boolean} [dropFromOthersDisabled]\n * @property {Object} [dropTargetStyle]\n * @property {Function} [transformDraggedElement]\n * @param {HTMLElement} node - the element to enhance\n * @param {Options} options\n * @return {{update: function, destroy: function}}\n */\n\nfunction dndzone$2(node, options) {\n  validateOptions(options);\n  var pointerZone = dndzone(node, options);\n  var keyboardZone = dndzone$1(node, options);\n  return {\n    update: function update(newOptions) {\n      validateOptions(newOptions);\n      pointerZone.update(newOptions);\n      keyboardZone.update(newOptions);\n    },\n    destroy: function destroy() {\n      pointerZone.destroy();\n      keyboardZone.destroy();\n    }\n  };\n}\n\nfunction validateOptions(options) {\n  /*eslint-disable*/\n  var items = options.items,\n      flipDurationMs = options.flipDurationMs,\n      type = options.type,\n      dragDisabled = options.dragDisabled,\n      dropFromOthersDisabled = options.dropFromOthersDisabled,\n      dropTargetStyle = options.dropTargetStyle,\n      transformDraggedElement = options.transformDraggedElement,\n      autoAriaDisabled = options.autoAriaDisabled,\n      rest = _objectWithoutProperties(options, [\"items\", \"flipDurationMs\", \"type\", \"dragDisabled\", \"dropFromOthersDisabled\", \"dropTargetStyle\", \"transformDraggedElement\", \"autoAriaDisabled\"]);\n  /*eslint-enable*/\n\n\n  if (Object.keys(rest).length > 0) {\n    console.warn(\"dndzone will ignore unknown options\", rest);\n  }\n\n  if (!items) {\n    throw new Error(\"no 'items' key provided to dndzone\");\n  }\n\n  var itemWithMissingId = items.find(function (item) {\n    return !{}.hasOwnProperty.call(item, ITEM_ID_KEY);\n  });\n\n  if (itemWithMissingId) {\n    throw new Error(\"missing '\".concat(ITEM_ID_KEY, \"' property for item \").concat(toString(itemWithMissingId)));\n  }\n}\n\nexport { SHADOW_ITEM_MARKER_PROPERTY_NAME, SOURCES, TRIGGERS, alertToScreenReader, dndzone$2 as dndzone, overrideItemIdKeyNameBeforeInitialisingDndZones, setDebugMode };\n","export function createFlipper(node, durationMS) {\n    let idToRect = new Map();\n    let idToAnim = new Map();\n    function read(ids) {\n        //console.debug(`read got ${JSON.stringify(ids)}`);\n        Array.from(idToAnim.values()).forEach(anim => anim.cancel());\n        idToRect = new Map();\n        Array.from(node.children).forEach((child, index) => {\n            idToRect.set(ids[index], child.getBoundingClientRect());\n        });\n    }\n    function flip(ids) {\n        //console.debug(`flip got ${JSON.stringify(ids)}`);\n        Array.from(node.children).forEach((child, index) => {\n            const id = ids[index];\n            const currentRect = child.getBoundingClientRect();\n            const prevRect = idToRect.get(id);\n            if (prevRect) {\n               const transformX = prevRect.left - currentRect.left;\n               const transformY = prevRect.top - currentRect.top;\n               if (transformX || transformY) {\n                   const keyFrames = [\n                       { transform: `translate3d(${transformX}px, ${transformY}px, 0)`},\n                       { transform: 'translate3d(0, 0, 0)'}\n                   ];\n                   const animationObj = child.animate(keyFrames, {duration: durationMS, easing: \"ease-out\"});\n                   idToAnim.set(id , animationObj);\n                   animationObj.onfinish = () => idToAnim.delete(id);\n                   animationObj.oncancel = () => idToAnim.delete(id);\n               }\n           }\n        });\n    }\n    return {read, flip};\n}\n","import {useEffect, useLayoutEffect, useRef} from 'react';\nimport {dndzone as svelteDndZone, overrideItemIdKeyNameBeforeInitialisingDndZones as overrideIId} from \"svelte-dnd-action\";\nimport {createFlipper} from \"./util/flip\";\n\nlet ID_KEY = \"id\";\nexport function overrideItemIdKeyNameBeforeInitialisingDndZones(newId) {\n  overrideIId(newId);\n  ID_KEY = newId;\n}\n\nconst DEFAULT_FLIP_DURATION_MS = 200;\n\nexport function useDndZone(nodeRef, options, onConsider, onFinalize = onConsider) {\n    const updateR = useRef(() => {});\n    const flipper = useRef({});\n    console.debug(`action running ${JSON.stringify(options, null, 2)}`);\n    useEffect(function init() {\n        if (!nodeRef.current) return;\n        console.debug(\"init\");\n        //TODO - deal with flip duration better, should i default to zero?\n        flipper.current = createFlipper(nodeRef.current, options.flipDurationMs !== undefined?  options.flipDurationMs : DEFAULT_FLIP_DURATION_MS);\n\n        const {update, destroy} = svelteDndZone(nodeRef.current, {flipDurationMs: DEFAULT_FLIP_DURATION_MS, ...options});\n        updateR.current = update;\n        return destroy;\n    }, [nodeRef]);\n    useEffect(function addListeners() {\n        if (!nodeRef.current) return;\n        const node = nodeRef.current;\n        console.debug(\"adding listeners\", node);\n        function adaptConsider(e) {\n            if (flipper.current.read) {\n                flipper.current.read(options.items.map(item => item[ID_KEY]));\n            }\n            onConsider(e.detail);\n        }\n        function adaptFinalize(e) {\n            if (flipper.current.read) {\n                flipper.current.read(options.items.map(item => item[ID_KEY]));\n            }\n            onFinalize(e.detail);\n        }\n        node.addEventListener('consider', adaptConsider);\n        node.addEventListener('finalize', adaptFinalize);\n        return () => {\n            node.removeEventListener('consider', adaptConsider);\n            node.removeEventListener('finalize', adaptFinalize);\n        }\n    }, [nodeRef, options, onConsider, onFinalize]);\n    useLayoutEffect(function update() {\n        if (!nodeRef.current) return;\n        console.debug(`updating ${JSON.stringify(options)}`);\n        updateR.current({flipDurationMs: DEFAULT_FLIP_DURATION_MS, ...options});\n    });\n    useLayoutEffect(function flip() {\n        if (flipper.current.flip) {\n            flipper.current.flip(options.items.map(item => item[ID_KEY]));\n        }\n    }, [options.items]);\n}\n"]},"metadata":{},"sourceType":"module"}